<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <!-- For Mobile Devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Doxygen 1.8.13"/>
    <title>MoDeNa: applications/PUfoam/MoDeNaModels/foamConductivity/src/src/besselj.f90 Source File</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
/*@cond
  ooo        ooooo               .   oooo           oooo
  `88.       .888'             .o8   `888           `888
   888b     d'888   .oooo.   .o888oo  888 .oo.       888  .oooo.   oooo    ooo 
   8 Y88. .P  888  `P  )88b    888    888P"Y88b      888 `P  )88b   `88b..8P'
   8  `888'   888   .oP"888    888    888   888      888  .oP"888     Y888'
   8    Y     888  d8(  888    888 .  888   888      888 d8(  888   .o8"'88b
  o8o        o888o `Y888""8o   "888" o888o o888o .o. 88P `Y888""8o o88'   888o 
                                                 `Y888P
@endcond*/
/*
@brief     File configurating the connection to MathJax JavaScript display engine 
@author    Sigve Karolius
@date      2016.12.10
@details
         The script was made following the [Official Documentation].
         [Official Documentation]: http://docs.mathjax.org/en/latest/index.html
@bug
@todo
@warning
@note
*/
//<script type="text/x-mathjax-config">
/*
@brief: Main Control structure for MathJax
@note:
      [Official Documentation](http://docs.mathjax.org/en/latest/api/hub.html)
*/
MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    /// List of input and output jax to initialize at startup
    jax: ["input/TeX","output/HTML-CSS"],
    /// Preprocessor run when "tex2jax.js" is included in extensions list
    tex2jax: {
           /// Tags whose contents should not be processed by tex2jax
           skipTags: [
                       "script","noscript","style","textarea","pre","code",
           ],
           inlineMath: [['$','$'], ['\\(','\\)']],
           /// Pairs of strings used as in-line math delimters
           inlineMath: [['$','$'],['\\(','\\)']],
           /// Strings used as delimters for displayed equation
           displayMath: [['$$','$$'],['\\[','\\]']],
           /// Process LaTeX environments (\begin{something}) outside of "math"
           processEnvironments: true,
           /// Insert the text 'LaTeX math' as the preview
           preview: [" [LaTeX math] "],
           /// Tell MJ to process escapes (true because of $ in inline math
           processEscapes: true,  // Use \$ to represent literal dollar sign...
    },
    /// Control the TeX processor (run when you include "input/TeX" in jax)
    TeX: {
           /// MathJax has many TeX symbols and commands, but we need more...
           extensions: ["color.js"],
           equationNumbers: {
                autoNumber: "AMS",
           },
           /// Macros defined before the TeX input processor begins
           Macros: {
              xspace: '',     // not processed by MathJax, replace empty string
              ensuremath: '', // not processed by MathJax, replace empty string
           },
    },
});
/*
@brief: Registers a listener for a particular message being sent to the startup signal
@date:  2016.12.10
@note:
      [Official Documentation](http://docs.mathjax.org/en/latest/api/hub.html)
*/
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    cancel: ["Extension","cancel"],
    bcancel: ["Extension","cancel"],
    xcancel: ["Extension","cancel"],
    cancelto: ["Extension","cancel"],
    textcolor: ["Extension", "color"],
  });
});
//</script>
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <!--  .......................................................................
        Syntax Highlighting
        .......................................................................
  <script type="text/javascript" src="highlight.pack.js"></script>
  <script type="text/javascript">
  $(function() {
    $(".fragment").each(function(i,node) {
        var $node = $(node);
        $node.html("<pre><code class='" +
                   $node.attr("class")+"'>" + 
                   $node.text()+"</code></pre>");
        hljs.highlightBlock(node);
    });
  });
  </script>
  -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="modena_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MoDeNa
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Software framework facilitating sequential multi-scale modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00731_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">besselj.f90</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">module</span> besselj</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    <span class="keywordtype">private</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    <span class="keywordtype">public</span> zbesj</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">contains</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!*****************************************************************</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!* EVALUATE A J-BESSEL FUNCTION OF COMPLEX ARGUMENT (FIRST KIND) *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!* ------------------------------------------------------------- *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!* SAMPLE RUN:                                                   *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!* (Evaluate J0 to J4 for argument Z=(1.0,2.0) ).                *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!*                                                               *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!* zr(0) =   1.586259                                            *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!* zi(0) =  -1.391602                                            *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!* zr(1) =   1.291848                                            *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!* zi(1) =   1.010488                                            *</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!* zr(2) =  -0.261130                                            *</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!* zi(2) =   0.762320                                            *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!* zr(3) =  -0.281040                                            *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!* zi(3) =   0.017175                                            *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!* zr(4) =  -0.034898                                            *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!* zi(4) =  -0.067215                                            *</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!* NZ =          0                                               *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!* Error code:           0                                       *</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!*                                                               *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!* ------------------------------------------------------------- *</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!* Ref.: From Numath Library By Tuan Dang Trong in Fortran 77    *</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!*       [BIBLI 18].                                             *</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!*                                                               *</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!*                        F90 Release 1.0 By J-P Moreau, Paris   *</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!*                                 (www.jpmoreau.fr)             *</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!*****************************************************************</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!Note: to link with Complex.f90 and Utilit.f90.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!---------------------------------------------</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!PROGRAM TEST_ZBESJ</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!real*8 zr,zi, cyr(10), cyi(10)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!  n=5</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!  zr=1.d0; zi=2.d0</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!  call ZBESJ(zr,zi,0,1,n,cyr,cyi,nz,ierr)</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!  print *,&#39; &#39;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!  do i=1, n</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!    write(*,10) i-1, cyr(i)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!    write(*,11) i-1, cyi(i)</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!  end do</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!  print *,&#39; NZ=&#39;, NZ</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!  print *,&#39; Error code:&#39;, ierr</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!  print *,&#39; &#39;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!10 format(&#39;  zr(&#39;,I1,&#39;) = &#39;,F10.6)</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!11 format(&#39;  zi(&#39;,I1,&#39;) = &#39;,F10.6)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">!END</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">SUBROUTINE </span>zbesj(ZR, ZI, FNU, KODE, N, CYR, CYI, NZ, IERR)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">USE </span>utilit  <span class="comment">!For I1MACH,D1MACH.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">USE </span>complex <span class="comment">!For ZABS</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZBESJ</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!***DATE WRITTEN   830501   (YYMMDD)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!***REVISION DATE  830501   (YYMMDD)</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!***CATEGORY NO.  B5K</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!***KEYWORDS  J-BESSEL FUNCTION,BESSEL FUNCTION OF COMPLEX ARGUMENT,</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!             BESSEL FUNCTION OF FIRST KIND</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!***AUTHOR  AMOS, DONALD E., SANDIA NATIONAL LABORATORIES</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!***PURPOSE  TO COMPUTE THE J-BESSEL FUNCTION OF A COMPLEX ARGUMENT</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">!***DESCRIPTION</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!                      ***A DOUBLE PRECISION ROUTINE***</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!         ON KODE=1, CBESJ COMPUTES AN N MEMBER  SEQUENCE OF COMPLEX</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!         BESSEL FUNCTIONS CY(I)=J(FNU+I-1,Z) FOR REAL, NONNEGATIVE</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">!         ORDERS FNU+I-1, I=1,...,N AND COMPLEX Z IN THE CUT PLANE</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!         -PI.LT.ARG(Z).LE.PI. ON KODE=2, CBESJ RETURNS THE SCALED</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!         FUNCTIONS</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!         CY(I)=EXP(-ABS(Y))*J(FNU+I-1,Z)   I = 1,...,N , Y=AIMAG(Z)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!         WHICH REMOVE THE EXPONENTIAL GROWTH IN BOTH THE UPPER AND</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!         LOWER HALF PLANES FOR Z TO INFINITY. DEFINITIONS AND NOTATION</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!         ARE FOUND IN THE NBS HANDBOOK OF MATHEMATICAL FUNCTIONS</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!         (REF. 1).</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!         INPUT      ZR,ZI,FNU ARE DOUBLE PRECISION</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!           ZR,ZI  - Z=CMPLX(ZR,ZI),  -PI.LT.ARG(Z).LE.PI</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!           FNU    - ORDER OF INITIAL J FUNCTION, FNU.GE.0.0D0</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">!           KODE   - A PARAMETER TO INDICATE THE SCALING OPTION</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!                    KODE= 1  RETURNS</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!                             CY(I)=J(FNU+I-1,Z), I=1,...,N</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">!                        = 2  RETURNS</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">!                             CY(I)=J(FNU+I-1,Z)EXP(-ABS(Y)), I=1,...,N</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">!           N      - NUMBER OF MEMBERS OF THE SEQUENCE, N.GE.1</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!         OUTPUT     CYR,CYI ARE DOUBLE PRECISION</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!           CYR,CYI- DOUBLE PRECISION VECTORS WHOSE FIRST N COMPONENTS</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!                    CONTAIN REAL AND IMAGINARY PARTS FOR THE SEQUENCE</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!                    CY(I)=J(FNU+I-1,Z)  OR</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!                    CY(I)=J(FNU+I-1,Z)EXP(-ABS(Y))  I=1,...,N</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!                    DEPENDING ON KODE, Y=AIMAG(Z).</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">!           NZ     - NUMBER OF COMPONENTS SET TO ZERO DUE TO UNDERFLOW,</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!                    NZ= 0   , NORMAL RETURN</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">!                    NZ.GT.0 , LAST NZ COMPONENTS OF CY SET  ZERO DUE</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!                             TO UNDERFLOW, CY(I)=CMPLX(0.0D0,0.0D0),</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!                              I = N-NZ+1,...,N</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">!           IERR   - ERROR FLAG</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">!                    IERR=0, NORMAL RETURN - COMPUTATION COMPLETED</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!                    IERR=1, INPUT ERROR   - NO COMPUTATION</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">!                    IERR=2, OVERFLOW      - NO COMPUTATION, AIMAG(Z)</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">!                            TOO LARGE ON KODE=1</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!                    IERR=3, CABS(Z) OR FNU+N-1 LARGE - COMPUTATION DONE</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">!                            BUT LOSSES OF SIGNIFCANCE BY ARGUMENT</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!                            REDUCTION PRODUCE LESS THAN HALF OF MACHINE</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!                            ACCURACY</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">!                    IERR=4, CABS(Z) OR FNU+N-1 TOO LARGE - NO COMPUTA-</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">!                            TION BECAUSE OF COMPLETE LOSSES OF SIGNIFI-</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">!                            CANCE BY ARGUMENT REDUCTION</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">!                    IERR=5, ERROR              - NO COMPUTATION,</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">!                            ALGORITHM TERMINATION CONDITION NOT MET</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">!***LONG DESCRIPTION</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">!         THE COMPUTATION IS CARRIED OUT BY THE FORMULA</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">!         J(FNU,Z)=EXP( FNU*PI*I/2)*I(FNU,-I*Z)    AIMAG(Z).GE.0.0</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">!         J(FNU,Z)=EXP(-FNU*PI*I/2)*I(FNU, I*Z)    AIMAG(Z).LT.0.0</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">!         WHERE I**2 = -1 AND I(FNU,Z) IS THE I BESSEL FUNCTION.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">!         FOR NEGATIVE ORDERS,THE FORMULA</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">!              J(-FNU,Z) = J(FNU,Z)*COS(PI*FNU) - Y(FNU,Z)*SIN(PI*FNU)</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">!         CAN BE USED. HOWEVER,FOR LARGE ORDERS CLOSE TO INTEGERS, THE</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">!         THE FUNCTION CHANGES RADICALLY. WHEN FNU IS A LARGE POSITIVE</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">!         INTEGER,THE MAGNITUDE OF J(-FNU,Z)=J(FNU,Z)*COS(PI*FNU) IS A</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">!         LARGE NEGATIVE POWER OF TEN. BUT WHEN FNU IS NOT AN INTEGER,</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">!         Y(FNU,Z) DOMINATES IN MAGNITUDE WITH A LARGE POSITIVE POWER OF</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">!         TEN AND THE MOST THAT THE SECOND TERM CAN BE REDUCED IS BY</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">!         UNIT ROUNDOFF FROM THE COEFFICIENT. THUS, WIDE CHANGES CAN</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">!         OCCUR WITHIN UNIT ROUNDOFF OF A LARGE INTEGER FOR FNU. HERE,</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">!         LARGE MEANS FNU.GT.CABS(Z).</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">!         IN MOST COMPLEX VARIABLE COMPUTATION, ONE MUST EVALUATE ELE-</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">!         MENTARY FUNCTIONS. WHEN THE MAGNITUDE OF Z OR FNU+N-1 IS</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">!         LARGE, LOSSES OF SIGNIFICANCE BY ARGUMENT REDUCTION OCCUR.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">!         CONSEQUENTLY, IF EITHER ONE EXCEEDS U1=SQRT(0.5/UR), THEN</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">!         LOSSES EXCEEDING HALF PRECISION ARE LIKELY AND AN ERROR FLAG</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">!         IERR=3 IS TRIGGERED WHERE UR=DMAX1(D1MACH(4),1.0D-18) IS</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">!         DOUBLE PRECISION UNIT ROUNDOFF LIMITED TO 18 DIGITS PRECISION.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">!         IF EITHER IS LARGER THAN U2=0.5/UR, THEN ALL SIGNIFICANCE IS</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">!         LOST AND IERR=4. IN ORDER TO USE THE INT FUNCTION, ARGUMENTS</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!         MUST BE FURTHER RESTRICTED NOT TO EXCEED THE LARGEST MACHINE</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">!         INTEGER, U3=I1MACH(9). THUS, THE MAGNITUDE OF Z AND FNU+N-1 IS</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">!         RESTRICTED BY MIN(U2,U3). ON 32 BIT MACHINES, U1,U2, AND U3</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">!         ARE APPROXIMATELY 2.0E+3, 4.2E+6, 2.1E+9 IN SINGLE PRECISION</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">!         ARITHMETIC AND 1.3E+8, 1.8E+16, 2.1E+9 IN DOUBLE PRECISION</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">!         ARITHMETIC RESPECTIVELY. THIS MAKES U2 AND U3 LIMITING IN</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">!         THEIR RESPECTIVE ARITHMETICS. THIS MEANS THAT ONE CAN EXPECT</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">!         TO RETAIN, IN THE WORST CASES ON 32 BIT MACHINES, NO DIGITS</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">!         IN SINGLE AND ONLY 7 DIGITS IN DOUBLE PRECISION ARITHMETIC.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">!         SIMILAR CONSIDERATIONS HOLD FOR OTHER MACHINES.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">!         THE APPROXIMATE RELATIVE ERROR IN THE MAGNITUDE OF A COMPLEX</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">!         BESSEL FUNCTION CAN BE EXPRESSED BY P*10**S WHERE P=MAX(UNIT</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">!         ROUNDOFF,1.0E-18) IS THE NOMINAL PRECISION AND 10**S REPRE-</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">!         SENTS THE INCREASE IN ERROR DUE TO ARGUMENT REDUCTION IN THE</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">!         ELEMENTARY FUNCTIONS. HERE, S=MAX(1,ABS(LOG10(CABS(Z))),</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">!         ABS(LOG10(FNU))) APPROXIMATELY (I.E. S=MAX(1,ABS(EXPONENT OF</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">!         CABS(Z),ABS(EXPONENT OF FNU)) ). HOWEVER, THE PHASE ANGLE MAY</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">!         HAVE ONLY ABSOLUTE ACCURACY. THIS IS MOST LIKELY TO OCCUR WHEN</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">!         ONE COMPONENT (IN ABSOLUTE VALUE) IS LARGER THAN THE OTHER BY</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!         SEVERAL ORDERS OF MAGNITUDE. IF ONE COMPONENT IS 10**K LARGER</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">!         THAN THE OTHER, THEN ONE CAN EXPECT ONLY MAX(ABS(LOG10(P))-K,</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">!         0) SIGNIFICANT DIGITS; OR, STATED ANOTHER WAY, WHEN K EXCEEDS</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">!         THE EXPONENT OF P, NO SIGNIFICANT DIGITS REMAIN IN THE SMALLER</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">!         COMPONENT. HOWEVER, THE PHASE ANGLE RETAINS ABSOLUTE ACCURACY</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">!         BECAUSE, IN COMPLEX ARITHMETIC WITH PRECISION P, THE SMALLER</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">!         COMPONENT WILL NOT (AS A RULE) DECREASE BELOW P TIMES THE</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">!         MAGNITUDE OF THE LARGER COMPONENT. IN THESE EXTREME CASES,</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">!         THE PRINCIPAL PHASE ANGLE IS ON THE ORDER OF +P, -P, PI/2-P,</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!         OR -PI/2+P.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">!***REFERENCES  HANDBOOK OF MATHEMATICAL FUNCTIONS BY M. ABRAMOWITZ</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">!                 AND I. A. STEGUN, NBS AMS SERIES 55, U.S. DEPT. OF</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">!                 COMMERCE, 1955.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">!               COMPUTATION OF BESSEL FUNCTIONS OF COMPLEX ARGUMENT</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">!                 BY D. E. AMOS, SAND83-0083, MAY, 1983.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">!               COMPUTATION OF BESSEL FUNCTIONS OF COMPLEX ARGUMENT</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">!                 AND LARGE ORDER BY D. E. AMOS, SAND83-0643, MAY, 1983</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">!               A SUBROUTINE PACKAGE FOR BESSEL FUNCTIONS OF A COMPLEX</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">!                 ARGUMENT AND NONNEGATIVE ORDER BY D. E. AMOS, SAND85-</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">!                 1018, MAY, 1985</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">!               A PORTABLE PACKAGE FOR BESSEL FUNCTIONS OF A COMPLEX</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">!                 ARGUMENT AND NONNEGATIVE ORDER BY D. E. AMOS, TRANS.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">!                 MATH. SOFTWARE, 1986</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">!***ROUTINES CALLED  ZABS,ZBINU,I1MACH,D1MACH</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">!***END PROLOGUE  ZBESJ</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">!     COMPLEX CI,CSGN,CY,Z,ZN</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, alim, arg, cii, csgni, csgnr, cyi, cyr, dig, &amp;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      elim, fnu, fnul, hpi, rl, r1m5, str, tol, zi, zni, znr, zr,       &amp;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      bb, fn, az</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordtype">INTEGER</span> i, ierr, inu, inuh, ir, k, kode, k1, k2, n, nl, nz</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      dimension cyr(1), cyi(1)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">DATA</span> hpi /1.57079632679489662d0/</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">!***FIRST EXECUTABLE STATEMENT  ZBESJ</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      ierr = 0</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      nz=0</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">IF</span> (fnu.LT.0.0d0) ierr=1</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">IF</span> (kode.LT.1 .OR. kode.GT.2) ierr=1</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">IF</span> (n.LT.1) ierr=1</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">!     SET PARAMETERS RELATED TO MACHINE CONSTANTS.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!     TOL IS THE APPROXIMATE UNIT ROUNDOFF LIMITED TO 1.0E-18.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">!     ELIM IS THE APPROXIMATE EXPONENTIAL OVER- AND UNDERFLOW LIMIT.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">!     EXP(-ELIM).LT.EXP(-ALIM)=EXP(-ELIM)/TOL    AND</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!     EXP(ELIM).GT.EXP(ALIM)=EXP(ELIM)*TOL       ARE INTERVALS NEAR</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">!     UNDERFLOW AND OVERFLOW LIMITS WHERE SCALED ARITHMETIC IS DONE.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">!     RL IS THE LOWER BOUNDARY OF THE ASYMPTOTIC EXPANSION FOR LARGE Z.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">!     DIG = NUMBER OF BASE 10 DIGITS IN TOL = 10**(-DIG).</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">!     FNUL IS THE LOWER BOUNDARY OF THE ASYMPTOTIC SERIES FOR LARGE FNU.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      tol = dmax1(d1mach(4),1.0d-18)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      k1 = i1mach(15)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      k2 = i1mach(16)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      r1m5 = d1mach(5)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      k = min0(iabs(k1),iabs(k2))</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      elim = 2.303d0*(dble(float(k))*r1m5-3.0d0)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      k1 = i1mach(14) - 1</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      aa = r1m5*dble(float(k1))</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      dig = dmin1(aa,18.0d0)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      aa = aa*2.303d0</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      alim = elim + dmax1(-aa,-41.45d0)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      rl = 1.2d0*dig + 3.0d0</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      fnul = 10.0d0 + 6.0d0*(dig-3.0d0)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">!     TEST FOR PROPER RANGE</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      fn = fnu+dble(float(n-1))</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      aa = 0.5d0/tol</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      bb=dble(float(i1mach(9)))*0.5d0</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      aa = dmin1(aa,bb)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">IF</span> (az.GT.aa) <span class="keywordflow">GO TO</span> 260</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">IF</span> (fn.GT.aa) <span class="keywordflow">GO TO</span> 260</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      aa = dsqrt(aa)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">IF</span> (az.GT.aa) ierr=3</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">IF</span> (fn.GT.aa) ierr=3</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">!     CALCULATE CSGN=EXP(FNU*HPI*I) TO MINIMIZE LOSSES OF SIGNIFICANCE</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">!     WHEN FNU IS LARGE</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      cii = 1.0d0</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      inu = int(sngl(fnu))</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      inuh = inu/2</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      ir = inu - 2*inuh</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      arg = (fnu-dble(float(inu-ir)))*hpi</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      csgnr = dcos(arg)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      csgni = dsin(arg)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">IF</span> (mod(inuh,2).EQ.0) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      csgnr = -csgnr</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      csgni = -csgni</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">!     ZN IS IN THE RIGHT HALF PLANE</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      znr = zi</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      zni = -zr</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">IF</span> (zi.GE.0.0d0) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      znr = -znr</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      zni = -zni</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      csgni = -csgni</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      cii = -cii</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keyword">CALL </span>zbinu(znr, zni, fnu, kode, n, cyr, cyi, nz, rl, fnul, tol, &amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      elim, alim)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">IF</span> (nz.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      nl = n - nz</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">IF</span> (nl.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">DO</span> 60 i=1,nl</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        str = cyr(i)*csgnr - cyi(i)*csgni</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        cyi(i) = cyr(i)*csgni + cyi(i)*csgnr</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        cyr(i) = str</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        str = -csgni*cii</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        csgni = csgnr*cii</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        csgnr = str</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">IF</span>(nz.EQ.(-2)) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      nz = 0</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      ierr = 2</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      nz=0</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      ierr=5</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  260 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      nz=0</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      ierr=4</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">SUBROUTINE </span>zuchk(YR, YI, NZ, ASCLE, TOL)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUCHK</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">!***REFER TO ZSERI,ZUOIK,ZUNK1,ZUNK2,ZUNI1,ZUNI2,ZKSCL</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">!      Y ENTERS AS A SCALED QUANTITY WHOSE MAGNITUDE IS GREATER THAN</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">!      EXP(-ALIM)=ASCLE=1.0E+3*D1MACH(1)/TOL. THE TEST IS MADE TO SEE</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">!      IF THE MAGNITUDE OF THE REAL OR IMAGINARY PART WOULD UNDERFLOW</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">!      WHEN Y IS SCALED (BY TOL) TO ITS PROPER VALUE. Y IS ACCEPTED</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">!      IF THE UNDERFLOW IS AT LEAST ONE PRECISION BELOW THE MAGNITUDE</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">!      OF THE LARGEST COMPONENT; OTHERWISE THE PHASE ANGLE DOES NOT HAVE</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">!      ABSOLUTE ACCURACY AND AN UNDERFLOW IS ASSUMED.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!***ROUTINES CALLED  (NONE)</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">!***END PROLOGUE  ZUCHK</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">!     COMPLEX Y</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> ascle, ss, st, tol, wr, wi, yr, yi</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordtype">INTEGER</span> nz</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      nz = 0</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      wr = dabs(yr)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      wi = dabs(yi)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      st = dmin1(wr,wi)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">IF</span> (st.GT.ascle) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      ss = dmax1(wr,wi)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      st = st/tol</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">IF</span> (ss.LT.st) nz = 1</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword">SUBROUTINE </span>zbinu(ZR, ZI, FNU, KODE, N, CYR, CYI, NZ, RL, FNUL, TOL, ELIM, ALIM)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZBINU</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">!***REFER TO  ZBESH,ZBESI,ZBESJ,ZBESK,ZAIRY,ZBIRY</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">!   ZBINU COMPUTES THE I FUNCTION IN THE RIGHT HALF Z PLANE</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">!***ROUTINES CALLED  ZABS,ZASYI,ZBUNI,ZMLRI,ZSERI,ZUOIK,ZWRSK</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">!***END PROLOGUE  ZBINU</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> alim, az, cwi, cwr, cyi, cyr, dfnu, elim, fnu, &amp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      fnul, rl, tol, zeroi, zeror, zi, zr</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordtype">INTEGER</span> i, inw, kode, n, nlast, nn, nui, nw, nz</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      dimension cyr(1), cyi(1), cwr(2), cwi(2)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi / 0.0d0, 0.0d0 /</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      nz = 0</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      nn = n</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      dfnu = fnu + dble(float(n-1))</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">IF</span> (az.LE.2.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">IF</span> (az*az*0.25d0.GT.dfnu+1.0d0) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">!     POWER SERIES</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">CALL </span>zseri(zr, zi, fnu, kode, nn, cyr, cyi, nw, tol, elim, alim)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      inw = iabs(nw)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      nz = nz + inw</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      nn = nn - inw</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">IF</span> (nn.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">IF</span> (nw.GE.0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      dfnu = fnu + dble(float(nn-1))</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">IF</span> (az.LT.rl) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">IF</span> (dfnu.LE.1.0d0) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">IF</span> (az+az.LT.dfnu*dfnu) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR LARGE Z</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keyword">CALL </span>zasyi(zr, zi, fnu, kode, nn, cyr, cyi, nw, rl, tol, elim, alim)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">IF</span> (dfnu.LE.1.0d0) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">!     OVERFLOW AND UNDERFLOW TEST ON I SEQUENCE FOR MILLER ALGORITHM</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keyword">CALL </span>zuoik(zr, zi, fnu, kode, 1, nn, cyr, cyi, nw, tol, elim, alim)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      nz = nz + nw</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      nn = nn - nw</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">IF</span> (nn.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      dfnu = fnu+dble(float(nn-1))</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">IF</span> (dfnu.GT.fnul) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">IF</span> (az.GT.fnul) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">IF</span> (az.GT.rl) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">!     MILLER ALGORITHM NORMALIZED BY THE SERIES</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keyword">CALL </span>zmlri(zr, zi, fnu, kode, nn, cyr, cyi, nw, tol)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">IF</span>(nw.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">!     MILLER ALGORITHM NORMALIZED BY THE WRONSKIAN</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">!     OVERFLOW TEST ON K FUNCTIONS USED IN WRONSKIAN</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keyword">CALL </span>zuoik(zr, zi, fnu, kode, 2, 2, cwr, cwi, nw, tol, elim, alim)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">IF</span> (nw.GE.0) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      nz = nn</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">DO</span> 90 i=1,nn</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        cyr(i) = zeror</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        cyi(i) = zeroi</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">IF</span> (nw.GT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keyword">CALL </span>zwrsk(zr, zi, fnu, kode, nn, cyr, cyi, nw, cwr, cwi, tol, elim, alim)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">!     INCREMENT FNU+NN-1 UP TO FNUL, COMPUTE AND RECUR BACKWARD</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      nui = int(sngl(fnul-dfnu)) + 1</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      nui = max0(nui,0)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keyword">CALL </span>zbuni(zr, zi, fnu, kode, nn, cyr, cyi, nw, nui, nlast, fnul, &amp;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      tol, elim, alim)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      nz = nz + nw</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">IF</span> (nlast.EQ.0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      nn = nlast</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      nz = -1</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">IF</span>(nw.EQ.(-2)) nz=-2</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">SUBROUTINE </span>zseri(ZR, ZI, FNU, KODE, N, YR, YI, NZ, TOL, ELIM, ALIM)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZSERI</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">!     ZSERI COMPUTES THE I BESSEL FUNCTION FOR REAL(Z).GE.0.0 BY</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">!     MEANS OF THE POWER SERIES FOR LARGE CABS(Z) IN THE</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">!     REGION CABS(Z).LE.2*SQRT(FNU+1). NZ=0 IS A NORMAL RETURN.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">!     NZ.GT.0 MEANS THAT THE LAST NZ COMPONENTS WERE SET TO ZERO</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">!     DUE TO UNDERFLOW. NZ.LT.0 MEANS UNDERFLOW OCCURRED, BUT THE</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">!     CONDITION CABS(Z).LE.2*SQRT(FNU+1) WAS VIOLATED AND THE</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">!     COMPUTATION MUST BE COMPLETED IN ANOTHER ROUTINE WITH N=N-ABS(NZ).</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">!***ROUTINES CALLED  DGAMLN,D1MACH,ZUCHK,ZABS,ZDIV,ZLOG,ZMLT</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">!***END PROLOGUE  ZSERI</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">!     COMPLEX AK1,CK,COEF,CONE,CRSC,CSCL,CZ,CZERO,HZ,RZ,S1,S2,Y,Z</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, acz, ak, ak1i, ak1r, alim, arm, ascle, atol, &amp;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      az, cki, ckr, coefi, coefr, conei, coner, crscr, czi, czr, dfnu, &amp;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      elim, fnu, fnup, hzi, hzr, raz, rs, rtr1, rzi, rzr, s, ss, sti,  &amp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      str, s1i, s1r, s2i, s2r, tol, yi, yr, wi, wr, zeroi, zeror, zi,  &amp;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      zr<span class="comment">!, DGAMLN</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordtype">INTEGER</span> i, ib, idum, iflag, il, k, kode, l, m, n, nn, nz, nw</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      dimension yr(1), yi(1), wr(2), wi(2)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      nz = 0</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">IF</span> (az.EQ.0.0d0) <span class="keywordflow">GO TO</span> 160</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      arm = 1.0d+3*d1mach(1)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      rtr1 = dsqrt(arm)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      crscr = 1.0d0</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      iflag = 0</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">IF</span> (az.LT.arm) <span class="keywordflow">GO TO</span> 150</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      hzr = 0.5d0*zr</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      hzi = 0.5d0*zi</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      czr = zeror</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      czi = zeroi</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">IF</span> (az.LE.rtr1) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keyword">CALL </span>zmlt(hzr, hzi, hzr, hzi, czr, czi)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      acz = zabs(czr,czi)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      nn = n</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keyword">CALL </span>zlog(hzr, hzi, ckr, cki, idum)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      dfnu = fnu + dble(float(nn-1))</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      fnup = dfnu + 1.0d0</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">!     UNDERFLOW TEST</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      ak1r = ckr*dfnu</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      ak1i = cki*dfnu</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      ak = dgamln(fnup,idum)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      ak1r = ak1r - ak</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.2) ak1r = ak1r - zr</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">IF</span> (ak1r.GT.(-elim)) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      nz = nz + 1</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      yr(nn) = zeror</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      yi(nn) = zeroi</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">IF</span> (acz.GT.dfnu) <span class="keywordflow">GO TO</span> 190</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      nn = nn - 1</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">IF</span> (nn.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">IF</span> (ak1r.GT.(-alim)) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      iflag = 1</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      ss = 1.0d0/tol</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      crscr = tol</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      ascle = arm*ss</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      aa = dexp(ak1r)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">IF</span> (iflag.EQ.1) aa = aa*ss</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      coefr = aa*dcos(ak1i)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      coefi = aa*dsin(ak1i)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      atol = tol*acz/fnup</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      il = min0(2,nn)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">DO</span> 90 i=1,il</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        dfnu = fnu + dble(float(nn-i))</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        fnup = dfnu + 1.0d0</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        s1r = coner</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        s1i = conei</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">IF</span> (acz.LT.tol*fnup) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        ak1r = coner</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ak1i = conei</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        ak = fnup + 2.0d0</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        s = fnup</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        aa = 2.0d0</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   60   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        rs = 1.0d0/s</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        str = ak1r*czr - ak1i*czi</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        sti = ak1r*czi + ak1i*czr</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        ak1r = str*rs</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        ak1i = sti*rs</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        s1r = s1r + ak1r</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        s1i = s1i + ak1i</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        s = s + ak</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        ak = ak + 2.0d0</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        aa = aa*acz*rs</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">IF</span> (aa.GT.atol) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   70   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        s2r = s1r*coefr - s1i*coefi</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        s2i = s1r*coefi + s1i*coefr</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        wr(i) = s2r</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        wi(i) = s2i</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">IF</span> (iflag.EQ.0) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keyword">CALL </span>zuchk(s2r, s2i, nw, ascle, tol)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   80   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        m = nn - i + 1</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        yr(m) = s2r*crscr</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        yi(m) = s2i*crscr</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.il) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keyword">CALL </span>zdiv(coefr, coefi, hzr, hzi, str, sti)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        coefr = str*dfnu</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        coefi = sti*dfnu</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">IF</span> (nn.LE.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      k = nn - 2</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      ak = dble(float(k))</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      raz = 1.0d0/az</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      str = zr*raz</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      rzr = (str+str)*raz</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      rzi = (sti+sti)*raz</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">IF</span> (iflag.EQ.1) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      ib = 3</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">DO</span> 110 i=ib,nn</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        yr(k) = (ak+fnu)*(rzr*yr(k+1)-rzi*yi(k+1)) + yr(k+2)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        yi(k) = (ak+fnu)*(rzr*yi(k+1)+rzi*yr(k+1)) + yi(k+2)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        ak = ak - 1.0d0</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        k = k - 1</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">!     RECUR BACKWARD WITH SCALED VALUES</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">!     EXP(-ALIM)=EXP(-ELIM)/TOL=APPROX. ONE PRECISION ABOVE THE</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">!     UNDERFLOW LIMIT = ASCLE = D1MACH(1)*SS*1.0D+3</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      s1r = wr(1)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      s1i = wi(1)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      s2r = wr(2)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      s2i = wi(2)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">DO</span> 130 l=3,nn</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        ckr = s2r</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        cki = s2i</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        s2r = s1r + (ak+fnu)*(rzr*ckr-rzi*cki)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        s2i = s1i + (ak+fnu)*(rzr*cki+rzi*ckr)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        s1r = ckr</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        s1i = cki</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        ckr = s2r*crscr</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        cki = s2i*crscr</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        yr(k) = ckr</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        yi(k) = cki</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        ak = ak - 1.0d0</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        k = k - 1</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">IF</span> (zabs(ckr,cki).GT.ascle) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      ib = l + 1</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">IF</span> (ib.GT.nn) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  150 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      nz = n</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">IF</span> (fnu.EQ.0.0d0) nz = nz - 1</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  160 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      yr(1) = zeror</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      yi(1) = zeroi</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">IF</span> (fnu.NE.0.0d0) <span class="keywordflow">GO TO</span> 170</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      yr(1) = coner</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      yi(1) = conei</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  170 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">DO</span> 180 i=2,n</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  180 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">!     RETURN WITH NZ.LT.0 IF CABS(Z*Z/4).GT.FNU+N-NZ-1 COMPLETE</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">!     THE CALCULATION IN CBINU WITH N=N-IABS(NZ)</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  190 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      nz = -nz</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keyword">SUBROUTINE </span>zasyi(ZR, ZI, FNU, KODE, N, YR, YI, NZ, RL, TOL, ELIM, ALIM)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZASYI</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">!     ZASYI COMPUTES THE I BESSEL FUNCTION FOR REAL(Z).GE.0.0 BY</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">!     MEANS OF THE ASYMPTOTIC EXPANSION FOR LARGE CABS(Z) IN THE</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">!     REGION CABS(Z).GT.MAX(RL,FNU*FNU/2). NZ=0 IS A NORMAL RETURN.</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">!     NZ.LT.0 INDICATES AN OVERFLOW ON KODE=1.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">!***ROUTINES CALLED  D1MACH,ZABS,ZDIV,ZEXP,ZMLT,ZSQRT</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">!***END PROLOGUE  ZASYI</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">!     COMPLEX AK1,CK,CONE,CS1,CS2,CZ,CZERO,DK,EZ,P1,RZ,S2,Y,Z</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, aez, ak, ak1i, ak1r, alim, arg, arm, atol,   &amp;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      az, bb, bk, cki, ckr, conei, coner, cs1i, cs1r, cs2i, cs2r, czi, &amp;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      czr, dfnu, dki, dkr, dnu2, elim, ezi, ezr, fdn, fnu, pi, p1i,    &amp;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      p1r, raz, rl, rtpi, rtr1, rzi, rzr, s, <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a>, sqk, sti, str, s2i,  &amp;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      s2r, tol, tzi, tzr, yi, yr, zeroi, zeror, zi, zr</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordtype">INTEGER</span> i, ib, il, inu, j, jl, k, kode, koded, m, n, nn, nz</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      dimension yr(1), yi(1)</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keyword">DATA</span> pi, rtpi  /3.14159265358979324d0 , 0.159154943091895336d0 /</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      nz = 0</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      arm = 1.0d+3*d1mach(1)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      rtr1 = dsqrt(arm)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      il = min0(2,n)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      dfnu = fnu + dble(float(n-il))</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">!     OVERFLOW TEST</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      raz = 1.0d0/az</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      str = zr*raz</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      ak1r = rtpi*str*raz</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      ak1i = rtpi*sti*raz</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">CALL </span>zsqrt(ak1r, ak1i, ak1r, ak1i)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      czr = zr</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      czi = zi</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">IF</span> (kode.NE.2) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      czr = zeror</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      czi = zi</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">IF</span> (dabs(czr).GT.elim) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      dnu2 = dfnu + dfnu</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      koded = 1</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordflow">IF</span> ((dabs(czr).GT.alim) .AND. (n.GT.2)) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      koded = 0</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keyword">CALL </span>zexp(czr, czi, str, sti)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keyword">CALL </span>zmlt(ak1r, ak1i, str, sti, ak1r, ak1i)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      fdn = 0.0d0</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordflow">IF</span> (dnu2.GT.rtr1) fdn = dnu2*dnu2</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      ezr = zr*8.0d0</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      ezi = zi*8.0d0</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">!     WHEN Z IS IMAGINARY, THE ERROR TEST MUST BE MADE RELATIVE TO THE</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">!     FIRST RECIPROCAL POWER SINCE THIS IS THE LEADING TERM OF THE</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">!     EXPANSION FOR THE IMAGINARY PART.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      aez = 8.0d0*az</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      s = tol/aez</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      jl = int(sngl(rl+rl)) + 2</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      p1r = zeror</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      p1i = zeroi</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">IF</span> (zi.EQ.0.0d0) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">!     CALCULATE EXP(PI*(0.5+FNU+N-IL)*I) TO MINIMIZE LOSSES OF</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">!     SIGNIFICANCE WHEN FNU OR N IS LARGE</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      inu = int(sngl(fnu))</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      arg = (fnu-dble(float(inu)))*pi</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      inu = inu + n - il</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      ak = -dsin(arg)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      bk = dcos(arg)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">IF</span> (zi.LT.0.0d0) bk = -bk</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      p1r = ak</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      p1i = bk</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">IF</span> (mod(inu,2).EQ.0) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      p1r = -p1r</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      p1i = -p1i</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">DO</span> 70 k=1,il</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        sqk = fdn - 1.0d0</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        atol = s*dabs(sqk)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a> = 1.0d0</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        cs1r = coner</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        cs1i = conei</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        cs2r = coner</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        cs2i = conei</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        ckr = coner</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        cki = conei</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        ak = 0.0d0</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        aa = 1.0d0</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        bb = aez</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        dkr = ezr</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        dki = ezi</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">DO</span> 40 j=1,jl</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="keyword">CALL </span>zdiv(ckr, cki, dkr, dki, str, sti)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          ckr = str*sqk</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          cki = sti*sqk</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          cs2r = cs2r + ckr</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          cs2i = cs2i + cki</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a> = -<a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          cs1r = cs1r + ckr*<a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          cs1i = cs1i + cki*<a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          dkr = dkr + ezr</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          dki = dki + ezi</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          aa = aa*dabs(sqk)/bb</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          bb = bb + aez</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          ak = ak + 8.0d0</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          sqk = sqk - ak</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="keywordflow">IF</span> (aa.LE.atol) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   40   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        s2r = cs1r</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        s2i = cs1i</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">IF</span> (zr+zr.GE.elim) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        tzr = zr + zr</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        tzi = zi + zi</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keyword">CALL </span>zexp(-tzr, -tzi, str, sti)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keyword">CALL </span>zmlt(str, sti, p1r, p1i, str, sti)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keyword">CALL </span>zmlt(str, sti, cs2r, cs2i, str, sti)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        s2r = s2r + str</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        s2i = s2i + sti</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   60   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        fdn = fdn + 8.0d0*dfnu + 4.0d0</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        p1r = -p1r</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        p1i = -p1i</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        m = n - il + k</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        yr(m) = s2r*ak1r - s2i*ak1i</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        yi(m) = s2r*ak1i + s2i*ak1r</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">IF</span> (n.LE.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      nn = n</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      k = nn - 2</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      ak = dble(float(k))</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      str = zr*raz</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      rzr = (str+str)*raz</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      rzi = (sti+sti)*raz</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      ib = 3</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordflow">DO</span> 80 i=ib,nn</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        yr(k) = (ak+fnu)*(rzr*yr(k+1)-rzi*yi(k+1)) + yr(k+2)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        yi(k) = (ak+fnu)*(rzr*yi(k+1)+rzi*yr(k+1)) + yi(k+2)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        ak = ak - 1.0d0</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        k = k - 1</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordflow">IF</span> (koded.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keyword">CALL </span>zexp(czr, czi, ckr, cki)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">DO</span> 90 i=1,nn</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        str = yr(i)*ckr - yi(i)*cki</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        yi(i) = yr(i)*cki + yi(i)*ckr</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        yr(i) = str</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      nz = -1</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      nz=-2</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keyword">SUBROUTINE </span>zuoik(ZR, ZI, FNU, KODE, IKFLG, N, YR, YI, NUF, TOL, ELIM, ALIM)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUOIK</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK,ZBESH</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">!     ZUOIK COMPUTES THE LEADING TERMS OF THE UNIFORM ASYMPTOTIC</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">!     EXPANSIONS FOR THE I AND K FUNCTIONS AND COMPARES THEM</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">!     (IN LOGARITHMI! FORM) TO ALIM AND ELIM FOR OVER AND UNDERFLOW</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">!     WHERE ALIM.LT.ELIM. IF THE MAGNITUDE, BASED ON THE LEADING</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">!     EXPONENTIAL, IS LESS THAN ALIM OR GREATER THAN -ALIM, THEN</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">!     THE RESULT IS ON SCALE. IF NOT, THEN A REFINED TEST USING OTHER</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">!     MULTIPLIERS (IN LOGARITHMI! FORM) IS MADE BASED ON ELIM. HERE</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">!     EXP(-ELIM)=SMALLEST MACHINE NUMBER*1.0E+3 AND EXP(-ALIM)=</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">!     EXP(-ELIM)/TOL</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">!     IKFLG=1 MEANS THE I SEQUENCE IS TESTED</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">!          =2 MEANS THE K SEQUENCE IS TESTED</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">!     NUF = 0 MEANS THE LAST MEMBER OF THE SEQUENCE IS ON SCALE</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">!         =-1 MEANS AN OVERFLOW WOULD OCCUR</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">!     IKFLG=1 AND NUF.GT.0 MEANS THE LAST NUF Y VALUES WERE SET TO ZERO</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">!             THE FIRST N-NUF VALUES MUST BE SET BY ANOTHER ROUTINE</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">!     IKFLG=2 AND NUF.EQ.N MEANS ALL Y VALUES WERE SET TO ZERO</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">!     IKFLG=2 AND 0.LT.NUF.LT.N NOT CONSIDERED. Y MUST BE SET BY</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">!             ANOTHER ROUTINE</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">!***ROUTINES CALLED  ZUCHK,ZUNHJ,ZUNIK,D1MACH,ZABS,ZLOG</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">!***END PROLOGUE  ZUOIK</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">!     COMPLEX ARG,ASUM,BSUM,CWRK,CZ,CZERO,PHI,SUM,Y,Z,ZB,ZETA1,ZETA2,ZN,</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">!    *ZR</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aarg, aic, alim, aphi, argi, argr, asumi, asumr, &amp;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      ascle, ax, ay, bsumi, bsumr, cwrki, cwrkr, czi, czr, elim, fnn,  &amp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      fnu, gnn, gnu, phii, phir, rcz, str, sti, sumi, sumr, tol, yi,   &amp;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      yr, zbi, zbr, zeroi, zeror, zeta1i, zeta1r, zeta2i, zeta2r, zi,  &amp;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      zni, znr, zr, zri, zrr</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordtype">INTEGER</span> i, idum, iform, ikflg, init, kode, n, nn, nuf, nw</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      dimension yr(1), yi(1), cwrkr(16), cwrki(16)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi / 0.0d0, 0.0d0 /</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keyword">DATA</span> aic / 1.265512123484645396d+00 /</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      nuf = 0</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      nn = n</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      zrr = zr</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      zri = zi</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">IF</span> (zr.GE.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      zrr = -zr</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      zri = -zi</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      zbr = zrr</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      zbi = zri</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      ax = dabs(zr)*1.7321d0</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      ay = dabs(zi)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      iform = 1</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">IF</span> (ay.GT.ax) iform = 2</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      gnu = dmax1(fnu,1.0d0)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">IF</span> (ikflg.EQ.1) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      fnn = dble(float(nn))</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      gnn = fnu + fnn - 1.0d0</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      gnu = dmax1(gnn,fnn)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">!     ONLY THE MAGNITUDE OF ARG AND PHI ARE NEEDED ALONG WITH THE</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">!     REAL PARTS OF ZETA1, ZETA2 AND ZB. NO ATTEMPT IS MADE TO GET</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">!     THE SIGN OF THE IMAGINARY PART CORRECT.</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      init = 0</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keyword">CALL </span>zunik(zrr, zri, gnu, ikflg, 1, tol, init, phir, phii, &amp;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      zeta1r, zeta1i, zeta2r, zeta2i, sumr, sumi, cwrkr, cwrki)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      czr = -zeta1r + zeta2r</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      czi = -zeta1i + zeta2i</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      znr = zri</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      zni = -zrr</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">IF</span> (zi.GT.0.0d0) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      znr = -znr</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keyword">CALL </span>zunhj(znr, zni, gnu, 1, tol, phir, phii, argr, argi, zeta1r, &amp;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      zeta1i, zeta2r, zeta2i, asumr, asumi, bsumr, bsumi)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      czr = -zeta1r + zeta2r</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      czi = -zeta1i + zeta2i</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      aarg = zabs(argr,argi)</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      czr = czr - zbr</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      czi = czi - zbi</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">IF</span> (ikflg.EQ.1) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      czr = -czr</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      czi = -czi</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      aphi = zabs(phir,phii)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      rcz = czr</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">!     OVERFLOW TEST</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.elim) <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">IF</span> (rcz.LT.alim) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      rcz = rcz + dlog(aphi)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) rcz = rcz - 0.25d0*dlog(aarg) - aic</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.elim) <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">!     UNDERFLOW TEST</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">IF</span> (rcz.LT.(-elim)) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.(-alim)) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      rcz = rcz + dlog(aphi)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) rcz = rcz - 0.25d0*dlog(aarg) - aic</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.(-elim)) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">DO</span> 100 i=1,nn</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      nuf = nn</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      ascle = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keyword">CALL </span>zlog(phir, phii, str, sti, idum)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      czr = czr + str</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      czi = czi + sti</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.1) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keyword">CALL </span>zlog(argr, argi, str, sti, idum)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      czr = czr - 0.25d0*str - aic</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      czi = czi - 0.25d0*sti</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      ax = dexp(rcz)/tol</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      ay = czi</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      czr = ax*dcos(ay)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      czi = ax*dsin(ay)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keyword">CALL </span>zuchk(czr, czi, nw, ascle, tol)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">IF</span> (ikflg.EQ.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">!     SET UNDERFLOWS ON I SEQUENCE</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      gnu = fnu + dble(float(nn-1))</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) <span class="keywordflow">GO TO</span> 150</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      init = 0</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keyword">CALL </span>zunik(zrr, zri, gnu, ikflg, 1, tol, init, phir, phii, &amp;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      zeta1r, zeta1i, zeta2r, zeta2i, sumr, sumi, cwrkr, cwrki)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      czr = -zeta1r + zeta2r</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      czi = -zeta1i + zeta2i</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keywordflow">GO TO</span> 160</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  150 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keyword">CALL </span>zunhj(znr, zni, gnu, 1, tol, phir, phii, argr, argi, zeta1r, &amp;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      zeta1i, zeta2r, zeta2i, asumr, asumi, bsumr, bsumi)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      czr = -zeta1r + zeta2r</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      czi = -zeta1i + zeta2i</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      aarg = zabs(argr,argi)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  160 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 170</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      czr = czr - zbr</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      czi = czi - zbi</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  170 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      aphi = zabs(phir,phii)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      rcz = czr</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">IF</span> (rcz.LT.(-elim)) <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.(-alim)) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      rcz = rcz + dlog(aphi)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) rcz = rcz - 0.25d0*dlog(aarg) - aic</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">IF</span> (rcz.GT.(-elim)) <span class="keywordflow">GO TO</span> 190</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  180 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      yr(nn) = zeror</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      yi(nn) = zeroi</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      nn = nn - 1</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      nuf = nuf + 1</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">IF</span> (nn.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  190 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      ascle = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keyword">CALL </span>zlog(phir, phii, str, sti, idum)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      czr = czr + str</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      czi = czi + sti</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.1) <span class="keywordflow">GO TO</span> 200</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keyword">CALL </span>zlog(argr, argi, str, sti, idum)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      czr = czr - 0.25d0*str - aic</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      czi = czi - 0.25d0*sti</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      ax = dexp(rcz)/tol</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      ay = czi</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      czr = ax*dcos(ay)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      czi = ax*dsin(ay)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keyword">CALL </span>zuchk(czr, czi, nw, ascle, tol)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  210 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      nuf = -1</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keyword">SUBROUTINE </span>zbuni(ZR, ZI, FNU, KODE, N, YR, YI, NZ, NUI, NLAST, FNUL, TOL, ELIM, ALIM)</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZBUNI</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">!     ZBUNI COMPUTES THE I BESSEL FUNCTION FOR LARGE CABS(Z).GT.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">!     FNUL AND FNU+N-1.LT.FNUL. THE ORDER IS INCREASED FROM</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">!     FNU+N-1 GREATER THAN FNUL BY ADDING NUI AND COMPUTING</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">!     ACCORDING TO THE UNIFORM ASYMPTOTIC EXPANSION FOR I(FNU,Z)</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">!     ON IFORM=1 AND THE EXPANSION FOR J(FNU,Z) ON IFORM=2</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">!***ROUTINES CALLED  ZUNI1,ZUNI2,ZABS,D1MACH</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">!***END PROLOGUE  ZBUNI</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">!     COMPLEX CSCL,CSCR,CY,RZ,ST,S1,S2,Y,Z</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> alim, ax, ay, csclr, cscrr, cyi, cyr, dfnu,    &amp;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      elim, fnu, fnui, fnul, gnu, raz, rzi, rzr, sti, str, s1i, s1r,  &amp;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      s2i, s2r, tol, yi, yr, zi, zr, ascle, bry, c1r, c1i, c1m</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordtype">INTEGER</span> i, iflag, iform, k, kode, n, nl, nlast, nui, nw, nz</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      dimension yr(1), yi(1), cyr(2), cyi(2), bry(3)</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      nz = 0</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      ax = dabs(zr)*1.7321d0</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      ay = dabs(zi)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      iform = 1</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keywordflow">IF</span> (ay.GT.ax) iform = 2</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">IF</span> (nui.EQ.0) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      fnui = dble(float(nui))</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      dfnu = fnu + dble(float(n-1))</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      gnu = dfnu + fnui</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR I(FNU,Z) FOR LARGE FNU APPLIED IN</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">!     -PI/3.LE.ARG(Z).LE.PI/3</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keyword">CALL </span>zuni1(zr, zi, gnu, kode, 2, cyr, cyi, nw, nlast, fnul, tol, elim, alim)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR J(FNU,Z*EXP(M*HPI)) FOR LARGE FNU</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">!     APPLIED IN PI/3.LT.ABS(ARG(Z)).LE.PI/2 WHERE M=+I OR -I</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">!     AND HPI=PI/2</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="keyword">CALL </span>zuni2(zr, zi, gnu, kode, 2, cyr, cyi, nw, nlast, fnul, tol, elim, alim)</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      str = zabs(cyr(1),cyi(1))</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">!     SCALE BACKWARD RECURRENCE, BRY(3) IS DEFINED BUT NEVER USED</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      bry(1)=1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      bry(2) = 1.0d0/bry(1)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      bry(3) = bry(2)</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      iflag = 2</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      ascle = bry(2)</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      csclr = 1.0d0</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">IF</span> (str.GT.bry(1)) <span class="keywordflow">GO TO</span> 21</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      iflag = 1</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      ascle = bry(1)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      csclr = 1.0d0/tol</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keywordflow">GO TO</span> 25</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   21 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">IF</span> (str.LT.bry(2)) <span class="keywordflow">GO TO</span> 25</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      iflag = 3</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      ascle=bry(3)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      csclr = tol</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   25 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      cscrr = 1.0d0/csclr</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      s1r = cyr(2)*csclr</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      s1i = cyi(2)*csclr</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      s2r = cyr(1)*csclr</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      s2i = cyi(1)*csclr</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      raz = 1.0d0/zabs(zr,zi)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      str = zr*raz</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      rzr = (str+str)*raz</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      rzi = (sti+sti)*raz</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">DO</span> 30 i=1,nui</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        str = s2r</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        sti = s2i</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        s2r = (dfnu+fnui)*(rzr*str-rzi*sti) + s1r</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        s2i = (dfnu+fnui)*(rzr*sti+rzi*str) + s1i</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        s1r = str</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        s1i = sti</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        fnui = fnui - 1.0d0</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordflow">IF</span> (iflag.GE.3) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        str = s2r*cscrr</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        sti = s2i*cscrr</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        c1r = dabs(str)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        c1i = dabs(sti)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        c1m = dmax1(c1r,c1i)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">IF</span> (c1m.LE.ascle) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        iflag = iflag+1</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        ascle = bry(iflag)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        s1r = s1r*cscrr</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        s1i = s1i*cscrr</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        s2r = str</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        s2i = sti</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        csclr = csclr*tol</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        cscrr = 1.0d0/csclr</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        s1r = s1r*csclr</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        s1i = s1i*csclr</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        s2r = s2r*csclr</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        s2i = s2i*csclr</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      yr(n) = s2r*cscrr</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      yi(n) = s2i*cscrr</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      nl = n - 1</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      fnui = dble(float(nl))</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      k = nl</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">DO</span> 40 i=1,nl</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        str = s2r</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        sti = s2i</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        s2r = (fnu+fnui)*(rzr*str-rzi*sti) + s1r</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        s2i = (fnu+fnui)*(rzr*sti+rzi*str) + s1i</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        s1r = str</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        s1i = sti</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        str = s2r*cscrr</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        sti = s2i*cscrr</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        yr(k) = str</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        yi(k) = sti</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        fnui = fnui - 1.0d0</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        k = k - 1</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">IF</span> (iflag.GE.3) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        c1r = dabs(str)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        c1i = dabs(sti)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        c1m = dmax1(c1r,c1i)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">IF</span> (c1m.LE.ascle) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        iflag = iflag+1</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        ascle = bry(iflag)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        s1r = s1r*cscrr</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        s1i = s1i*cscrr</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        s2r = str</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        s2i = sti</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        csclr = csclr*tol</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        cscrr = 1.0d0/csclr</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        s1r = s1r*csclr</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        s1i = s1i*csclr</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        s2r = s2r*csclr</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        s2i = s2i*csclr</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      nz = -1</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">IF</span>(nw.EQ.(-2)) nz=-2</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="keywordflow">IF</span> (iform.EQ.2) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR I(FNU,Z) FOR LARGE FNU APPLIED IN</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">!     -PI/3.LE.ARG(Z).LE.PI/3</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keyword">CALL </span>zuni1(zr, zi, fnu, kode, n, yr, yi, nw, nlast, fnul, tol, elim, alim)</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR J(FNU,Z*EXP(M*HPI)) FOR LARGE FNU</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">!     APPLIED IN PI/3.LT.ABS(ARG(Z)).LE.PI/2 WHERE M=+I OR -I</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">!     AND HPI=PI/2</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keyword">CALL </span>zuni2(zr, zi, fnu, kode, n, yr, yi, nw, nlast, fnul, tol, elim, alim)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      nz = nw</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      nlast = n</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="keyword">SUBROUTINE </span>zuni1(ZR, ZI, FNU, KODE, N, YR, YI, NZ, NLAST, FNUL, TOL, ELIM, ALIM)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUNI1</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">!     ZUNI1 COMPUTES I(FNU,Z)  BY MEANS OF THE UNIFORM ASYMPTOTIC</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">!     EXPANSION FOR I(FNU,Z) IN -PI/3.LE.ARG Z.LE.PI/3.</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">!     FNUL IS THE SMALLEST ORDER PERMITTED FOR THE ASYMPTOTIC</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">!     EXPANSION. NLAST=0 MEANS ALL OF THE Y VALUES WERE SET.</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">!     NLAST.NE.0 IS THE NUMBER LEFT TO BE COMPUTED BY ANOTHER</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">!     FORMULA FOR ORDERS FNU TO FNU+NLAST-1 BECAUSE FNU+NLAST-1.LT.FNUL.</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">!     Y(I)=CZERO FOR I=NLAST+1,N</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">!***ROUTINES CALLED  ZUCHK,ZUNIK,ZUOIK,D1MACH,ZABS</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">!***END PROLOGUE  ZUNI1</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">!     COMPLEX CFN,CONE,CRSC,CSCL,CSR,CSS,CWRK,CZERO,C1,C2,PHI,RZ,SUM,S1,</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">!    *S2,Y,Z,ZETA1,ZETA2</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> alim, aphi, ascle, bry, conei, coner, crsc,  &amp;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      cscl, csrr, cssr, cwrki, cwrkr, c1r, c2i, c2m, c2r, elim, fn, &amp;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      fnu, fnul, phii, phir, rast, rs1, rzi, rzr, sti, str, sumi,   &amp;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      sumr, s1i, s1r, s2i, s2r, tol, yi, yr, zeroi, zeror, zeta1i,  &amp;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      zeta1r, zeta2i, zeta2r, zi, zr, cyr, cyi</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="keywordtype">INTEGER</span> i, iflag, init, k, kode, m, n, nd, nlast, nn, nuf, nw, nz</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      dimension bry(3), yr(1), yi(1), cwrkr(16), cwrki(16), cssr(3), &amp;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      csrr(3), cyr(2), cyi(2)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      nz = 0</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      nd = n</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      nlast = 0</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">!     COMPUTED VALUES WITH EXPONENTS BETWEEN ALIM AND ELIM IN MAG-</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">!     NITUDE ARE SCALED TO KEEP INTERMEDIATE ARITHMETIC ON SCALE,</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">!     EXP(ALIM)=EXP(ELIM)*TOL</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      cscl = 1.0d0/tol</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      crsc = tol</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      cssr(1) = cscl</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      cssr(2) = coner</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      cssr(3) = crsc</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      csrr(1) = crsc</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      csrr(2) = coner</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      csrr(3) = cscl</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      bry(1) = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">!     CHECK FOR UNDERFLOW AND OVERFLOW ON FIRST MEMBER</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      fn = dmax1(fnu,1.0d0)</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      init = 0</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keyword">CALL </span>zunik(zr, zi, fn, 1, 1, tol, init, phir, phii, zeta1r, &amp;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      zeta1i, zeta2r, zeta2i, sumr, sumi, cwrkr, cwrki)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      str = zr + zeta2r</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      sti = zi + zeta2i</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      rast = fn/zabs(str,sti)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      str = str*rast*rast</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      sti = -sti*rast*rast</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      s1r = -zeta1r + str</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      s1i = -zeta1i + sti</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      s1r = -zeta1r + zeta2r</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      s1i = -zeta1i + zeta2i</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      rs1 = s1r</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      nn = min0(2,nd)</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">DO</span> 80 i=1,nn</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        fn = fnu + dble(float(nd-i))</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        init = 0</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keyword">CALL </span>zunik(zr, zi, fn, 1, 0, tol, init, phir, phii, zeta1r, &amp;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        zeta1i, zeta2r, zeta2i, sumr, sumi, cwrkr, cwrki)</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        str = zr + zeta2r</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        sti = zi + zeta2i</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        rast = fn/zabs(str,sti)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        str = str*rast*rast</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        sti = -sti*rast*rast</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        s1r = -zeta1r + str</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        s1i = -zeta1i + sti + zi</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   40   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        s1r = -zeta1r + zeta2r</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        s1i = -zeta1i + zeta2i</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">!     TEST FOR UNDERFLOW AND OVERFLOW</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        rs1 = s1r</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 2</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).LT.alim) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">!     REFINE  TEST AND SCALE</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        aphi = zabs(phir,phii)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        rs1 = rs1 + dlog(aphi)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 1</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">IF</span> (rs1.LT.0.0d0) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 3</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   60   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">!     SCALE S1 IF CABS(S1).LT.ASCLE</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        s2r = phir*sumr - phii*sumi</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        s2i = phir*sumi + phii*sumr</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        str = dexp(s1r)*cssr(iflag)</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        s1r = str*dcos(s1i)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        s1i = str*dsin(s1i)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        str = s2r*s1r - s2i*s1i</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        s2i = s2r*s1i + s2i*s1r</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        s2r = str</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keywordflow">IF</span> (iflag.NE.1) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keyword">CALL </span>zuchk(s2r, s2i, nw, bry(1), tol)</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   70   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        cyr(i) = s2r</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        cyi(i) = s2i</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        m = nd - i + 1</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        yr(m) = s2r*csrr(iflag)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        yi(m) = s2i*csrr(iflag)</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keywordflow">IF</span> (nd.LE.2) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      rast = 1.0d0/zabs(zr,zi)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      str = zr*rast</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      sti = -zi*rast</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      rzr = (str+str)*rast</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      rzi = (sti+sti)*rast</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      bry(2) = 1.0d0/bry(1)</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      bry(3) = d1mach(2)</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      s1r = cyr(1)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      s1i = cyi(1)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      s2r = cyr(2)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      s2i = cyi(2)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      c1r = csrr(iflag)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      ascle = bry(iflag)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      k = nd - 2</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      fn = dble(float(k))</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">DO</span> 90 i=3,nd</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        c2r = s2r</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        c2i = s2i</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        s2r = s1r + (fnu+fn)*(rzr*c2r-rzi*c2i)</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        s2i = s1i + (fnu+fn)*(rzr*c2i+rzi*c2r)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        s1r = c2r</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        s1i = c2i</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        c2r = s2r*c1r</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        c2i = s2i*c1r</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        yr(k) = c2r</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        yi(k) = c2i</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        k = k - 1</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        fn = fn - 1.0d0</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">IF</span> (iflag.GE.3) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        str = dabs(c2r)</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        sti = dabs(c2i)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        c2m = dmax1(str,sti)</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">IF</span> (c2m.LE.ascle) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        iflag = iflag + 1</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        ascle = bry(iflag)</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        s1r = s1r*c1r</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        s1i = s1i*c1r</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        s2r = c2r</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        s2i = c2i</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        s1r = s1r*cssr(iflag)</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        s1i = s1i*cssr(iflag)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        s2r = s2r*cssr(iflag)</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        s2i = s2i*cssr(iflag)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        c1r = csrr(iflag)</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">!     SET UNDERFLOW AND UPDATE PARAMETERS</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keywordflow">IF</span> (rs1.GT.0.0d0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      yr(nd) = zeror</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      yi(nd) = zeroi</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      nz = nz + 1</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      nd = nd - 1</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordflow">IF</span> (nd.EQ.0) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keyword">CALL </span>zuoik(zr, zi, fnu, kode, 1, nd, yr, yi, nuf, tol, elim, alim)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordflow">IF</span> (nuf.LT.0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      nd = nd - nuf</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      nz = nz + nuf</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordflow">IF</span> (nd.EQ.0) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      fn = fnu + dble(float(nd-1))</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">IF</span> (fn.GE.fnul) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      nlast = nd</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      nz = -1</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordflow">IF</span> (rs1.GT.0.0d0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      nz = n</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordflow">DO</span> 140 i=1,n</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="keyword">SUBROUTINE </span>zuni2(ZR, ZI, FNU, KODE, N, YR, YI, NZ, NLAST, FNUL, TOL, ELIM, ALIM)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUNI2</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">!     ZUNI2 COMPUTES I(FNU,Z) IN THE RIGHT HALF PLANE BY MEANS OF</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">!     UNIFORM ASYMPTOTIC EXPANSION FOR J(FNU,ZN) WHERE ZN IS Z*I</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">!     OR -Z*I AND ZN IS IN THE RIGHT HALF PLANE ALSO.</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">!     FNUL IS THE SMALLEST ORDER PERMITTED FOR THE ASYMPTOTIC</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">!     EXPANSION. NLAST=0 MEANS ALL OF THE Y VALUES WERE SET.</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">!     NLAST.NE.0 IS THE NUMBER LEFT TO BE COMPUTED BY ANOTHER</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">!     FORMULA FOR ORDERS FNU TO FNU+NLAST-1 BECAUSE FNU+NLAST-1.LT.FNUL.</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">!     Y(I)=CZERO FOR I=NLAST+1,N</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">!***ROUTINES CALLED  ZAIRY,ZUCHK,ZUNHJ,ZUOIK,D1MACH,ZABS</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">!***END PROLOGUE  ZUNI2</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">!     COMPLEX AI,ARG,ASUM,BSUM,CFN,CI,CID,CIP,CONE,CRSC,CSCL,CSR,CSS,</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">!    *CZERO,C1,C2,DAI,PHI,RZ,S1,S2,Y,Z,ZB,ZETA1,ZETA2,ZN</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aarg, aic, aii, air, alim, ang, aphi, argi,     &amp;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      argr, ascle, asumi, asumr, bry, bsumi, bsumr, cidi, cipi, cipr,  &amp;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      conei, coner, crsc, cscl, csrr, cssr, c1r, c2i, c2m, c2r, daii,  &amp;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      dair, elim, fn, fnu, fnul, hpi, phii, phir, rast, raz, rs1, rzi, &amp;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      rzr, sti, str, s1i, s1r, s2i, s2r, tol, yi, yr, zbi, zbr, zeroi, &amp;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      zeror, zeta1i, zeta1r, zeta2i, zeta2r, zi, zni, znr, zr, cyr, cyi</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordtype">INTEGER</span> i, iflag, in, inu, j, k, kode, n, nai, nd, ndai, nlast,  &amp;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      nn, nuf, nw, nz, idum</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      dimension bry(3), yr(1), yi(1), cipr(4), cipi(4), cssr(3),       &amp;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      csrr(3), cyr(2), cyi(2)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keyword">DATA</span> cipr(1),cipi(1),cipr(2),cipi(2),cipr(3),cipi(3),cipr(4),    &amp;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      cipi(4)/ 1.0d0,0.0d0, 0.0d0,1.0d0, -1.0d0,0.0d0, 0.0d0,-1.0d0/</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="keyword">DATA</span> hpi, aic  /1.57079632679489662d+00,  1.265512123484645396d+00/</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      nz = 0</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      nd = n</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      nlast = 0</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">!     COMPUTED VALUES WITH EXPONENTS BETWEEN ALIM AND ELIM IN MAG-</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">!     NITUDE ARE SCALED TO KEEP INTERMEDIATE ARITHMETIC ON SCALE,</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">!     EXP(ALIM)=EXP(ELIM)*TOL</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      cscl = 1.0d0/tol</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      crsc = tol</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      cssr(1) = cscl</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      cssr(2) = coner</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      cssr(3) = crsc</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      csrr(1) = crsc</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      csrr(2) = coner</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      csrr(3) = cscl</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      bry(1) = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">!     ZN IS IN THE RIGHT HALF PLANE AFTER ROTATION BY CI OR -CI</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      znr = zi</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      zni = -zr</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      zbr = zr</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      zbi = zi</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      cidi = -coner</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      inu = int(sngl(fnu))</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      ang = hpi*(fnu-dble(float(inu)))</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      c2r = dcos(ang)</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      c2i = dsin(ang)</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      in = inu + n - 1</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      in = mod(in,4) + 1</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      str = c2r*cipr(in) - c2i*cipi(in)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      c2i = c2r*cipi(in) + c2i*cipr(in)</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      c2r = str</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="keywordflow">IF</span> (zi.GT.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      znr = -znr</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      zbi = -zbi</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      cidi = -cidi</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      c2i = -c2i</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">!     CHECK FOR UNDERFLOW AND OVERFLOW ON FIRST MEMBER</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      fn = dmax1(fnu,1.0d0)</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="keyword">CALL </span>zunhj(znr, zni, fn, 1, tol, phir, phii, argr, argi, zeta1r, &amp;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      zeta1i, zeta2r, zeta2i, asumr, asumi, bsumr, bsumi)</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      str = zbr + zeta2r</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      sti = zbi + zeta2i</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      rast = fn/zabs(str,sti)</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      str = str*rast*rast</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      sti = -sti*rast*rast</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      s1r = -zeta1r + str</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      s1i = -zeta1i + sti</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      s1r = -zeta1r + zeta2r</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      s1i = -zeta1i + zeta2i</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      rs1 = s1r</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 150</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      nn = min0(2,nd)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">DO</span> 90 i=1,nn</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        fn = fnu + dble(float(nd-i))</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keyword">CALL </span>zunhj(znr, zni, fn, 0, tol, phir, phii, argr, argi, &amp;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        zeta1r, zeta1i, zeta2r, zeta2i, asumr, asumi, bsumr, bsumi)</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        str = zbr + zeta2r</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        sti = zbi + zeta2i</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        rast = fn/zabs(str,sti)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        str = str*rast*rast</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        sti = -sti*rast*rast</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        s1r = -zeta1r + str</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        s1i = -zeta1i + sti + dabs(zi)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        s1r = -zeta1r + zeta2r</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        s1i = -zeta1i + zeta2i</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   60   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">!     TEST FOR UNDERFLOW AND OVERFLOW</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        rs1 = s1r</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 2</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).LT.alim) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">!     REFINE  TEST AND SCALE</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        aphi = zabs(phir,phii)</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        aarg = zabs(argr,argi)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        rs1 = rs1 + dlog(aphi) - 0.25d0*dlog(aarg) - aic</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="keywordflow">IF</span> (dabs(rs1).GT.elim) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 1</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">IF</span> (rs1.LT.0.0d0) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <span class="keywordflow">IF</span> (i.EQ.1) iflag = 3</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   70   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">!     SCALE S1 TO KEEP INTERMEDIATE ARITHMETIC ON SCALE NEAR</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">!     EXPONENT EXTREMES</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keyword">CALL </span>zairy(argr, argi, 0, 2, air, aii, nai, idum)</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keyword">CALL </span>zairy(argr, argi, 1, 2, dair, daii, ndai, idum)</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        str = dair*bsumr - daii*bsumi</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        sti = dair*bsumi + daii*bsumr</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        str = str + (air*asumr-aii*asumi)</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        sti = sti + (air*asumi+aii*asumr)</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        s2r = phir*str - phii*sti</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        s2i = phir*sti + phii*str</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        str = dexp(s1r)*cssr(iflag)</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        s1r = str*dcos(s1i)</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        s1i = str*dsin(s1i)</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        str = s2r*s1r - s2i*s1i</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        s2i = s2r*s1i + s2i*s1r</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        s2r = str</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">IF</span> (iflag.NE.1) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keyword">CALL </span>zuchk(s2r, s2i, nw, bry(1), tol)</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;   80   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">IF</span> (zi.LE.0.0d0) s2i = -s2i</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        str = s2r*c2r - s2i*c2i</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        s2i = s2r*c2i + s2i*c2r</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        s2r = str</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        cyr(i) = s2r</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        cyi(i) = s2i</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        j = nd - i + 1</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        yr(j) = s2r*csrr(iflag)</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        yi(j) = s2i*csrr(iflag)</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        str = -c2i*cidi</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        c2i = c2r*cidi</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        c2r = str</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="keywordflow">IF</span> (nd.LE.2) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      raz = 1.0d0/zabs(zr,zi)</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      str = zr*raz</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      rzr = (str+str)*raz</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      rzi = (sti+sti)*raz</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      bry(2) = 1.0d0/bry(1)</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      bry(3) = d1mach(2)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      s1r = cyr(1)</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      s1i = cyi(1)</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      s2r = cyr(2)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      s2i = cyi(2)</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      c1r = csrr(iflag)</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      ascle = bry(iflag)</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      k = nd - 2</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      fn = dble(float(k))</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordflow">DO</span> 100 i=3,nd</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        c2r = s2r</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        c2i = s2i</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        s2r = s1r + (fnu+fn)*(rzr*c2r-rzi*c2i)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        s2i = s1i + (fnu+fn)*(rzr*c2i+rzi*c2r)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        s1r = c2r</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        s1i = c2i</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        c2r = s2r*c1r</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        c2i = s2i*c1r</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        yr(k) = c2r</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        yi(k) = c2i</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        k = k - 1</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        fn = fn - 1.0d0</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <span class="keywordflow">IF</span> (iflag.GE.3) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        str = dabs(c2r)</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        sti = dabs(c2i)</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        c2m = dmax1(str,sti)</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="keywordflow">IF</span> (c2m.LE.ascle) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        iflag = iflag + 1</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        ascle = bry(iflag)</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        s1r = s1r*c1r</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        s1i = s1i*c1r</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        s2r = c2r</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        s2i = c2i</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        s1r = s1r*cssr(iflag)</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        s1i = s1i*cssr(iflag)</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        s2r = s2r*cssr(iflag)</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        s2i = s2i*cssr(iflag)</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        c1r = csrr(iflag)</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">IF</span> (rs1.GT.0.0d0) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">!     SET UNDERFLOW AND UPDATE PARAMETERS</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      yr(nd) = zeror</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      yi(nd) = zeroi</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      nz = nz + 1</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      nd = nd - 1</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">IF</span> (nd.EQ.0) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="keyword">CALL </span>zuoik(zr, zi, fnu, kode, 1, nd, yr, yi, nuf, tol, elim, alim)</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">IF</span> (nuf.LT.0) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      nd = nd - nuf</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      nz = nz + nuf</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">IF</span> (nd.EQ.0) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      fn = fnu + dble(float(nd-1))</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordflow">IF</span> (fn.LT.fnul) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      fn = cidi</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      j = nuf + 1</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      k = mod(j,4) + 1</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      s1r = cipr(k)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      s1i = cipi(k)</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">IF</span> (fn.LT.0.0d0) s1i = -s1i</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      str = c2r*s1r - c2i*s1i</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      c2i = c2r*s1i + c2i*s1r</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      c2r = str</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      nlast = nd</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      nz = -1</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  150 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keywordflow">IF</span> (rs1.GT.0.0d0) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      nz = n</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordflow">DO</span> 160 i=1,n</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  160 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="keyword">      END</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="keyword">SUBROUTINE </span>zwrsk(ZRR, ZRI, FNU, KODE, N, YR, YI, NZ, CWR, CWI, TOL, ELIM, ALIM)</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZWRSK</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">!     ZWRSK COMPUTES THE I BESSEL FUNCTION FOR RE(Z).GE.0.0 BY</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">!     NORMALIZING THE I FUNCTION RATIOS FROM ZRATI BY THE WRONSKIAN</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">!***ROUTINES CALLED  D1MACH,ZBKNU,ZRATI,ZABS</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">!***END PROLOGUE  ZWRSK</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">!     COMPLEX CINU,CSCL,CT,CW,C1,C2,RCT,ST,Y,ZR</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> act, acw, alim, ascle, cinui, cinur, csclr, cti, &amp;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      ctr, cwi, cwr, c1i, c1r, c2i, c2r, elim, fnu, pti, ptr, ract,     &amp;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      sti, str, tol, yi, yr, zri, zrr</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordtype">INTEGER</span> i, kode, n, nw, nz</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      dimension yr(1), yi(1), cwr(2), cwi(2)</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">!     I(FNU+I-1,Z) BY BACKWARD RECURRENCE FOR RATIOS</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">!     Y(I)=I(FNU+I,Z)/I(FNU+I-1,Z) FROM CRATI NORMALIZED BY THE</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">!     WRONSKIAN WITH K(FNU,Z) AND K(FNU+1,Z) FROM CBKNU.</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      nz = 0</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="keyword">CALL </span>zbknu(zrr, zri, fnu, kode, 2, cwr, cwi, nw, tol, elim, alim)</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keyword">CALL </span>zrati(zrr, zri, fnu, n, yr, yi, tol)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">!     RECUR FORWARD ON I(FNU+1,Z) = R(FNU,Z)*I(FNU,Z),</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">!     R(FNU+J-1,Z)=Y(J),  J=1,...,N</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      cinur = 1.0d0</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      cinui = 0.0d0</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      cinur = dcos(zri)</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      cinui = dsin(zri)</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">!     ON LOW EXPONENT MACHINES THE K FUNCTIONS CAN BE CLOSE TO BOTH</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">!     THE UNDER AND OVERFLOW LIMITS AND THE NORMALIZATION MUST BE</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">!     SCALED TO PREVENT OVER OR UNDERFLOW. CUOIK HAS DETERMINED THAT</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">!     THE RESULT IS ON SCALE.</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      acw = zabs(cwr(2),cwi(2))</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      ascle = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      csclr = 1.0d0</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">IF</span> (acw.GT.ascle) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      csclr = 1.0d0/tol</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      ascle = 1.0d0/ascle</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="keywordflow">IF</span> (acw.LT.ascle) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      csclr = tol</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      c1r = cwr(1)*csclr</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      c1i = cwi(1)*csclr</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      c2r = cwr(2)*csclr</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      c2i = cwi(2)*csclr</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      str = yr(1)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      sti = yi(1)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">!     CINU=CINU*(CONJG(CT)/CABS(CT))*(1.0D0/CABS(CT) PREVENTS</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">!     UNDER- OR OVERFLOW PREMATURELY BY SQUARING CABS(CT)</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      ptr = str*c1r - sti*c1i</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      pti = str*c1i + sti*c1r</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      ptr = ptr + c2r</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      pti = pti + c2i</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      ctr = zrr*ptr - zri*pti</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      cti = zrr*pti + zri*ptr</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      act = zabs(ctr,cti)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      ract = 1.0d0/act</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      ctr = ctr*ract</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      cti = -cti*ract</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      ptr = cinur*ract</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      pti = cinui*ract</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      cinur = ptr*ctr - pti*cti</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      cinui = ptr*cti + pti*ctr</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      yr(1) = cinur*csclr</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      yi(1) = cinui*csclr</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">DO</span> 40 i=2,n</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        ptr = str*cinur - sti*cinui</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        cinui = str*cinui + sti*cinur</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        cinur = ptr</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        str = yr(i)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        sti = yi(i)</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        yr(i) = cinur*csclr</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        yi(i) = cinui*csclr</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      nz = -1</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keywordflow">IF</span>(nw.EQ.(-2)) nz=-2</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="keyword">SUBROUTINE </span>zbknu(ZR, ZI, FNU, KODE, N, YR, YI, NZ, TOL, ELIM, ALIM)</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZBKNU</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK,ZAIRY,ZBESH</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">!     ZBKNU COMPUTES THE K BESSEL FUNCTION IN THE RIGHT HALF Z PLANE.</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">!***ROUTINES CALLED  DGAMLN,I1MACH,D1MACH,ZKSCL,ZSHCH,ZUCHK,ZABS,ZDIV,</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">!                    ZEXP,ZLOG,ZMLT,ZSQRT</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">!***END PROLOGUE  ZBKNU</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, ak, alim, ascle, a1, a2, bb, bk, bry, caz, &amp;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      cbi, cbr, cc, cchi, cchr, cki, ckr, coefi, coefr, conei, coner, &amp;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      crscr, csclr, cshi, cshr, csi, csr, csrr, cssr, ctwoi, ctwor,   &amp;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      czeroi, czeror, czi, czr, dnu, dnu2, dpi, elim, etest, fc, fhs, &amp;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      fi, fk, fks, fmui, fmur, fnu, fpi, fr, g1, g2, hpi, pi, pr, pti,&amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      ptr, p1i, p1r, p2i, p2m, p2r, qi, qr, rak, rcaz, rthpi, rzi,    &amp;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      rzr, r1, s, smui, smur, spi, sti, str, s1i, s1r, s2i, s2r, tm,  &amp;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      tol, tth, t1, t2, yi, yr, zi, zr, elm, celmr, zdr, zdi, &amp;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      as, alas, helim, cyr, cyi<span class="comment">!, DGAMLN</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordtype">INTEGER</span> i, iflag, inu, k, kflag, kk, kmax, kode, koded, n, nz,  &amp;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      idum, j, ic, inub, nw</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      dimension yr(n), yi(n), cc(8), cssr(3), csrr(3), bry(3), cyr(2),&amp;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      cyi(2)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">!     COMPLEX Z,Y,A,B,RZ,SMU,FU,FMU,F,FLRZ,CZ,S1,S2,CSH,CCH</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">!     COMPLEX CK,P,Q,COEF,P1,P2,CBK,PT,CZERO,CONE,CTWO,ST,EZ,CS,DK</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keyword">DATA</span> kmax / 30 /</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keyword">DATA</span> czeror,czeroi,coner,conei,ctwor,ctwoi,r1/ &amp;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        0.0d0 , 0.0d0 , 1.0d0 , 0.0d0 , 2.0d0 , 0.0d0 , 2.0d0 /</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keyword">DATA</span> dpi, rthpi, spi ,hpi, fpi, tth /  &amp;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;           3.14159265358979324d0,       1.25331413731550025d0, &amp;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;           1.90985931710274403d0,       1.57079632679489662d0, &amp;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;           1.89769999331517738d0,       6.66666666666666666d-01/</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keyword">DATA</span> cc(1), cc(2), cc(3), cc(4), cc(5), cc(6), cc(7), cc(8)/ &amp;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;           5.77215664901532861d-01,    -4.20026350340952355d-02,   &amp;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          -4.21977345555443367d-02,     7.21894324666309954d-03,   &amp;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          -2.15241674114950973d-04,    -2.01348547807882387d-05,   &amp;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;           1.13302723198169588d-06,     6.11609510448141582d-09/</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      caz = zabs(zr,zi)</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      csclr = 1.0d0/tol</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      crscr = tol</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      cssr(1) = csclr</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      cssr(2) = 1.0d0</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      cssr(3) = crscr</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      csrr(1) = crscr</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      csrr(2) = 1.0d0</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      csrr(3) = csclr</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      bry(1) = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      bry(2) = 1.0d0/bry(1)</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      bry(3) = d1mach(2)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      nz = 0</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      iflag = 0</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      koded = kode</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      rcaz = 1.0d0/caz</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      str = zr*rcaz</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      sti = -zi*rcaz</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      rzr = (str+str)*rcaz</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      rzi = (sti+sti)*rcaz</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      inu = int(sngl(fnu+0.5d0))</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      dnu = fnu - dble(float(inu))</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">IF</span> (dabs(dnu).EQ.0.5d0) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      dnu2 = 0.0d0</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">IF</span> (dabs(dnu).GT.tol) dnu2 = dnu*dnu</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">IF</span> (caz.GT.r1) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">!     SERIES FOR CABS(Z).LE.R1</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      fc = 1.0d0</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keyword">CALL </span>zlog(rzr, rzi, smur, smui, idum)</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      fmur = smur*dnu</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      fmui = smui*dnu</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="keyword">CALL </span>zshch(fmur, fmui, cshr, cshi, cchr, cchi)</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">IF</span> (dnu.EQ.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      fc = dnu*dpi</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      fc = fc/dsin(fc)</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      smur = cshr/dnu</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      smui = cshi/dnu</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      a2 = 1.0d0 + dnu</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">!     GAM(1-Z)*GAM(1+Z)=PI*Z/SIN(PI*Z), T1=1/GAM(1-DNU), T2=1/GAM(1+DNU)</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      t2 = dexp(-dgamln(a2,idum))</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      t1 = 1.0d0/(t2*fc)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">IF</span> (dabs(dnu).GT.0.1d0) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">!     SERIES FOR F0 TO RESOLVE INDETERMINACY FOR SMALL ABS(DNU)</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      ak = 1.0d0</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      s = cc(1)</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keywordflow">DO</span> 20 k=2,8</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        ak = ak*dnu2</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        tm = cc(k)*ak</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        s = s + tm</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordflow">IF</span> (dabs(tm).LT.tol) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   30 g1 = -s</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      g1 = (t1-t2)/(dnu+dnu)</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      g2 = (t1+t2)*0.5d0</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      fr = fc*(cchr*g1+smur*g2)</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      fi = fc*(cchi*g1+smui*g2)</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keyword">CALL </span>zexp(fmur, fmui, str, sti)</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      pr = 0.5d0*str/t2</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      pi = 0.5d0*sti/t2</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="keyword">CALL </span>zdiv(0.5d0, 0.0d0, str, sti, ptr, pti)</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      qr = ptr/t1</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      qi = pti/t1</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      s1r = fr</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      s1i = fi</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      s2r = pr</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      s2i = pi</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      ak = 1.0d0</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      a1 = 1.0d0</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      ckr = coner</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      cki = conei</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      bk = 1.0d0 - dnu2</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="keywordflow">IF</span> (inu.GT.0 .OR. n.GT.1) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">!     GENERATE K(FNU,Z), 0.0D0 .LE. FNU .LT. 0.5D0 AND N=1</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keywordflow">IF</span> (caz.LT.tol) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keyword">CALL </span>zmlt(zr, zi, zr, zi, czr, czi)</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      czr = 0.25d0*czr</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      czi = 0.25d0*czi</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      t1 = 0.25d0*caz*caz</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      fr = (fr*ak+pr+qr)/bk</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      fi = (fi*ak+pi+qi)/bk</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      str = 1.0d0/(ak-dnu)</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      pr = pr*str</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      pi = pi*str</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      str = 1.0d0/(ak+dnu)</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      qr = qr*str</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      qi = qi*str</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      str = ckr*czr - cki*czi</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      rak = 1.0d0/ak</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      cki = (ckr*czi+cki*czr)*rak</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      ckr = str*rak</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      s1r = ckr*fr - cki*fi + s1r</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      s1i = ckr*fi + cki*fr + s1i</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      a1 = a1*t1*rak</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      bk = bk + ak + ak + 1.0d0</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      ak = ak + 1.0d0</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">IF</span> (a1.GT.tol) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      yr(1) = s1r</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      yi(1) = s1i</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keywordflow">IF</span> (koded.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keyword">CALL </span>zexp(zr, zi, str, sti)</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="keyword">CALL </span>zmlt(s1r, s1i, str, sti, yr(1), yi(1))</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">!     GENERATE K(DNU,Z) AND K(DNU+1,Z) FOR FORWARD RECURRENCE</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">IF</span> (caz.LT.tol) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keyword">CALL </span>zmlt(zr, zi, zr, zi, czr, czi)</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      czr = 0.25d0*czr</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      czi = 0.25d0*czi</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      t1 = 0.25d0*caz*caz</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      fr = (fr*ak+pr+qr)/bk</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      fi = (fi*ak+pi+qi)/bk</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      str = 1.0d0/(ak-dnu)</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      pr = pr*str</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      pi = pi*str</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      str = 1.0d0/(ak+dnu)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      qr = qr*str</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      qi = qi*str</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      str = ckr*czr - cki*czi</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      rak = 1.0d0/ak</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      cki = (ckr*czi+cki*czr)*rak</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      ckr = str*rak</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      s1r = ckr*fr - cki*fi + s1r</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      s1i = ckr*fi + cki*fr + s1i</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      str = pr - fr*ak</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      sti = pi - fi*ak</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      s2r = ckr*str - cki*sti + s2r</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      s2i = ckr*sti + cki*str + s2i</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      a1 = a1*t1*rak</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      bk = bk + ak + ak + 1.0d0</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      ak = ak + 1.0d0</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">IF</span> (a1.GT.tol) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      kflag = 2</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      a1 = fnu + 1.0d0</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      ak = a1*dabs(smur)</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keywordflow">IF</span> (ak.GT.alim) kflag = 3</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      str = cssr(kflag)</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      p2r = s2r*str</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      p2i = s2i*str</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keyword">CALL </span>zmlt(p2r, p2i, rzr, rzi, s2r, s2i)</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      s1r = s1r*str</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      s1i = s1i*str</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keywordflow">IF</span> (koded.EQ.1) <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keyword">CALL </span>zexp(zr, zi, fr, fi)</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keyword">CALL </span>zmlt(s1r, s1i, fr, fi, s1r, s1i)</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keyword">CALL </span>zmlt(s2r, s2i, fr, fi, s2r, s2i)</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">!     IFLAG=0 MEANS NO UNDERFLOW OCCURRED</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">!     IFLAG=1 MEANS AN UNDERFLOW OCCURRED- COMPUTATION PROCEEDS WITH</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">!     KODED=2 AND A TEST FOR ON SCALE VALUES IS MADE DURING FORWARD</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">!     RECURSION</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keyword">CALL </span>zsqrt(zr, zi, str, sti)</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keyword">CALL </span>zdiv(rthpi, czeroi, str, sti, coefr, coefi)</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      kflag = 2</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keywordflow">IF</span> (koded.EQ.2) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordflow">IF</span> (zr.GT.alim) <span class="keywordflow">GO TO</span> 290</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">!     BLANK LINE</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      str = dexp(-zr)*cssr(kflag)</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      sti = -str*dsin(zi)</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      str = str*dcos(zi)</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keyword">CALL </span>zmlt(coefr, coefi, str, sti, coefr, coefi)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">IF</span> (dabs(dnu).EQ.0.5d0) <span class="keywordflow">GO TO</span> 300</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">!     MILLER ALGORITHM FOR CABS(Z).GT.R1</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      ak = dcos(dpi*dnu)</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      ak = dabs(ak)</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <span class="keywordflow">IF</span> (ak.EQ.czeror) <span class="keywordflow">GO TO</span> 300</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      fhs = dabs(0.25d0-dnu2)</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="keywordflow">IF</span> (fhs.EQ.czeror) <span class="keywordflow">GO TO</span> 300</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">!     COMPUTE R2=F(E). IF CABS(Z).GE.R2, USE FORWARD RECURRENCE TO</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">!     DETERMINE THE BACKWARD INDEX K. R2=F(E) IS A STRAIGHT LINE ON</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">!     12.LE.E.LE.60. E IS COMPUTED FROM 2**(-E)=B**(1-I1MACH(14))=</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">!     TOL WHERE B IS THE BASE OF THE ARITHMETIC.</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      t1 = dble(float(i1mach(14)-1))</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      t1 = t1*d1mach(5)*3.321928094d0</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      t1 = dmax1(t1,12.0d0)</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      t1 = dmin1(t1,60.0d0)</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      t2 = tth*t1 - 6.0d0</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <span class="keywordflow">IF</span> (zr.NE.0.0d0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      t1 = hpi</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      t1 = datan(zi/zr)</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      t1 = dabs(t1)</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="keywordflow">IF</span> (t2.GT.caz) <span class="keywordflow">GO TO</span> 170</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">!     FORWARD RECURRENCE LOOP WHEN CABS(Z).GE.R2</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      etest = ak/(dpi*caz*tol)</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      fk = coner</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keywordflow">IF</span> (etest.LT.coner) <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      fks = ctwor</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      ckr = caz + caz + ctwor</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      p1r = czeror</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      p2r = coner</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">DO</span> 150 i=1,kmax</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        ak = fhs/fks</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        cbr = ckr/(fk+coner)</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        ptr = p2r</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        p2r = cbr*p2r - p1r*ak</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        p1r = ptr</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        ckr = ckr + ctwor</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        fks = fks + fk + fk + ctwor</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        fhs = fhs + fk + fk</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        fk = fk + coner</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        str = dabs(p2r)*fk</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="keywordflow">IF</span> (etest.LT.str) <span class="keywordflow">GO TO</span> 160</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  150 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">GO TO</span> 310</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  160 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      fk = fk + spi*t1*dsqrt(t2/caz)</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      fhs = dabs(0.25d0-dnu2)</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  170 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">!     COMPUTE BACKWARD INDEX K FOR CABS(Z).LT.R2</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      a2 = dsqrt(caz)</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      ak = fpi*ak/(tol*dsqrt(a2))</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      aa = 3.0d0*t1/(1.0d0+caz)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      bb = 14.7d0*t1/(28.0d0+caz)</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      ak = (dlog(ak)+caz*dcos(aa)/(1.0d0+0.008d0*caz))/dcos(bb)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      fk = 0.12125d0*ak*ak/caz + 1.5d0</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  180 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">!     BACKWARD RECURRENCE LOOP FOR MILLER ALGORITHM</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      k = int(sngl(fk))</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      fk = dble(float(k))</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      fks = fk*fk</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      p1r = czeror</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      p1i = czeroi</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      p2r = tol</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      p2i = czeroi</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      csr = p2r</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      csi = p2i</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">DO</span> 190 i=1,k</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        a1 = fks - fk</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        ak = (fks+fk)/(a1+fhs)</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        rak = 2.0d0/(fk+coner)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        cbr = (fk+zr)*rak</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        cbi = zi*rak</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        ptr = p2r</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        pti = p2i</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        p2r = (ptr*cbr-pti*cbi-p1r)*ak</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        p2i = (pti*cbr+ptr*cbi-p1i)*ak</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        p1r = ptr</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        p1i = pti</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        csr = csr + p2r</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        csi = csi + p2i</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        fks = a1 - fk + coner</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        fk = fk - coner</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  190 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">!     COMPUTE (P2/CS)=(P2/CABS(CS))*(CONJG(CS)/CABS(CS)) FOR BETTER</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">!     SCALING</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      tm = zabs(csr,csi)</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      ptr = 1.0d0/tm</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      s1r = p2r*ptr</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      s1i = p2i*ptr</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      csr = csr*ptr</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      csi = -csi*ptr</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keyword">CALL </span>zmlt(coefr, coefi, s1r, s1i, str, sti)</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keyword">CALL </span>zmlt(str, sti, csr, csi, s1r, s1i)</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordflow">IF</span> (inu.GT.0 .OR. n.GT.1) <span class="keywordflow">GO TO</span> 200</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      zdr = zr</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      zdi = zi</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keywordflow">IF</span>(iflag.EQ.1) <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordflow">GO TO</span> 240</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">!     COMPUTE P1/P2=(P1/CABS(P2)*CONJG(P2)/CABS(P2) FOR SCALING</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      tm = zabs(p2r,p2i)</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      ptr = 1.0d0/tm</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      p1r = p1r*ptr</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      p1i = p1i*ptr</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      p2r = p2r*ptr</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      p2i = -p2i*ptr</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="keyword">CALL </span>zmlt(p1r, p1i, p2r, p2i, ptr, pti)</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      str = dnu + 0.5d0 - ptr</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      sti = -pti</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keyword">CALL </span>zdiv(str, sti, zr, zi, str, sti)</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      str = str + 1.0d0</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      <span class="keyword">CALL </span>zmlt(str, sti, s1r, s1i, s2r, s2i)</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">!     FORWARD RECURSION ON THE THREE TERM RECURSION WITH RELATION WITH</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">!     SCALING NEAR EXPONENT EXTREMES ON KFLAG=1 OR KFLAG=3</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  210 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      str = dnu + 1.0d0</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      ckr = str*rzr</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      cki = str*rzi</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) inu = inu - 1</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordflow">IF</span> (inu.GT.0) <span class="keywordflow">GO TO</span> 220</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="keywordflow">IF</span> (n.GT.1) <span class="keywordflow">GO TO</span> 215</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      s1r = s2r</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      s1i = s2i</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  215 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      zdr = zr</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;      zdi = zi</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      <span class="keywordflow">IF</span>(iflag.EQ.1) <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordflow">GO TO</span> 240</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  220 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      inub = 1</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="keywordflow">IF</span>(iflag.EQ.1) <span class="keywordflow">GO TO</span> 261</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  225 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      p1r = csrr(kflag)</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      ascle = bry(kflag)</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <span class="keywordflow">DO</span> 230 i=inub,inu</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        str = s2r</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        sti = s2i</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        s2r = ckr*str - cki*sti + s1r</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        s2i = ckr*sti + cki*str + s1i</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        s1r = str</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        s1i = sti</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        ckr = ckr + rzr</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        cki = cki + rzi</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">IF</span> (kflag.GE.3) <span class="keywordflow">GO TO</span> 230</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        p2r = s2r*p1r</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        p2i = s2i*p1r</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        str = dabs(p2r)</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        sti = dabs(p2i)</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        p2m = dmax1(str,sti)</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="keywordflow">IF</span> (p2m.LE.ascle) <span class="keywordflow">GO TO</span> 230</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        kflag = kflag + 1</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        ascle = bry(kflag)</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        s1r = s1r*p1r</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        s1i = s1i*p1r</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        s2r = p2r</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        s2i = p2i</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        str = cssr(kflag)</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        s1r = s1r*str</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        s1i = s1i*str</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        s2r = s2r*str</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        s2i = s2i*str</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        p1r = csrr(kflag)</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  230 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      <span class="keywordflow">IF</span> (n.NE.1) <span class="keywordflow">GO TO</span> 240</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      s1r = s2r</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      s1i = s2i</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  240 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      str = csrr(kflag)</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      yr(1) = s1r*str</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      yi(1) = s1i*str</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      yr(2) = s2r*str</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      yi(2) = s2i*str</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      kk = 2</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  250 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      kk = kk + 1</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <span class="keywordflow">IF</span> (kk.GT.n) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      p1r = csrr(kflag)</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      ascle = bry(kflag)</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keywordflow">DO</span> 260 i=kk,n</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        p2r = s2r</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        p2i = s2i</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        s2r = ckr*p2r - cki*p2i + s1r</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        s2i = cki*p2r + ckr*p2i + s1i</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        s1r = p2r</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        s1i = p2i</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        ckr = ckr + rzr</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        cki = cki + rzi</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        p2r = s2r*p1r</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        p2i = s2i*p1r</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        yr(i) = p2r</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        yi(i) = p2i</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">IF</span> (kflag.GE.3) <span class="keywordflow">GO TO</span> 260</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        str = dabs(p2r)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        sti = dabs(p2i)</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        p2m = dmax1(str,sti)</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        <span class="keywordflow">IF</span> (p2m.LE.ascle) <span class="keywordflow">GO TO</span> 260</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        kflag = kflag + 1</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        ascle = bry(kflag)</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        s1r = s1r*p1r</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        s1i = s1i*p1r</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        s2r = p2r</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        s2i = p2i</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        str = cssr(kflag)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        s1r = s1r*str</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        s1i = s1i*str</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        s2r = s2r*str</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        s2i = s2i*str</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        p1r = csrr(kflag)</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  260 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">!     IFLAG=1 CASES, FORWARD RECURRENCE ON SCALED VALUES ON UNDERFLOW</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  261 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      helim = 0.5d0*elim</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      elm = dexp(-elim)</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      celmr = elm</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      ascle = bry(1)</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      zdr = zr</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      zdi = zi</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      ic = -1</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      j = 2</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keywordflow">DO</span> 262 i=1,inu</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        str = s2r</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        sti = s2i</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        s2r = str*ckr-sti*cki+s1r</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        s2i = sti*ckr+str*cki+s1i</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        s1r = str</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        s1i = sti</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        ckr = ckr+rzr</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        cki = cki+rzi</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        as = zabs(s2r,s2i)</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        alas = dlog(as)</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        p2r = -zdr+alas</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">IF</span>(p2r.LT.(-elim)) <span class="keywordflow">GO TO</span> 263</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keyword">CALL </span>zlog(s2r,s2i,str,sti,idum)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        p2r = -zdr+str</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        p2i = -zdi+sti</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        p2m = dexp(p2r)/tol</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        p1r = p2m*dcos(p2i)</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        p1i = p2m*dsin(p2i)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        <span class="keyword">CALL </span>zuchk(p1r,p1i,nw,ascle,tol)</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keywordflow">IF</span>(nw.NE.0) <span class="keywordflow">GO TO</span> 263</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        j = 3 - j</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        cyr(j) = p1r</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        cyi(j) = p1i</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">IF</span>(ic.EQ.(i-1)) <span class="keywordflow">GO TO</span> 264</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        ic = i</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">GO TO</span> 262</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  263   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">IF</span>(alas.LT.helim) <span class="keywordflow">GO TO</span> 262</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        zdr = zdr-elim</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        s1r = s1r*celmr</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        s1i = s1i*celmr</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        s2r = s2r*celmr</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        s2i = s2i*celmr</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  262 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keywordflow">IF</span>(n.NE.1) <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      s1r = s2r</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      s1i = s2i</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  264 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      kflag = 1</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      inub = i+1</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      s2r = cyr(j)</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      s2i = cyi(j)</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      j = 3 - j</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      s1r = cyr(j)</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      s1i = cyi(j)</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="keywordflow">IF</span>(inub.LE.inu) <span class="keywordflow">GO TO</span> 225</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="keywordflow">IF</span>(n.NE.1) <span class="keywordflow">GO TO</span> 240</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      s1r = s2r</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      s1i = s2i</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="keywordflow">GO TO</span> 240</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  270 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      yr(1) = s1r</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      yi(1) = s1i</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="keywordflow">IF</span>(n.EQ.1) <span class="keywordflow">GO TO</span> 280</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      yr(2) = s2r</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      yi(2) = s2i</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  280 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      ascle = bry(1)</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keyword">CALL </span>zkscl(zdr,zdi,fnu,n,yr,yi,nz,rzr,rzi,ascle,tol,elim)</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      inu = n - nz</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="keywordflow">IF</span> (inu.LE.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      kk = nz + 1</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      s1r = yr(kk)</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      s1i = yi(kk)</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      yr(kk) = s1r*csrr(1)</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      yi(kk) = s1i*csrr(1)</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="keywordflow">IF</span> (inu.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      kk = nz + 2</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      s2r = yr(kk)</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      s2i = yi(kk)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      yr(kk) = s2r*csrr(1)</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      yi(kk) = s2i*csrr(1)</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keywordflow">IF</span> (inu.EQ.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      t2 = fnu + dble(float(kk-1))</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      ckr = t2*rzr</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      cki = t2*rzi</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      kflag = 1</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">GO TO</span> 250</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  290 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">!     SCALE BY DEXP(Z), IFLAG = 1 CASES</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      koded = 2</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      iflag = 1</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      kflag = 2</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment">!     FNU=HALF ODD INTEGER CASE, DNU=-0.5</span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  300 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      s1r = coefr</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      s1i = coefi</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      s2r = coefr</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      s2i = coefi</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  310 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      nz=-2</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="keyword">SUBROUTINE </span>zkscl(ZRR,ZRI,FNU,N,YR,YI,NZ,RZR,RZI,ASCLE,TOL,ELIM)</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZKSCL</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">!***REFER TO  ZBESK</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">!     SET K FUNCTIONS TO ZERO ON UNDERFLOW, CONTINUE RECURRENCE</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">!     ON SCALED FUNCTIONS UNTIL TWO MEMBERS COME ON SCALE, THEN</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">!     RETURN WITH MIN(NZ+2,N) VALUES SCALED BY 1/TOL.</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">!***ROUTINES CALLED  ZUCHK,ZABS,ZLOG</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">!***END PROLOGUE  ZKSCL</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">!     COMPLEX CK,CS,CY,CZERO,RZ,S1,S2,Y,ZR,ZD,CELM</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> acs, as, ascle, cki, ckr, csi, csr, cyi, &amp;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      cyr, elim, fn, fnu, rzi, rzr, str, s1i, s1r, s2i, s2r,    &amp;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      tol, yi, yr, zeroi, zeror, zri, zrr, zdr, zdi, celmr,     &amp;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      elm, helim, alas</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="keywordtype">INTEGER</span> i, ic, idum, kk, n, nn, nw, nz</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      dimension yr(1), yi(1), cyr(2), cyi(2)</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi / 0.0d0 , 0.0d0 /</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      nz = 0</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      ic = 0</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      nn = min0(2,n)</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="keywordflow">DO</span> 10 i=1,nn</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        s1r = yr(i)</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        s1i = yi(i)</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        cyr(i) = s1r</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        cyi(i) = s1i</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        as = zabs(s1r,s1i)</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        acs = -zrr + dlog(as)</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        nz = nz + 1</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="keywordflow">IF</span> (acs.LT.(-elim)) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <span class="keyword">CALL </span>zlog(s1r, s1i, csr, csi, idum)</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        csr = csr - zrr</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        csi = csi - zri</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        str = dexp(csr)/tol</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        csr = str*dcos(csi)</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        csi = str*dsin(csi)</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keyword">CALL </span>zuchk(csr, csi, nw, ascle, tol)</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        yr(i) = csr</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        yi(i) = csi</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        ic = i</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        nz = nz - 1</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">IF</span> (ic.GT.1) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      yr(1) = zeror</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      yi(1) = zeroi</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      nz = 2</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.2) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="keywordflow">IF</span> (nz.EQ.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      fn = fnu + 1.0d0</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      ckr = fn*rzr</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      cki = fn*rzi</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      s1r = cyr(1)</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      s1i = cyi(1)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      s2r = cyr(2)</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      s2i = cyi(2)</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      helim = 0.5d0*elim</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      elm = dexp(-elim)</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      celmr = elm</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      zdr = zrr</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      zdi = zri</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">!     FIND TWO CONSECUTIVE Y VALUES ON SCALE. SCALE RECURRENCE IF</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">!     S2 GETS LARGER THAN EXP(ELIM/2)</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="keywordflow">DO</span> 30 i=3,n</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        kk = i</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        csr = s2r</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        csi = s2i</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        s2r = ckr*csr - cki*csi + s1r</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        s2i = cki*csr + ckr*csi + s1i</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        s1r = csr</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        s1i = csi</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        ckr = ckr + rzr</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        cki = cki + rzi</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        as = zabs(s2r,s2i)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        alas = dlog(as)</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        acs = -zdr + alas</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        nz = nz + 1</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        <span class="keywordflow">IF</span> (acs.LT.(-elim)) <span class="keywordflow">GO TO</span> 25</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keyword">CALL </span>zlog(s2r, s2i, csr, csi, idum)</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        csr = csr - zdr</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        csi = csi - zdi</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        str = dexp(csr)/tol</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        csr = str*dcos(csi)</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        csi = str*dsin(csi)</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keyword">CALL </span>zuchk(csr, csi, nw, ascle, tol)</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 25</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        yr(i) = csr</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        yi(i) = csi</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        nz = nz - 1</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="keywordflow">IF</span> (ic.EQ.kk-1) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        ic = kk</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   25   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        <span class="keywordflow">IF</span>(alas.LT.helim) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        zdr = zdr - elim</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        s1r = s1r*celmr</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        s1i = s1i*celmr</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        s2r = s2r*celmr</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;        s2i = s2i*celmr</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      nz = n</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <span class="keywordflow">IF</span>(ic.EQ.n) nz=n-1</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keywordflow">GO TO</span> 45</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      nz = kk - 2</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;   45 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      <span class="keywordflow">DO</span> 50 i=1,nz</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        yr(i) = zeror</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        yi(i) = zeroi</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="keyword">SUBROUTINE </span>zshch(ZR, ZI, CSHR, CSHI, CCHR, CCHI)</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZSHCH</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">!***REFER TO  ZBESK,ZBESH</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">!     ZSHCH COMPUTES THE COMPLEX HYPERBOLI! FUNCTIONS CSH=SINH(X+I*Y)</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">!     AND CCH=COSH(X+I*Y), WHERE I**2=-1.</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">!***ROUTINES CALLED  (NONE)</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">!***END PROLOGUE  ZSHCH</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span> cchi, cchr, ch, cn, cshi, cshr, sh, sn, zi, zr, dcosh, dsinh</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      sh = dsinh(zr)</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      ch = dcosh(zr)</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      sn = dsin(zi)</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      cn = dcos(zi)</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      cshr = sh*cn</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      cshi = ch*sn</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      cchr = ch*cn</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      cchi = sh*sn</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="keyword">SUBROUTINE </span>zmlri(ZR, ZI, FNU, KODE, N, YR, YI, NZ, TOL)</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZMLRI</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">!     ZMLRI COMPUTES THE I BESSEL FUNCTION FOR RE(Z).GE.0.0 BY THE</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">!     MILLER ALGORITHM NORMALIZED BY A NEUMANN SERIES.</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">!***ROUTINES CALLED  DGAMLN,D1MACH,ZABS,ZEXP,ZLOG,ZMLT</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">!***END PROLOGUE  ZMLRI</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">!     COMPLEX CK,CNORM,CONE,CTWO,CZERO,PT,P1,P2,RZ,SUM,Y,Z</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> ack, ak, ap, at, az, bk, cki, ckr, cnormi,     &amp;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      cnormr, conei, coner, fkap, fkk, flam, fnf, fnu, pti, ptr, p1i, &amp;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      p1r, p2i, p2r, raz, rho, rho2, rzi, rzr, scle, sti, str, sumi,  &amp;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      sumr, tfnf, tol, tst, yi, yr, zeroi, zeror, zi, zr<span class="comment">!, DGAMLN</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keywordtype">INTEGER</span> i, iaz, idum, ifnu, inu, itime, k, kk, km, kode, m, n, nz</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      dimension yr(1), yi(1)</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      scle = d1mach(1)/tol</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      nz=0</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      iaz = int(sngl(az))</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      ifnu = int(sngl(fnu))</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      inu = ifnu + n - 1</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      at = dble(float(iaz)) + 1.0d0</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      raz = 1.0d0/az</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      str = zr*raz</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      ckr = str*at*raz</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      cki = sti*at*raz</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      rzr = (str+str)*raz</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      rzi = (sti+sti)*raz</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      p1r = zeror</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      p1i = zeroi</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      p2r = coner</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      p2i = conei</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      ack = (at+1.0d0)*raz</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      rho = ack + dsqrt(ack*ack-1.0d0)</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      rho2 = rho*rho</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      tst = (rho2+rho2)/((rho2-1.0d0)*(rho-1.0d0))</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      tst = tst/tol</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">!     COMPUTE RELATIVE TRUNCATION ERROR INDEX FOR SERIES</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      ak = at</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <span class="keywordflow">DO</span> 10 i=1,80</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        ptr = p2r</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        pti = p2i</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        p2r = p1r - (ckr*ptr-cki*pti)</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        p2i = p1i - (cki*ptr+ckr*pti)</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        p1r = ptr</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        p1i = pti</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        ckr = ckr + rzr</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        cki = cki + rzi</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        ap = zabs(p2r,p2i)</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        <span class="keywordflow">IF</span> (ap.GT.tst*ak*ak) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        ak = ak + 1.0d0</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      i = i + 1</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      k = 0</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keywordflow">IF</span> (inu.LT.iaz) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">!     COMPUTE RELATIVE TRUNCATION ERROR FOR RATIOS</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      p1r = zeror</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      p1i = zeroi</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      p2r = coner</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      p2i = conei</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      at = dble(float(inu)) + 1.0d0</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      str = zr*raz</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      sti = -zi*raz</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      ckr = str*at*raz</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      cki = sti*at*raz</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      ack = at*raz</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      tst = dsqrt(ack/tol)</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      itime = 1</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      <span class="keywordflow">DO</span> 30 k=1,80</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        ptr = p2r</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        pti = p2i</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        p2r = p1r - (ckr*ptr-cki*pti)</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        p2i = p1i - (ckr*pti+cki*ptr)</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        p1r = ptr</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        p1i = pti</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        ckr = ckr + rzr</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        cki = cki + rzi</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        ap = zabs(p2r,p2i)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="keywordflow">IF</span> (ap.LT.tst) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">IF</span> (itime.EQ.2) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        ack = zabs(ckr,cki)</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        flam = ack + dsqrt(ack*ack-1.0d0)</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        fkap = ap/zabs(p1r,p1i)</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        rho = dmin1(flam,fkap)</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        tst = tst*dsqrt(rho/(rho*rho-1.0d0))</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        itime = 2</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">!     BACKWARD RECURRENCE AND SUM NORMALIZING RELATION</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      k = k + 1</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      kk = max0(i+iaz,k+inu)</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      fkk = dble(float(kk))</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      p1r = zeror</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      p1i = zeroi</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">!     SCALE P2 AND SUM BY SCLE</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      p2r = scle</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      p2i = zeroi</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      fnf = fnu - dble(float(ifnu))</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      tfnf = fnf + fnf</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      bk = dgamln(fkk+tfnf+1.0d0,idum) - dgamln(fkk+1.0d0,idum) - &amp;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      dgamln(tfnf+1.0d0,idum)</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      bk = dexp(bk)</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      sumr = zeror</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      sumi = zeroi</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      km = kk - inu</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <span class="keywordflow">DO</span> 50 i=1,km</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        ptr = p2r</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        pti = p2i</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        p2r = p1r + (fkk+fnf)*(rzr*ptr-rzi*pti)</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        p2i = p1i + (fkk+fnf)*(rzi*ptr+rzr*pti)</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        p1r = ptr</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        p1i = pti</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        ak = 1.0d0 - tfnf/(fkk+tfnf)</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        ack = bk*ak</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        sumr = sumr + (ack+bk)*p1r</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        sumi = sumi + (ack+bk)*p1i</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        bk = ack</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        fkk = fkk - 1.0d0</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      yr(n) = p2r</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      yi(n) = p2i</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keywordflow">DO</span> 60 i=2,n</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        ptr = p2r</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        pti = p2i</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        p2r = p1r + (fkk+fnf)*(rzr*ptr-rzi*pti)</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        p2i = p1i + (fkk+fnf)*(rzi*ptr+rzr*pti)</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        p1r = ptr</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        p1i = pti</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        ak = 1.0d0 - tfnf/(fkk+tfnf)</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        ack = bk*ak</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        sumr = sumr + (ack+bk)*p1r</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        sumi = sumi + (ack+bk)*p1i</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        bk = ack</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        fkk = fkk - 1.0d0</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        m = n - i + 1</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        yr(m) = p2r</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        yi(m) = p2i</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="keywordflow">IF</span> (ifnu.LE.0) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordflow">DO</span> 80 i=1,ifnu</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        ptr = p2r</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        pti = p2i</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        p2r = p1r + (fkk+fnf)*(rzr*ptr-rzi*pti)</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        p2i = p1i + (fkk+fnf)*(rzr*pti+rzi*ptr)</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        p1r = ptr</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        p1i = pti</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        ak = 1.0d0 - tfnf/(fkk+tfnf)</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        ack = bk*ak</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        sumr = sumr + (ack+bk)*p1r</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        sumi = sumi + (ack+bk)*p1i</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        bk = ack</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        fkk = fkk - 1.0d0</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      ptr = zr</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      pti = zi</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.2) ptr = zeror</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="keyword">CALL </span>zlog(rzr, rzi, str, sti, idum)</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      p1r = -fnf*str + ptr</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      p1i = -fnf*sti + pti</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      ap = dgamln(1.0d0+fnf,idum)</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      ptr = p1r - ap</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      pti = p1i</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">!     THE DIVISION CEXP(PT)/(SUM+P2) IS ALTERED TO AVOID OVERFLOW</span></div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">!     IN THE DENOMINATOR BY SQUARING LARGE QUANTITIES</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      p2r = p2r + sumr</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      p2i = p2i + sumi</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      ap = zabs(p2r,p2i)</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      p1r = 1.0d0/ap</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <span class="keyword">CALL </span>zexp(ptr, pti, str, sti)</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;      ckr = str*p1r</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      cki = sti*p1r</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      ptr = p2r*p1r</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      pti = -p2i*p1r</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="keyword">CALL </span>zmlt(ckr, cki, ptr, pti, cnormr, cnormi)</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="keywordflow">DO</span> 100 i=1,n</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        str = yr(i)*cnormr - yi(i)*cnormi</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        yi(i) = yr(i)*cnormi + yi(i)*cnormr</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        yr(i) = str</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      nz=-2</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="keyword">DOUBLE PRECISION </span><span class="keyword">FUNCTION </span>dgamln(Z,IERR)</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">!***BEGIN PROLOGUE  DGAMLN</span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment">!***DATE WRITTEN   830501   (YYMMDD)</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">!***REVISION DATE  830501   (YYMMDD)</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">!***CATEGORY NO.  B5F</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">!***KEYWORDS  GAMMA FUNCTION,LOGARITHM OF GAMMA FUNCTION</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">!***AUTHOR  AMOS, DONALD E., SANDIA NATIONAL LABORATORIES</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">!***PURPOSE  TO COMPUTE THE LOGARITHM OF THE GAMMA FUNCTION</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">!***DESCRIPTION</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">!               **** A DOUBLE PRECISION ROUTINE ****</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">!         DGAMLN COMPUTES THE NATURAL LOG OF THE GAMMA FUNCTION FOR</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">!         Z.GT.0.  THE ASYMPTOTIC EXPANSION IS USED TO GENERATE VALUES</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">!         GREATER THAN ZMIN WHICH ARE ADJUSTED BY THE RECURSION</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">!         G(Z+1)=Z*G(Z) FOR Z.LE.ZMIN.  THE FUNCTION WAS MADE AS</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">!         PORTABLE AS POSSIBLE BY COMPUTIMG ZMIN FROM THE NUMBER OF BASE</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">!         10 DIGITS IN A WORD, RLN=AMAX1(-ALOG10(R1MACH(4)),0.5E-18)</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">!         LIMITED TO 18 DIGITS OF (RELATIVE) ACCURACY.</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="comment">!         SINCE INTEGER ARGUMENTS ARE COMMON, A TABLE LOOK UP ON 100</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="comment">!         VALUES IS USED FOR SPEED OF EXECUTION.</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="comment">!     DESCRIPTION OF ARGUMENTS</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;<span class="comment">!         INPUT      Z IS D0UBLE PRECISION</span></div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="comment">!           Z      - ARGUMENT, Z.GT.0.0D0</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment">!         OUTPUT      DGAMLN IS DOUBLE PRECISION</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">!           DGAMLN  - NATURAL LOG OF THE GAMMA FUNCTION AT Z.NE.0.0D0</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">!           IERR    - ERROR FLAG</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">!                     IERR=0, NORMAL RETURN, COMPUTATION COMPLETED</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">!                     IERR=1, Z.LE.0.0D0,    NO COMPUTATION</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment">!***REFERENCES  COMPUTATION OF BESSEL FUNCTIONS OF COMPLEX ARGUMENT</span></div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="comment">!                 BY D. E. AMOS, SAND83-0083, MAY, 1983.</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment">!***ROUTINES CALLED  I1MACH,D1MACH</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">!***END PROLOGUE  DGAMLN</span></div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> cf, con, fln, fz, gln, rln, s, tlg, trm, tst, &amp;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      t1, wdtol, z, zdmy, zinc, zm, zmin, zp, zsq</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="keywordtype">INTEGER</span> i, ierr, i1m, k, mz, nz</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      dimension cf(22), gln(100)</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">!       LNGAMMA(N), N=1,100</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      <span class="keyword">DATA</span> gln(1), gln(2), gln(3), gln(4), gln(5), gln(6), gln(7),       &amp;</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;           gln(8), gln(9), gln(10), gln(11), gln(12), gln(13), gln(14),  &amp;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;           gln(15), gln(16), gln(17), gln(18), gln(19), gln(20),         &amp;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;           gln(21), gln(22)/                                             &amp;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;           0.00000000000000000d+00,     0.00000000000000000d+00,         &amp;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;           6.93147180559945309d-01,     1.79175946922805500d+00,         &amp;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;           3.17805383034794562d+00,     4.78749174278204599d+00,         &amp;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;           6.57925121201010100d+00,     8.52516136106541430d+00,         &amp;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;           1.06046029027452502d+01,     1.28018274800814696d+01,         &amp;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;           1.51044125730755153d+01,     1.75023078458738858d+01,         &amp;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;           1.99872144956618861d+01,     2.25521638531234229d+01,         &amp;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;           2.51912211827386815d+01,     2.78992713838408916d+01,         &amp;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;           3.06718601060806728d+01,     3.35050734501368889d+01,         &amp;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;           3.63954452080330536d+01,     3.93398841871994940d+01,         &amp;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;           4.23356164607534850d+01,     4.53801388984769080d+01/</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <span class="keyword">DATA</span> gln(23), gln(24), gln(25), gln(26), gln(27), gln(28),         &amp;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;           gln(29), gln(30), gln(31), gln(32), gln(33), gln(34),         &amp;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;           gln(35), gln(36), gln(37), gln(38), gln(39), gln(40),         &amp;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;           gln(41), gln(42), gln(43), gln(44)/                           &amp;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;           4.84711813518352239d+01,     5.16066755677643736d+01,         &amp;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;           5.47847293981123192d+01,     5.80036052229805199d+01,         &amp;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;           6.12617017610020020d+01,     6.45575386270063311d+01,         &amp;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;           6.78897431371815350d+01,     7.12570389671680090d+01,         &amp;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;           7.46582363488301644d+01,     7.80922235533153106d+01,         &amp;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;           8.15579594561150372d+01,     8.50544670175815174d+01,         &amp;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;           8.85808275421976788d+01,     9.21361756036870925d+01,         &amp;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;           9.57196945421432025d+01,     9.93306124547874269d+01,         &amp;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;           1.02968198614513813d+02,     1.06631760260643459d+02,         &amp;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;           1.10320639714757395d+02,     1.14034211781461703d+02,         &amp;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;           1.17771881399745072d+02,     1.21533081515438634d+02/</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="keyword">DATA</span> gln(45), gln(46), gln(47), gln(48), gln(49), gln(50),         &amp;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;           gln(51), gln(52), gln(53), gln(54), gln(55), gln(56),         &amp;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;           gln(57), gln(58), gln(59), gln(60), gln(61), gln(62),         &amp;</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;           gln(63), gln(64), gln(65), gln(66)/                           &amp;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;           1.25317271149356895d+02,     1.29123933639127215d+02,         &amp;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;           1.32952575035616310d+02,     1.36802722637326368d+02,         &amp;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;           1.40673923648234259d+02,     1.44565743946344886d+02,         &amp;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;           1.48477766951773032d+02,     1.52409592584497358d+02,         &amp;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;           1.56360836303078785d+02,     1.60331128216630907d+02,         &amp;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;           1.64320112263195181d+02,     1.68327445448427652d+02,         &amp;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;           1.72352797139162802d+02,     1.76395848406997352d+02,         &amp;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;           1.80456291417543771d+02,     1.84533828861449491d+02,         &amp;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;           1.88628173423671591d+02,     1.92739047287844902d+02,         &amp;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;           1.96866181672889994d+02,     2.01009316399281527d+02,         &amp;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;           2.05168199482641199d+02,     2.09342586752536836d+02/</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="keyword">DATA</span> gln(67), gln(68), gln(69), gln(70), gln(71), gln(72),         &amp;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;           gln(73), gln(74), gln(75), gln(76), gln(77), gln(78),         &amp;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;           gln(79), gln(80), gln(81), gln(82), gln(83), gln(84),         &amp;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;           gln(85), gln(86), gln(87), gln(88)/                           &amp;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;           2.13532241494563261d+02,     2.17736934113954227d+02,         &amp;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;           2.21956441819130334d+02,     2.26190548323727593d+02,         &amp;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;           2.30439043565776952d+02,     2.34701723442818268d+02,         &amp;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;           2.38978389561834323d+02,     2.43268849002982714d+02,         &amp;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;           2.47572914096186884d+02,     2.51890402209723194d+02,         &amp;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;           2.56221135550009525d+02,     2.60564940971863209d+02,         &amp;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;           2.64921649798552801d+02,     2.69291097651019823d+02,         &amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;           2.73673124285693704d+02,     2.78067573440366143d+02,         &amp;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;           2.82474292687630396d+02,     2.86893133295426994d+02,         &amp;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;           2.91323950094270308d+02,     2.95766601350760624d+02,         &amp;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;           3.00220948647014132d+02,     3.04686856765668715d+02/</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <span class="keyword">DATA</span> gln(89), gln(90), gln(91), gln(92), gln(93), gln(94),         &amp;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;           gln(95), gln(96), gln(97), gln(98), gln(99), gln(100)/        &amp;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;           3.09164193580146922d+02,     3.13652829949879062d+02,         &amp;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;           3.18152639620209327d+02,     3.22663499126726177d+02,         &amp;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;           3.27185287703775217d+02,     3.31717887196928473d+02,         &amp;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;           3.36261181979198477d+02,     3.40815058870799018d+02,         &amp;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;           3.45379407062266854d+02,     3.49954118040770237d+02,         &amp;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;           3.54539085519440809d+02,     3.59134205369575399d+02/</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">!             COEFFICIENTS OF ASYMPTOTIC EXPANSION</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <span class="keyword">DATA</span> cf(1), cf(2), cf(3), cf(4), cf(5), cf(6), cf(7), cf(8),       &amp;</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;           cf(9), cf(10), cf(11), cf(12), cf(13), cf(14), cf(15),        &amp;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;           cf(16), cf(17), cf(18), cf(19), cf(20), cf(21), cf(22)/       &amp;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;           8.33333333333333333d-02,    -2.77777777777777778d-03,         &amp;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;           7.93650793650793651d-04,    -5.95238095238095238d-04,         &amp;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;           8.41750841750841751d-04,    -1.91752691752691753d-03,         &amp;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;           6.41025641025641026d-03,    -2.95506535947712418d-02,         &amp;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;           1.79644372368830573d-01,    -1.39243221690590112d+00,         &amp;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;           1.34028640441683920d+01,    -1.56848284626002017d+02,         &amp;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;           2.19310333333333333d+03,    -3.61087712537249894d+04,         &amp;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;           6.91472268851313067d+05,    -1.52382215394074162d+07,         &amp;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;           3.82900751391414141d+08,    -1.08822660357843911d+10,         &amp;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;           3.47320283765002252d+11,    -1.23696021422692745d+13,         &amp;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;           4.88788064793079335d+14,    -2.13203339609193739d+16/</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">!             LN(2*PI)</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <span class="keyword">DATA</span> con                    /     1.83787706640934548d+00/</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">!***FIRST EXECUTABLE STATEMENT  DGAMLN</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      ierr=0</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordflow">IF</span> (z.LE.0.0d0) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="keywordflow">IF</span> (z.GT.101.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      nz = int(sngl(z))</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      fz = z - float(nz)</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="keywordflow">IF</span> (fz.GT.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <span class="keywordflow">IF</span> (nz.GT.100) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      dgamln = gln(nz)</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      wdtol = d1mach(4)</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      wdtol = dmax1(wdtol,0.5d-18)</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      i1m = i1mach(14)</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      rln = d1mach(5)*float(i1m)</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      fln = dmin1(rln,20.0d0)</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      fln = dmax1(fln,3.0d0)</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      fln = fln - 3.0d0</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      zm = 1.8000d0 + 0.3875d0*fln</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      mz = int(sngl(zm)) + 1</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      zmin = float(mz)</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      zdmy = z</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      zinc = 0.0d0</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <span class="keywordflow">IF</span> (z.GE.zmin) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      zinc = zmin - float(nz)</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      zdmy = z + zinc</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      zp = 1.0d0/zdmy</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      t1 = cf(1)*zp</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      s = t1</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="keywordflow">IF</span> (zp.LT.wdtol) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      zsq = zp*zp</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      tst = t1*wdtol</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="keywordflow">DO</span> 30 k=2,22</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        zp = zp*zsq</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        trm = cf(k)*zp</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">IF</span> (dabs(trm).LT.tst) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        s = s + trm</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <span class="keywordflow">IF</span> (zinc.NE.0.0d0) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      tlg = dlog(z)</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      dgamln = z*(tlg-1.0d0) + 0.5d0*(con-tlg) + s</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;      zp = 1.0d0</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      nz = int(sngl(zinc))</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      <span class="keywordflow">DO</span> 60 i=1,nz</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        zp = zp*(z+float(i-1))</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      tlg = dlog(zdmy)</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      dgamln = zdmy*(tlg-1.0d0) - dlog(zp) + 0.5d0*(con-tlg) + s</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      ierr=1</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="keyword">SUBROUTINE </span>zunik(ZRR, ZRI, FNU, IKFLG, IPMTR, TOL, INIT, PHIR,  &amp;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;       PHII, ZETA1R, ZETA1I, ZETA2R, ZETA2I, SUMR, SUMI, CWRKR, CWRKI)</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUNIK</span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment">!        ZUNIK COMPUTES PARAMETERS FOR THE UNIFORM ASYMPTOTIC</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment">!        EXPANSIONS OF THE I AND K FUNCTIONS ON IKFLG= 1 OR 2</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">!        RESPECTIVELY BY</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">!        W(FNU,ZR) = PHI*EXP(ZETA)*SUM</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">!        WHERE       ZETA=-ZETA1 + ZETA2       OR</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">!                          ZETA1 - ZETA2</span></div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">!        THE FIRST CALL MUST HAVE INIT=0. SUBSEQUENT CALLS WITH THE</span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment">!        SAME ZR AND FNU WILL RETURN THE I OR K FUNCTION ON IKFLG=</span></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment">!        1 OR 2 WITH NO CHANGE IN INIT. CWRK IS A COMPLEX WORK</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="comment">!        ARRAY. IPMTR=0 COMPUTES ALL PARAMETERS. IPMTR=1 COMPUTES PHI,</span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment">!        ZETA1,ZETA2.</span></div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment">!***ROUTINES CALLED  ZDIV,ZLOG,ZSQRT</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">!***END PROLOGUE  ZUNIK</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">!     COMPLEX CFN,CON,CONE,CRFN,CWRK,CZERO,PHI,S,SR,SUM,T,T2,ZETA1,</span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment">!    *ZETA2,ZN,ZR</span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> ac, c, con, conei, coner, crfni, crfnr, cwrki,  &amp;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      cwrkr, fnu, phii, phir, rfn, si, sr, sri, srr, sti, str, sumi,   &amp;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      sumr, test, ti, tol, tr, t2i, t2r, zeroi, zeror, zeta1i, zeta1r, &amp;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      zeta2i, zeta2r, zni, znr, zri, zrr</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      <span class="keywordtype">INTEGER</span> i, idum, ikflg, init, ipmtr, j, k, l</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      dimension c(120), cwrkr(16), cwrki(16), con(2)</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      <span class="keyword">DATA</span> con(1), con(2)  /  &amp;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;       3.98942280401432678d-01,  1.25331413731550025d+00 /</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      <span class="keyword">DATA</span> c(1), c(2), c(3), c(4), c(5), c(6), c(7), c(8), c(9), c(10), &amp;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;           c(11), c(12), c(13), c(14), c(15), c(16), c(17), c(18),      &amp;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;           c(19), c(20), c(21), c(22), c(23), c(24)/                    &amp;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;           1.00000000000000000d+00,    -2.08333333333333333d-01,        &amp;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;           1.25000000000000000d-01,     3.34201388888888889d-01,        &amp;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;          -4.01041666666666667d-01,     7.03125000000000000d-02,        &amp;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;          -1.02581259645061728d+00,     1.84646267361111111d+00,        &amp;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;          -8.91210937500000000d-01,     7.32421875000000000d-02,        &amp;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;           4.66958442342624743d+00,    -1.12070026162229938d+01,        &amp;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;           8.78912353515625000d+00,    -2.36408691406250000d+00,        &amp;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;           1.12152099609375000d-01,    -2.82120725582002449d+01,        &amp;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;           8.46362176746007346d+01,    -9.18182415432400174d+01,        &amp;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;           4.25349987453884549d+01,    -7.36879435947963170d+00,        &amp;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;           2.27108001708984375d-01,     2.12570130039217123d+02,        &amp;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;          -7.65252468141181642d+02,     1.05999045252799988d+03/</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      <span class="keyword">DATA</span> c(25), c(26), c(27), c(28), c(29), c(30), c(31), c(32),      &amp;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;           c(33), c(34), c(35), c(36), c(37), c(38), c(39), c(40),      &amp;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;           c(41), c(42), c(43), c(44), c(45), c(46), c(47), c(48)/      &amp;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;          -6.99579627376132541d+02,     2.18190511744211590d+02,        &amp;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;          -2.64914304869515555d+01,     5.72501420974731445d-01,        &amp;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;          -1.91945766231840700d+03,     8.06172218173730938d+03,        &amp;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;          -1.35865500064341374d+04,     1.16553933368645332d+04,        &amp;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;          -5.30564697861340311d+03,     1.20090291321635246d+03,        &amp;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;          -1.08090919788394656d+02,     1.72772750258445740d+00,        &amp;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;           2.02042913309661486d+04,    -9.69805983886375135d+04,        &amp;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;           1.92547001232531532d+05,    -2.03400177280415534d+05,        &amp;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;           1.22200464983017460d+05,    -4.11926549688975513d+04,        &amp;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;           7.10951430248936372d+03,    -4.93915304773088012d+02,        &amp;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;           6.07404200127348304d+00,    -2.42919187900551333d+05,        &amp;</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;           1.31176361466297720d+06,    -2.99801591853810675d+06/</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="keyword">DATA</span> c(49), c(50), c(51), c(52), c(53), c(54), c(55), c(56),      &amp;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;           c(57), c(58), c(59), c(60), c(61), c(62), c(63), c(64),      &amp;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;           c(65), c(66), c(67), c(68), c(69), c(70), c(71), c(72)/      &amp;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;           3.76327129765640400d+06,    -2.81356322658653411d+06,        &amp;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;           1.26836527332162478d+06,    -3.31645172484563578d+05,        &amp;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;           4.52187689813627263d+04,    -2.49983048181120962d+03,        &amp;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;           2.43805296995560639d+01,     3.28446985307203782d+06,        &amp;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;          -1.97068191184322269d+07,     5.09526024926646422d+07,        &amp;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;          -7.41051482115326577d+07,     6.63445122747290267d+07,        &amp;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;          -3.75671766607633513d+07,     1.32887671664218183d+07,        &amp;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;          -2.78561812808645469d+06,     3.08186404612662398d+05,        &amp;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;          -1.38860897537170405d+04,     1.10017140269246738d+02,        &amp;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;          -4.93292536645099620d+07,     3.25573074185765749d+08,        &amp;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;          -9.39462359681578403d+08,     1.55359689957058006d+09,        &amp;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          -1.62108055210833708d+09,     1.10684281682301447d+09/</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      <span class="keyword">DATA</span> c(73), c(74), c(75), c(76), c(77), c(78), c(79), c(80),      &amp;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;           c(81), c(82), c(83), c(84), c(85), c(86), c(87), c(88),      &amp;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;           c(89), c(90), c(91), c(92), c(93), c(94), c(95), c(96)/      &amp;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          -4.95889784275030309d+08,     1.42062907797533095d+08,        &amp;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          -2.44740627257387285d+07,     2.24376817792244943d+06,        &amp;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;          -8.40054336030240853d+04,     5.51335896122020586d+02,        &amp;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;           8.14789096118312115d+08,    -5.86648149205184723d+09,        &amp;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;           1.86882075092958249d+10,    -3.46320433881587779d+10,        &amp;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;           4.12801855797539740d+10,    -3.30265997498007231d+10,        &amp;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;           1.79542137311556001d+10,    -6.56329379261928433d+09,        &amp;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;           1.55927986487925751d+09,    -2.25105661889415278d+08,        &amp;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;           1.73951075539781645d+07,    -5.49842327572288687d+05,        &amp;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;           3.03809051092238427d+03,    -1.46792612476956167d+10,        &amp;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;           1.14498237732025810d+11,    -3.99096175224466498d+11,        &amp;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;           8.19218669548577329d+11,    -1.09837515608122331d+12/</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keyword">DATA</span> c(97), c(98), c(99), c(100), c(101), c(102), c(103), c(104), &amp;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;           c(105), c(106), c(107), c(108), c(109), c(110), c(111),      &amp;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;           c(112), c(113), c(114), c(115), c(116), c(117), c(118)/      &amp;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;           1.00815810686538209d+12,    -6.45364869245376503d+11,        &amp;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;           2.87900649906150589d+11,    -8.78670721780232657d+10,        &amp;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;           1.76347306068349694d+10,    -2.16716498322379509d+09,        &amp;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;           1.43157876718888981d+08,    -3.87183344257261262d+06,        &amp;</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;           1.82577554742931747d+04,     2.86464035717679043d+11,        &amp;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          -2.40629790002850396d+12,     9.10934118523989896d+12,        &amp;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          -2.05168994109344374d+13,     3.05651255199353206d+13,        &amp;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;          -3.16670885847851584d+13,     2.33483640445818409d+13,        &amp;</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;          -1.23204913055982872d+13,     4.61272578084913197d+12,        &amp;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;          -1.19655288019618160d+12,     2.05914503232410016d+11,        &amp;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          -2.18229277575292237d+10,     1.24700929351271032d+09/</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      <span class="keyword">DATA</span> c(119), c(120)/  &amp;</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          -2.91883881222208134d+07,     1.18838426256783253d+05/</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">IF</span> (init.NE.0) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment">!     INITIALIZE ALL VARIABLES</span></div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      rfn = 1.0d0/fnu</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      tr = zrr*rfn</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      ti = zri*rfn</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      sr = coner + (tr*tr-ti*ti)</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      si = conei + (tr*ti+ti*tr)</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      <span class="keyword">CALL </span>zsqrt(sr, si, srr, sri)</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      str = coner + srr</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      sti = conei + sri</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      <span class="keyword">CALL </span>zdiv(str, sti, tr, ti, znr, zni)</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      <span class="keyword">CALL </span>zlog(znr, zni, str, sti, idum)</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;      zeta1r = fnu*str</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      zeta1i = fnu*sti</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      zeta2r = fnu*srr</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;      zeta2i = fnu*sri</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="keyword">CALL </span>zdiv(coner, conei, srr, sri, tr, ti)</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      srr = tr*rfn</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      sri = ti*rfn</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="keyword">CALL </span>zsqrt(srr, sri, cwrkr(16), cwrki(16))</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      phir = cwrkr(16)*con(ikflg)</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      phii = cwrki(16)*con(ikflg)</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;      <span class="keywordflow">IF</span> (ipmtr.NE.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="keyword">CALL </span>zdiv(coner, conei, sr, si, t2r, t2i)</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      cwrkr(1) = coner</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      cwrki(1) = conei</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      crfnr = coner</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      crfni = conei</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      ac = 1.0d0</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      l = 1</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <span class="keywordflow">DO</span> 20 k=2,15</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        sr = zeror</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        si = zeroi</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="keywordflow">DO</span> 10 j=1,k</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;          l = l + 1</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;          str = sr*t2r - si*t2i + c(l)</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          si = sr*t2i + si*t2r</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;          sr = str</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;   10   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        str = crfnr*srr - crfni*sri</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        crfni = crfnr*sri + crfni*srr</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        crfnr = str</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        cwrkr(k) = crfnr*sr - crfni*si</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        cwrki(k) = crfnr*si + crfni*sr</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        ac = ac*rfn</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        test = dabs(cwrkr(k)) + dabs(cwrki(k))</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="keywordflow">IF</span> (ac.LT.tol .AND. test.LT.tol) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      k = 15</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      init = k</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordflow">IF</span> (ikflg.EQ.2) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment">!     COMPUTE SUM FOR THE I FUNCTION</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      sr = zeror</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      si = zeroi</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <span class="keywordflow">DO</span> 50 i=1,init</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        sr = sr + cwrkr(i)</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        si = si + cwrki(i)</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      sumr = sr</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      sumi = si</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      phir = cwrkr(16)*con(1)</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      phii = cwrki(16)*con(1)</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="comment">!     COMPUTE SUM FOR THE K FUNCTION</span></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      sr = zeror</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      si = zeroi</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      tr = coner</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <span class="keywordflow">DO</span> 70 i=1,init</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        sr = sr + tr*cwrkr(i)</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        si = si + tr*cwrki(i)</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        tr = -tr</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      sumr = sr</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      sumi = si</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      phir = cwrkr(16)*con(2)</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      phii = cwrki(16)*con(2)</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="keyword">SUBROUTINE </span>zunhj(ZR, ZI, FNU, IPMTR, TOL, PHIR, PHII, ARGR, ARGI,  &amp;</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;       ZETA1R, ZETA1I, ZETA2R, ZETA2I, ASUMR, ASUMI, BSUMR, BSUMI)</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZUNHJ</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment">!     REFERENCES</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment">!         HANDBOOK OF MATHEMATICAL FUNCTIONS BY M. ABRAMOWITZ AND I.A.</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">!         STEGUN, AMS55, NATIONAL BUREAU OF STANDARDS, 1965, CHAPTER 9.</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="comment">!         ASYMPTOTICS AND SPECIAL FUNCTIONS BY F.W.J. OLVER, ACADEMIC</span></div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment">!         PRESS, N.Y., 1974, PAGE 420</span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">!     ABSTRACT</span></div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment">!         ZUNHJ COMPUTES PARAMETERS FOR BESSEL FUNCTIONS C(FNU,Z) =</span></div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="comment">!         J(FNU,Z), Y(FNU,Z) OR H(I,FNU,Z) I=1,2 FOR LARGE ORDERS FNU</span></div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="comment">!         BY MEANS OF THE UNIFORM ASYMPTOTIC EXPANSION</span></div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">!         C(FNU,Z)=C1*PHI*( ASUM*AIRY(ARG) + C2*BSUM*DAIRY(ARG) )</span></div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">!         FOR PROPER CHOICES OF C1, C2, AIRY AND DAIRY WHERE AIRY IS</span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">!         AN AIRY FUNCTION AND DAIRY IS ITS DERIVATIVE.</span></div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment">!               (2/3)*FNU*ZETA**1.5 = ZETA1-ZETA2,</span></div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">!         ZETA1=0.5*FNU*CLOG((1+W)/(1-W)), ZETA2=FNU*W FOR SCALING</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">!         PURPOSES IN AIRY FUNCTIONS FROM CAIRY OR CBIRY.</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">!         MCONJ=SIGN OF AIMAG(Z), BUT IS AMBIGUOUS WHEN Z IS REAL AND</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">!         MUST BE SPECIFIED. IPMTR=0 RETURNS ALL PARAMETERS. IPMTR=</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">!         1 COMPUTES ALL EXCEPT ASUM AND BSUM.</span></div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment">!***ROUTINES CALLED  ZABS,ZDIV,ZLOG,ZSQRT</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="comment">!***END PROLOGUE  ZUNHJ</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="comment">!     COMPLEX ARG,ASUM,BSUM,CFNU,CONE,CR,CZERO,DR,P,PHI,PRZTH,PTFN,</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment">!    *RFN13,RTZTA,RZTH,SUMA,SUMB,TFN,T2,UP,W,W2,Z,ZA,ZB,ZC,ZETA,ZETA1,</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;<span class="comment">!    *ZETA2,ZTH</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> alfa, ang, ap, ar, argi, argr, asumi, asumr,      &amp;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;       atol, aw2, azth, beta, br, bsumi, bsumr, btol, c, conei, coner,   &amp;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;       cri, crr, dri, drr, ex1, ex2, fnu, fn13, fn23, gama, gpi, hpi,    &amp;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;       phii, phir, pi, pp, pr, przthi, przthr, ptfni, ptfnr, raw, raw2,  &amp;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;       razth, rfnu, rfnu2, rfn13, rtzti, rtztr, rzthi, rzthr, sti, str,  &amp;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;       sumai, sumar, sumbi, sumbr, test, tfni, tfnr, thpi, tol, tzai,    &amp;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;       tzar, t2i, t2r, upi, upr, wi, wr, w2i, w2r, zai, zar, zbi, zbr,   &amp;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;       zci, zcr, zeroi, zeror, zetai, zetar, zeta1i, zeta1r, zeta2i,     &amp;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;       zeta2r, zi, zr, zthi, zthr</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <span class="keywordtype">INTEGER</span> ias, ibs, ipmtr, is, j, jr, ju, k, kmax, kp1, ks, l, lr,   &amp;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;       lrp1, l1, l2, m, idum</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      dimension ar(14), br(14), c(105), alfa(180), beta(210), gama(30),  &amp;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;       ap(30), pr(30), pi(30), upr(14), upi(14), crr(14), cri(14),       &amp;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;       drr(14), dri(14)</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <span class="keyword">DATA</span> ar(1), ar(2), ar(3), ar(4), ar(5), ar(6), ar(7), ar(8),  &amp;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;           ar(9), ar(10), ar(11), ar(12), ar(13), ar(14)/           &amp;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;           1.00000000000000000d+00,     1.04166666666666667d-01,    &amp;</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;           8.35503472222222222d-02,     1.28226574556327160d-01,    &amp;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;           2.91849026464140464d-01,     8.81627267443757652d-01,    &amp;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;           3.32140828186276754d+00,     1.49957629868625547d+01,    &amp;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;           7.89230130115865181d+01,     4.74451538868264323d+02,    &amp;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;           3.20749009089066193d+03,     2.40865496408740049d+04,    &amp;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;           1.98923119169509794d+05,     1.79190200777534383d+06/</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      <span class="keyword">DATA</span> br(1), br(2), br(3), br(4), br(5), br(6), br(7), br(8),  &amp;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;           br(9), br(10), br(11), br(12), br(13), br(14)/           &amp;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;           1.00000000000000000d+00,    -1.45833333333333333d-01,    &amp;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;          -9.87413194444444444d-02,    -1.43312053915895062d-01,    &amp;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;          -3.17227202678413548d-01,    -9.42429147957120249d-01,    &amp;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;          -3.51120304082635426d+00,    -1.57272636203680451d+01,    &amp;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;          -8.22814390971859444d+01,    -4.92355370523670524d+02,    &amp;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;          -3.31621856854797251d+03,    -2.48276742452085896d+04,    &amp;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;          -2.04526587315129788d+05,    -1.83844491706820990d+06/</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <span class="keyword">DATA</span> c(1), c(2), c(3), c(4), c(5), c(6), c(7), c(8), c(9), c(10), &amp;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;           c(11), c(12), c(13), c(14), c(15), c(16), c(17), c(18),      &amp;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;           c(19), c(20), c(21), c(22), c(23), c(24)/                    &amp;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;           1.00000000000000000d+00,    -2.08333333333333333d-01,        &amp;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;           1.25000000000000000d-01,     3.34201388888888889d-01,        &amp;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;          -4.01041666666666667d-01,     7.03125000000000000d-02,        &amp;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;          -1.02581259645061728d+00,     1.84646267361111111d+00,        &amp;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;          -8.91210937500000000d-01,     7.32421875000000000d-02,        &amp;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;           4.66958442342624743d+00,    -1.12070026162229938d+01,        &amp;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;           8.78912353515625000d+00,    -2.36408691406250000d+00,        &amp;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;           1.12152099609375000d-01,    -2.82120725582002449d+01,        &amp;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;           8.46362176746007346d+01,    -9.18182415432400174d+01,        &amp;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;           4.25349987453884549d+01,    -7.36879435947963170d+00,        &amp;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;           2.27108001708984375d-01,     2.12570130039217123d+02,        &amp;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;          -7.65252468141181642d+02,     1.05999045252799988d+03/</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      <span class="keyword">DATA</span> c(25), c(26), c(27), c(28), c(29), c(30), c(31), c(32),      &amp;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;           c(33), c(34), c(35), c(36), c(37), c(38), c(39), c(40),      &amp;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;           c(41), c(42), c(43), c(44), c(45), c(46), c(47), c(48)/      &amp;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;          -6.99579627376132541d+02,     2.18190511744211590d+02,        &amp;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;          -2.64914304869515555d+01,     5.72501420974731445d-01,        &amp;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;          -1.91945766231840700d+03,     8.06172218173730938d+03,        &amp;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;          -1.35865500064341374d+04,     1.16553933368645332d+04,        &amp;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;          -5.30564697861340311d+03,     1.20090291321635246d+03,        &amp;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;          -1.08090919788394656d+02,     1.72772750258445740d+00,        &amp;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;           2.02042913309661486d+04,    -9.69805983886375135d+04,        &amp;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;           1.92547001232531532d+05,    -2.03400177280415534d+05,        &amp;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;           1.22200464983017460d+05,    -4.11926549688975513d+04,        &amp;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;           7.10951430248936372d+03,    -4.93915304773088012d+02,        &amp;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;           6.07404200127348304d+00,    -2.42919187900551333d+05,        &amp;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;           1.31176361466297720d+06,    -2.99801591853810675d+06/</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <span class="keyword">DATA</span> c(49), c(50), c(51), c(52), c(53), c(54), c(55), c(56),      &amp;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;           c(57), c(58), c(59), c(60), c(61), c(62), c(63), c(64),      &amp;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;           c(65), c(66), c(67), c(68), c(69), c(70), c(71), c(72)/      &amp;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;           3.76327129765640400d+06,    -2.81356322658653411d+06,        &amp;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;           1.26836527332162478d+06,    -3.31645172484563578d+05,        &amp;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;           4.52187689813627263d+04,    -2.49983048181120962d+03,        &amp;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;           2.43805296995560639d+01,     3.28446985307203782d+06,        &amp;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          -1.97068191184322269d+07,     5.09526024926646422d+07,        &amp;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;          -7.41051482115326577d+07,     6.63445122747290267d+07,        &amp;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;          -3.75671766607633513d+07,     1.32887671664218183d+07,        &amp;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;          -2.78561812808645469d+06,     3.08186404612662398d+05,        &amp;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;          -1.38860897537170405d+04,     1.10017140269246738d+02,        &amp;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;          -4.93292536645099620d+07,     3.25573074185765749d+08,        &amp;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;          -9.39462359681578403d+08,     1.55359689957058006d+09,        &amp;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          -1.62108055210833708d+09,     1.10684281682301447d+09/</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      <span class="keyword">DATA</span> c(73), c(74), c(75), c(76), c(77), c(78), c(79), c(80),      &amp;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;           c(81), c(82), c(83), c(84), c(85), c(86), c(87), c(88),      &amp;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;           c(89), c(90), c(91), c(92), c(93), c(94), c(95), c(96)/      &amp;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;          -4.95889784275030309d+08,     1.42062907797533095d+08,        &amp;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;          -2.44740627257387285d+07,     2.24376817792244943d+06,        &amp;</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;          -8.40054336030240853d+04,     5.51335896122020586d+02,        &amp;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;           8.14789096118312115d+08,    -5.86648149205184723d+09,        &amp;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;           1.86882075092958249d+10,    -3.46320433881587779d+10,        &amp;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;           4.12801855797539740d+10,    -3.30265997498007231d+10,        &amp;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;           1.79542137311556001d+10,    -6.56329379261928433d+09,        &amp;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;           1.55927986487925751d+09,    -2.25105661889415278d+08,        &amp;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;           1.73951075539781645d+07,    -5.49842327572288687d+05,        &amp;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;           3.03809051092238427d+03,    -1.46792612476956167d+10,        &amp;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;           1.14498237732025810d+11,    -3.99096175224466498d+11,        &amp;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;           8.19218669548577329d+11,    -1.09837515608122331d+12/</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <span class="keyword">DATA</span> c(97), c(98), c(99), c(100), c(101), c(102), c(103), c(104), &amp;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;           c(105)/                                                      &amp;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;           1.00815810686538209d+12,    -6.45364869245376503d+11,        &amp;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;           2.87900649906150589d+11,    -8.78670721780232657d+10,        &amp;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;           1.76347306068349694d+10,    -2.16716498322379509d+09,        &amp;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;           1.43157876718888981d+08,    -3.87183344257261262d+06,        &amp;</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;           1.82577554742931747d+04/</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      <span class="keyword">DATA</span> alfa(1), alfa(2), alfa(3), alfa(4), alfa(5), alfa(6),        &amp;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;           alfa(7), alfa(8), alfa(9), alfa(10), alfa(11), alfa(12),     &amp;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;           alfa(13), alfa(14), alfa(15), alfa(16), alfa(17), alfa(18),  &amp;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;           alfa(19), alfa(20), alfa(21), alfa(22)/                      &amp;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;          -4.44444444444444444d-03,    -9.22077922077922078d-04,        &amp;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;          -8.84892884892884893d-05,     1.65927687832449737d-04,        &amp;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;           2.46691372741792910d-04,     2.65995589346254780d-04,        &amp;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;           2.61824297061500945d-04,     2.48730437344655609d-04,        &amp;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;           2.32721040083232098d-04,     2.16362485712365082d-04,        &amp;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;           2.00738858762752355d-04,     1.86267636637545172d-04,        &amp;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;           1.73060775917876493d-04,     1.61091705929015752d-04,        &amp;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;           1.50274774160908134d-04,     1.40503497391269794d-04,        &amp;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;           1.31668816545922806d-04,     1.23667445598253261d-04,        &amp;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;           1.16405271474737902d-04,     1.09798298372713369d-04,        &amp;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;           1.03772410422992823d-04,     9.82626078369363448d-05/</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      <span class="keyword">DATA</span> alfa(23), alfa(24), alfa(25), alfa(26), alfa(27), alfa(28),  &amp;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;           alfa(29), alfa(30), alfa(31), alfa(32), alfa(33), alfa(34),  &amp;</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;           alfa(35), alfa(36), alfa(37), alfa(38), alfa(39), alfa(40),  &amp;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;           alfa(41), alfa(42), alfa(43), alfa(44)/                      &amp;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;           9.32120517249503256d-05,     8.85710852478711718d-05,        &amp;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;           8.42963105715700223d-05,     8.03497548407791151d-05,        &amp;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;           7.66981345359207388d-05,     7.33122157481777809d-05,        &amp;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;           7.01662625163141333d-05,     6.72375633790160292d-05,        &amp;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;           6.93735541354588974d-04,     2.32241745182921654d-04,        &amp;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;          -1.41986273556691197d-05,    -1.16444931672048640d-04,        &amp;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;          -1.50803558053048762d-04,    -1.55121924918096223d-04,        &amp;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;          -1.46809756646465549d-04,    -1.33815503867491367d-04,        &amp;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;          -1.19744975684254051d-04,    -1.06184319207974020d-04,        &amp;</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;          -9.37699549891194492d-05,    -8.26923045588193274d-05,        &amp;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;          -7.29374348155221211d-05,    -6.44042357721016283d-05/</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="keyword">DATA</span> alfa(45), alfa(46), alfa(47), alfa(48), alfa(49), alfa(50),  &amp;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;           alfa(51), alfa(52), alfa(53), alfa(54), alfa(55), alfa(56),  &amp;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;           alfa(57), alfa(58), alfa(59), alfa(60), alfa(61), alfa(62),  &amp;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;           alfa(63), alfa(64), alfa(65), alfa(66)/                      &amp;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;          -5.69611566009369048d-05,    -5.04731044303561628d-05,        &amp;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;          -4.48134868008882786d-05,    -3.98688727717598864d-05,        &amp;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;          -3.55400532972042498d-05,    -3.17414256609022480d-05,        &amp;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;          -2.83996793904174811d-05,    -2.54522720634870566d-05,        &amp;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;          -2.28459297164724555d-05,    -2.05352753106480604d-05,        &amp;</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;          -1.84816217627666085d-05,    -1.66519330021393806d-05,        &amp;</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;          -1.50179412980119482d-05,    -1.35554031379040526d-05,        &amp;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;          -1.22434746473858131d-05,    -1.10641884811308169d-05,        &amp;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;          -3.54211971457743841d-04,    -1.56161263945159416d-04,        &amp;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;           3.04465503594936410d-05,     1.30198655773242693d-04,        &amp;</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;           1.67471106699712269d-04,     1.70222587683592569d-04/</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keyword">DATA</span> alfa(67), alfa(68), alfa(69), alfa(70), alfa(71), alfa(72),  &amp;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;           alfa(73), alfa(74), alfa(75), alfa(76), alfa(77), alfa(78),  &amp;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;           alfa(79), alfa(80), alfa(81), alfa(82), alfa(83), alfa(84),  &amp;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;           alfa(85), alfa(86), alfa(87), alfa(88)/                      &amp;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;           1.56501427608594704d-04,     1.36339170977445120d-04,        &amp;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;           1.14886692029825128d-04,     9.45869093034688111d-05,        &amp;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;           7.64498419250898258d-05,     6.07570334965197354d-05,        &amp;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;           4.74394299290508799d-05,     3.62757512005344297d-05,        &amp;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;           2.69939714979224901d-05,     1.93210938247939253d-05,        &amp;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;           1.30056674793963203d-05,     7.82620866744496661d-06,        &amp;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;           3.59257485819351583d-06,     1.44040049814251817d-07,        &amp;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;          -2.65396769697939116d-06,    -4.91346867098485910d-06,        &amp;</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;          -6.72739296091248287d-06,    -8.17269379678657923d-06,        &amp;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;          -9.31304715093561232d-06,    -1.02011418798016441d-05,        &amp;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;          -1.08805962510592880d-05,    -1.13875481509603555d-05/</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <span class="keyword">DATA</span> alfa(89), alfa(90), alfa(91), alfa(92), alfa(93), alfa(94),  &amp;</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;           alfa(95), alfa(96), alfa(97), alfa(98), alfa(99), alfa(100), &amp;</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;           alfa(101), alfa(102), alfa(103), alfa(104), alfa(105),       &amp;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;           alfa(106), alfa(107), alfa(108), alfa(109), alfa(110)/       &amp;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;          -1.17519675674556414d-05,    -1.19987364870944141d-05,        &amp;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;           3.78194199201772914d-04,     2.02471952761816167d-04,        &amp;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;          -6.37938506318862408d-05,    -2.38598230603005903d-04,        &amp;</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;          -3.10916256027361568d-04,    -3.13680115247576316d-04,        &amp;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;          -2.78950273791323387d-04,    -2.28564082619141374d-04,        &amp;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;          -1.75245280340846749d-04,    -1.25544063060690348d-04,        &amp;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;          -8.22982872820208365d-05,    -4.62860730588116458d-05,        &amp;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;          -1.72334302366962267d-05,     5.60690482304602267d-06,        &amp;</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;           2.31395443148286800d-05,     3.62642745856793957d-05,        &amp;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;           4.58006124490188752d-05,     5.24595294959114050d-05,        &amp;</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;           5.68396208545815266d-05,     5.94349820393104052d-05/</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;      <span class="keyword">DATA</span> alfa(111), alfa(112), alfa(113), alfa(114), alfa(115),       &amp;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;           alfa(116), alfa(117), alfa(118), alfa(119), alfa(120),       &amp;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;           alfa(121), alfa(122), alfa(123), alfa(124), alfa(125),       &amp;</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;           alfa(126), alfa(127), alfa(128), alfa(129), alfa(130)/       &amp;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;           6.06478527578421742d-05,     6.08023907788436497d-05,        &amp;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;           6.01577894539460388d-05,     5.89199657344698500d-05,        &amp;</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;           5.72515823777593053d-05,     5.52804375585852577d-05,        &amp;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;           5.31063773802880170d-05,     5.08069302012325706d-05,        &amp;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;           4.84418647620094842d-05,     4.60568581607475370d-05,        &amp;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;          -6.91141397288294174d-04,    -4.29976633058871912d-04,        &amp;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;           1.83067735980039018d-04,     6.60088147542014144d-04,        &amp;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;           8.75964969951185931d-04,     8.77335235958235514d-04,        &amp;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;           7.49369585378990637d-04,     5.63832329756980918d-04,        &amp;</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;           3.68059319971443156d-04,     1.88464535514455599d-04/</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <span class="keyword">DATA</span> alfa(131), alfa(132), alfa(133), alfa(134), alfa(135),       &amp;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;           alfa(136), alfa(137), alfa(138), alfa(139), alfa(140),       &amp;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;           alfa(141), alfa(142), alfa(143), alfa(144), alfa(145),       &amp;</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;           alfa(146), alfa(147), alfa(148), alfa(149), alfa(150)/       &amp;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;           3.70663057664904149d-05,    -8.28520220232137023d-05,        &amp;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;          -1.72751952869172998d-04,    -2.36314873605872983d-04,        &amp;</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;          -2.77966150694906658d-04,    -3.02079514155456919d-04,        &amp;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;          -3.12594712643820127d-04,    -3.12872558758067163d-04,        &amp;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;          -3.05678038466324377d-04,    -2.93226470614557331d-04,        &amp;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;          -2.77255655582934777d-04,    -2.59103928467031709d-04,        &amp;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;          -2.39784014396480342d-04,    -2.20048260045422848d-04,        &amp;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;          -2.00443911094971498d-04,    -1.81358692210970687d-04,        &amp;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;          -1.63057674478657464d-04,    -1.45712672175205844d-04,        &amp;</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;          -1.29425421983924587d-04,    -1.14245691942445952d-04/</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keyword">DATA</span> alfa(151), alfa(152), alfa(153), alfa(154), alfa(155),       &amp;</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;           alfa(156), alfa(157), alfa(158), alfa(159), alfa(160),       &amp;</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;           alfa(161), alfa(162), alfa(163), alfa(164), alfa(165),       &amp;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;           alfa(166), alfa(167), alfa(168), alfa(169), alfa(170)/       &amp;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;           1.92821964248775885d-03,     1.35592576302022234d-03,        &amp;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;          -7.17858090421302995d-04,    -2.58084802575270346d-03,        &amp;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;          -3.49271130826168475d-03,    -3.46986299340960628d-03,        &amp;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;          -2.82285233351310182d-03,    -1.88103076404891354d-03,        &amp;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;          -8.89531718383947600d-04,     3.87912102631035228d-06,        &amp;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;           7.28688540119691412d-04,     1.26566373053457758d-03,        &amp;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;           1.62518158372674427d-03,     1.83203153216373172d-03,        &amp;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;           1.91588388990527909d-03,     1.90588846755546138d-03,        &amp;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;           1.82798982421825727d-03,     1.70389506421121530d-03,        &amp;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;           1.55097127171097686d-03,     1.38261421852276159d-03/</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      <span class="keyword">DATA</span> alfa(171), alfa(172), alfa(173), alfa(174), alfa(175),       &amp;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;           alfa(176), alfa(177), alfa(178), alfa(179), alfa(180)/       &amp;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;           1.20881424230064774d-03,     1.03676532638344962d-03,        &amp;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;           8.71437918068619115d-04,     7.16080155297701002d-04,        &amp;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;           5.72637002558129372d-04,     4.42089819465802277d-04,        &amp;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;           3.24724948503090564d-04,     2.20342042730246599d-04,        &amp;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;           1.28412898401353882d-04,     4.82005924552095464d-05/</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <span class="keyword">DATA</span> beta(1), beta(2), beta(3), beta(4), beta(5), beta(6),        &amp;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;           beta(7), beta(8), beta(9), beta(10), beta(11), beta(12),     &amp;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;           beta(13), beta(14), beta(15), beta(16), beta(17), beta(18),  &amp;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;           beta(19), beta(20), beta(21), beta(22)/                      &amp;</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;           1.79988721413553309d-02,     5.59964911064388073d-03,        &amp;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;           2.88501402231132779d-03,     1.80096606761053941d-03,        &amp;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;           1.24753110589199202d-03,     9.22878876572938311d-04,        &amp;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;           7.14430421727287357d-04,     5.71787281789704872d-04,        &amp;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;           4.69431007606481533d-04,     3.93232835462916638d-04,        &amp;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;           3.34818889318297664d-04,     2.88952148495751517d-04,        &amp;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;           2.52211615549573284d-04,     2.22280580798883327d-04,        &amp;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;           1.97541838033062524d-04,     1.76836855019718004d-04,        &amp;</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;           1.59316899661821081d-04,     1.44347930197333986d-04,        &amp;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;           1.31448068119965379d-04,     1.20245444949302884d-04,        &amp;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;           1.10449144504599392d-04,     1.01828770740567258d-04/</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <span class="keyword">DATA</span> beta(23), beta(24), beta(25), beta(26), beta(27), beta(28),  &amp;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;           beta(29), beta(30), beta(31), beta(32), beta(33), beta(34),  &amp;</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;           beta(35), beta(36), beta(37), beta(38), beta(39), beta(40),  &amp;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;           beta(41), beta(42), beta(43), beta(44)/                      &amp;</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;           9.41998224204237509d-05,     8.74130545753834437d-05,        &amp;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;           8.13466262162801467d-05,     7.59002269646219339d-05,        &amp;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;           7.09906300634153481d-05,     6.65482874842468183d-05,        &amp;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;           6.25146958969275078d-05,     5.88403394426251749d-05,        &amp;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;          -1.49282953213429172d-03,    -8.78204709546389328d-04,        &amp;</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;          -5.02916549572034614d-04,    -2.94822138512746025d-04,        &amp;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;          -1.75463996970782828d-04,    -1.04008550460816434d-04,        &amp;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;          -5.96141953046457895d-05,    -3.12038929076098340d-05,        &amp;</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;          -1.26089735980230047d-05,    -2.42892608575730389d-07,        &amp;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;           8.05996165414273571d-06,     1.36507009262147391d-05,        &amp;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;           1.73964125472926261d-05,     1.98672978842133780d-05/</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="keyword">DATA</span> beta(45), beta(46), beta(47), beta(48), beta(49), beta(50),  &amp;</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;           beta(51), beta(52), beta(53), beta(54), beta(55), beta(56),  &amp;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;           beta(57), beta(58), beta(59), beta(60), beta(61), beta(62),  &amp;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;           beta(63), beta(64), beta(65), beta(66)/                      &amp;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;           2.14463263790822639d-05,     2.23954659232456514d-05,        &amp;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;           2.28967783814712629d-05,     2.30785389811177817d-05,        &amp;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;           2.30321976080909144d-05,     2.28236073720348722d-05,        &amp;</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;           2.25005881105292418d-05,     2.20981015361991429d-05,        &amp;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;           2.16418427448103905d-05,     2.11507649256220843d-05,        &amp;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;           2.06388749782170737d-05,     2.01165241997081666d-05,        &amp;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;           1.95913450141179244d-05,     1.90689367910436740d-05,        &amp;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;           1.85533719641636667d-05,     1.80475722259674218d-05,        &amp;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;           5.52213076721292790d-04,     4.47932581552384646d-04,        &amp;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;           2.79520653992020589d-04,     1.52468156198446602d-04,        &amp;</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;           6.93271105657043598d-05,     1.76258683069991397d-05/</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      <span class="keyword">DATA</span> beta(67), beta(68), beta(69), beta(70), beta(71), beta(72),  &amp;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;           beta(73), beta(74), beta(75), beta(76), beta(77), beta(78),  &amp;</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;           beta(79), beta(80), beta(81), beta(82), beta(83), beta(84),  &amp;</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;           beta(85), beta(86), beta(87), beta(88)/                      &amp;</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;          -1.35744996343269136d-05,    -3.17972413350427135d-05,        &amp;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;          -4.18861861696693365d-05,    -4.69004889379141029d-05,        &amp;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;          -4.87665447413787352d-05,    -4.87010031186735069d-05,        &amp;</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;          -4.74755620890086638d-05,    -4.55813058138628452d-05,        &amp;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;          -4.33309644511266036d-05,    -4.09230193157750364d-05,        &amp;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;          -3.84822638603221274d-05,    -3.60857167535410501d-05,        &amp;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;          -3.37793306123367417d-05,    -3.15888560772109621d-05,        &amp;</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;          -2.95269561750807315d-05,    -2.75978914828335759d-05,        &amp;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;          -2.58006174666883713d-05,    -2.41308356761280200d-05,        &amp;</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;          -2.25823509518346033d-05,    -2.11479656768912971d-05,        &amp;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;          -1.98200638885294927d-05,    -1.85909870801065077d-05/</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      <span class="keyword">DATA</span> beta(89), beta(90), beta(91), beta(92), beta(93), beta(94),  &amp;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;           beta(95), beta(96), beta(97), beta(98), beta(99), beta(100), &amp;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;           beta(101), beta(102), beta(103), beta(104), beta(105),       &amp;</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;           beta(106), beta(107), beta(108), beta(109), beta(110)/       &amp;</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          -1.74532699844210224d-05,    -1.63997823854497997d-05,        &amp;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;          -4.74617796559959808d-04,    -4.77864567147321487d-04,        &amp;</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;          -3.20390228067037603d-04,    -1.61105016119962282d-04,        &amp;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;          -4.25778101285435204d-05,     3.44571294294967503d-05,        &amp;</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;           7.97092684075674924d-05,     1.03138236708272200d-04,        &amp;</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;           1.12466775262204158d-04,     1.13103642108481389d-04,        &amp;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;           1.08651634848774268d-04,     1.01437951597661973d-04,        &amp;</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;           9.29298396593363896d-05,     8.40293133016089978d-05,        &amp;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;           7.52727991349134062d-05,     6.69632521975730872d-05,        &amp;</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;           5.92564547323194704d-05,     5.22169308826975567d-05,        &amp;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;           4.58539485165360646d-05,     4.01445513891486808d-05/</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <span class="keyword">DATA</span> beta(111), beta(112), beta(113), beta(114), beta(115),       &amp;</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;           beta(116), beta(117), beta(118), beta(119), beta(120),       &amp;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;           beta(121), beta(122), beta(123), beta(124), beta(125),       &amp;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;           beta(126), beta(127), beta(128), beta(129), beta(130)/       &amp;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;           3.50481730031328081d-05,     3.05157995034346659d-05,        &amp;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;           2.64956119950516039d-05,     2.29363633690998152d-05,        &amp;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;           1.97893056664021636d-05,     1.70091984636412623d-05,        &amp;</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;           1.45547428261524004d-05,     1.23886640995878413d-05,        &amp;</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;           1.04775876076583236d-05,     8.79179954978479373d-06,        &amp;</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;           7.36465810572578444d-04,     8.72790805146193976d-04,        &amp;</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;           6.22614862573135066d-04,     2.85998154194304147d-04,        &amp;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;           3.84737672879366102d-06,    -1.87906003636971558d-04,        &amp;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;          -2.97603646594554535d-04,    -3.45998126832656348d-04,        &amp;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;          -3.53382470916037712d-04,    -3.35715635775048757d-04/</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      <span class="keyword">DATA</span> beta(131), beta(132), beta(133), beta(134), beta(135),       &amp;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;           beta(136), beta(137), beta(138), beta(139), beta(140),       &amp;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;           beta(141), beta(142), beta(143), beta(144), beta(145),       &amp;</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;           beta(146), beta(147), beta(148), beta(149), beta(150)/       &amp;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;          -3.04321124789039809d-04,    -2.66722723047612821d-04,        &amp;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;          -2.27654214122819527d-04,    -1.89922611854562356d-04,        &amp;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;          -1.55058918599093870d-04,    -1.23778240761873630d-04,        &amp;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;          -9.62926147717644187d-05,    -7.25178327714425337d-05,        &amp;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;          -5.22070028895633801d-05,    -3.50347750511900522d-05,        &amp;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;          -2.06489761035551757d-05,    -8.70106096849767054d-06,        &amp;</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;           1.13698686675100290d-06,     9.16426474122778849d-06,        &amp;</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;           1.56477785428872620d-05,     2.08223629482466847d-05,        &amp;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;           2.48923381004595156d-05,     2.80340509574146325d-05,        &amp;</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;           3.03987774629861915d-05,     3.21156731406700616d-05/</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <span class="keyword">DATA</span> beta(151), beta(152), beta(153), beta(154), beta(155),       &amp;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;           beta(156), beta(157), beta(158), beta(159), beta(160),       &amp;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;           beta(161), beta(162), beta(163), beta(164), beta(165),       &amp;</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;           beta(166), beta(167), beta(168), beta(169), beta(170)/       &amp;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;          -1.80182191963885708d-03,    -2.43402962938042533d-03,        &amp;</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;          -1.83422663549856802d-03,    -7.62204596354009765d-04,        &amp;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;           2.39079475256927218d-04,     9.49266117176881141d-04,        &amp;</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;           1.34467449701540359d-03,     1.48457495259449178d-03,        &amp;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;           1.44732339830617591d-03,     1.30268261285657186d-03,        &amp;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;           1.10351597375642682d-03,     8.86047440419791759d-04,        &amp;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;           6.73073208165665473d-04,     4.77603872856582378d-04,        &amp;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;           3.05991926358789362d-04,     1.60315694594721630d-04,        &amp;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;           4.00749555270613286d-05,    -5.66607461635251611d-05,        &amp;</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;          -1.32506186772982638d-04,    -1.90296187989614057d-04/</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      <span class="keyword">DATA</span> beta(171), beta(172), beta(173), beta(174), beta(175),       &amp;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;           beta(176), beta(177), beta(178), beta(179), beta(180),       &amp;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;           beta(181), beta(182), beta(183), beta(184), beta(185),       &amp;</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;           beta(186), beta(187), beta(188), beta(189), beta(190)/       &amp;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;          -2.32811450376937408d-04,    -2.62628811464668841d-04,        &amp;</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;          -2.82050469867598672d-04,    -2.93081563192861167d-04,        &amp;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;          -2.97435962176316616d-04,    -2.96557334239348078d-04,        &amp;</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;          -2.91647363312090861d-04,    -2.83696203837734166d-04,        &amp;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;          -2.73512317095673346d-04,    -2.61750155806768580d-04,        &amp;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;           6.38585891212050914d-03,     9.62374215806377941d-03,        &amp;</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;           7.61878061207001043d-03,     2.83219055545628054d-03,        &amp;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;          -2.09841352012720090d-03,    -5.73826764216626498d-03,        &amp;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;          -7.70804244495414620d-03,    -8.21011692264844401d-03,        &amp;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;          -7.65824520346905413d-03,    -6.47209729391045177d-03/</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="keyword">DATA</span> beta(191), beta(192), beta(193), beta(194), beta(195),       &amp;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;           beta(196), beta(197), beta(198), beta(199), beta(200),       &amp;</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;           beta(201), beta(202), beta(203), beta(204), beta(205),       &amp;</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;           beta(206), beta(207), beta(208), beta(209), beta(210)/       &amp;</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;          -4.99132412004966473d-03,    -3.45612289713133280d-03,        &amp;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;          -2.01785580014170775d-03,    -7.59430686781961401d-04,        &amp;</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;           2.84173631523859138d-04,     1.10891667586337403d-03,        &amp;</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;           1.72901493872728771d-03,     2.16812590802684701d-03,        &amp;</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;           2.45357710494539735d-03,     2.61281821058334862d-03,        &amp;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;           2.67141039656276912d-03,     2.65203073395980430d-03,        &amp;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;           2.57411652877287315d-03,     2.45389126236094427d-03,        &amp;</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;           2.30460058071795494d-03,     2.13684837686712662d-03,        &amp;</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;           1.95896528478870911d-03,     1.77737008679454412d-03,        &amp;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;           1.59690280765839059d-03,     1.42111975664438546d-03/</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <span class="keyword">DATA</span> gama(1), gama(2), gama(3), gama(4), gama(5), gama(6),        &amp;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;           gama(7), gama(8), gama(9), gama(10), gama(11), gama(12),     &amp;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;           gama(13), gama(14), gama(15), gama(16), gama(17), gama(18),  &amp;</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;           gama(19), gama(20), gama(21), gama(22)/                      &amp;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;           6.29960524947436582d-01,     2.51984209978974633d-01,        &amp;</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;           1.54790300415655846d-01,     1.10713062416159013d-01,        &amp;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;           8.57309395527394825d-02,     6.97161316958684292d-02,        &amp;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;           5.86085671893713576d-02,     5.04698873536310685d-02,        &amp;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;           4.42600580689154809d-02,     3.93720661543509966d-02,        &amp;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;           3.54283195924455368d-02,     3.21818857502098231d-02,        &amp;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;           2.94646240791157679d-02,     2.71581677112934479d-02,        &amp;</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;           2.51768272973861779d-02,     2.34570755306078891d-02,        &amp;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;           2.19508390134907203d-02,     2.06210828235646240d-02,        &amp;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;           1.94388240897880846d-02,     1.83810633800683158d-02,        &amp;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;           1.74293213231963172d-02,     1.65685837786612353d-02/</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <span class="keyword">DATA</span> gama(23), gama(24), gama(25), gama(26), gama(27), gama(28),  &amp;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;           gama(29), gama(30)/                                          &amp;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;           1.57865285987918445d-02,     1.50729501494095594d-02,        &amp;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;           1.44193250839954639d-02,     1.38184805735341786d-02,        &amp;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;           1.32643378994276568d-02,     1.27517121970498651d-02,        &amp;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;           1.22761545318762767d-02,     1.18338262398482403d-02/</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      <span class="keyword">DATA</span> ex1, ex2, hpi, gpi, thpi /                                   &amp;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;           3.33333333333333333d-01,     6.66666666666666667d-01,        &amp;</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;           1.57079632679489662d+00,     3.14159265358979324d+00,        &amp;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;           4.71238898038468986d+00/</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi,coner,conei / 0.0d0, 0.0d0, 1.0d0, 0.0d0 /</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;      rfnu = 1.0d0/fnu</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      zbr = zr*rfnu</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      zbi = zi*rfnu</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      rfnu2 = rfnu*rfnu</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">!     COMPUTE IN THE FOURTH QUADRANT</span></div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      fn13 = fnu**ex1</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      fn23 = fn13*fn13</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      rfn13 = 1.0d0/fn13</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      w2r = coner - zbr*zbr + zbi*zbi</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      w2i = conei - zbr*zbi - zbr*zbi</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      aw2 = zabs(w2r,w2i)</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <span class="keywordflow">IF</span> (aw2.GT.0.25d0) <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">!     POWER SERIES FOR CABS(W2).LE.0.25D0</span></div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      k = 1</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      pr(1) = coner</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      pi(1) = conei</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      sumar = gama(1)</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      sumai = zeroi</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      ap(1) = 1.0d0</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="keywordflow">IF</span> (aw2.LT.tol) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;      <span class="keywordflow">DO</span> 10 k=2,30</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        pr(k) = pr(k-1)*w2r - pi(k-1)*w2i</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;        pi(k) = pr(k-1)*w2i + pi(k-1)*w2r</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        sumar = sumar + pr(k)*gama(k)</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        sumai = sumai + pi(k)*gama(k)</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        ap(k) = ap(k-1)*aw2</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        <span class="keywordflow">IF</span> (ap(k).LT.tol) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      k = 30</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      kmax = k</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      zetar = w2r*sumar - w2i*sumai</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;      zetai = w2r*sumai + w2i*sumar</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      argr = zetar*fn23</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      argi = zetai*fn23</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      <span class="keyword">CALL </span>zsqrt(sumar, sumai, zar, zai)</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="keyword">CALL </span>zsqrt(w2r, w2i, str, sti)</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      zeta2r = str*fnu</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      zeta2i = sti*fnu</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      str = coner + ex2*(zetar*zar-zetai*zai)</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;      sti = conei + ex2*(zetar*zai+zetai*zar)</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;      zeta1r = str*zeta2r - sti*zeta2i</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      zeta1i = str*zeta2i + sti*zeta2r</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      zar = zar + zar</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      zai = zai + zai</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keyword">CALL </span>zsqrt(zar, zai, str, sti)</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      phir = str*rfn13</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      phii = sti*rfn13</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keywordflow">IF</span> (ipmtr.EQ.1) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">!     SUM SERIES FOR ASUM AND BSUM</span></div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      sumbr = zeror</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      sumbi = zeroi</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <span class="keywordflow">DO</span> 30 k=1,kmax</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        sumbr = sumbr + pr(k)*beta(k)</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        sumbi = sumbi + pi(k)*beta(k)</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      asumr = zeror</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      asumi = zeroi</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      bsumr = sumbr</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      bsumi = sumbi</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      l1 = 0</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      l2 = 30</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      btol = tol*(dabs(bsumr)+dabs(bsumi))</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      atol = tol</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      pp = 1.0d0</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      ias = 0</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      ibs = 0</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;      <span class="keywordflow">IF</span> (rfnu2.LT.tol) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      <span class="keywordflow">DO</span> 100 is=2,7</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        atol = atol/rfnu2</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        pp = pp*rfnu2</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        <span class="keywordflow">IF</span> (ias.EQ.1) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        sumar = zeror</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        sumai = zeroi</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;        <span class="keywordflow">DO</span> 40 k=1,kmax</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;          m = l1 + k</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;          sumar = sumar + pr(k)*alfa(m)</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;          sumai = sumai + pi(k)*alfa(m)</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;          <span class="keywordflow">IF</span> (ap(k).LT.atol) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;   40   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        asumr = asumr + sumar*pp</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        asumi = asumi + sumai*pp</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        <span class="keywordflow">IF</span> (pp.LT.tol) ias = 1</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;   60   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        <span class="keywordflow">IF</span> (ibs.EQ.1) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        sumbr = zeror</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        sumbi = zeroi</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="keywordflow">DO</span> 70 k=1,kmax</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;          m = l2 + k</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;          sumbr = sumbr + pr(k)*beta(m)</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;          sumbi = sumbi + pi(k)*beta(m)</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;          <span class="keywordflow">IF</span> (ap(k).LT.atol) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;   70   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;   80   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        bsumr = bsumr + sumbr*pp</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        bsumi = bsumi + sumbi*pp</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        <span class="keywordflow">IF</span> (pp.LT.btol) ibs = 1</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;   90   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;        <span class="keywordflow">IF</span> (ias.EQ.1 .AND. ibs.EQ.1) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        l1 = l1 + 30</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        l2 = l2 + 30</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      asumr = asumr + coner</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      pp = rfnu*rfn13</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      bsumr = bsumr*pp</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      bsumi = bsumi*pp</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="comment">!     CABS(W2).GT.0.25D0</span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;      <span class="keyword">CALL </span>zsqrt(w2r, w2i, wr, wi)</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      <span class="keywordflow">IF</span> (wr.LT.0.0d0) wr = 0.0d0</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;      <span class="keywordflow">IF</span> (wi.LT.0.0d0) wi = 0.0d0</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      str = coner + wr</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      sti = wi</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;      <span class="keyword">CALL </span>zdiv(str, sti, zbr, zbi, zar, zai)</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      <span class="keyword">CALL </span>zlog(zar, zai, zcr, zci, idum)</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;      <span class="keywordflow">IF</span> (zci.LT.0.0d0) zci = 0.0d0</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;      <span class="keywordflow">IF</span> (zci.GT.hpi) zci = hpi</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;      <span class="keywordflow">IF</span> (zcr.LT.0.0d0) zcr = 0.0d0</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      zthr = (zcr-wr)*1.5d0</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      zthi = (zci-wi)*1.5d0</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      zeta1r = zcr*fnu</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      zeta1i = zci*fnu</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      zeta2r = wr*fnu</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      zeta2i = wi*fnu</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      azth = zabs(zthr,zthi)</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      ang = thpi</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      <span class="keywordflow">IF</span> (zthr.GE.0.0d0 .AND. zthi.LT.0.0d0) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      ang = hpi</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      <span class="keywordflow">IF</span> (zthr.EQ.0.0d0) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      ang = datan(zthi/zthr)</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="keywordflow">IF</span> (zthr.LT.0.0d0) ang = ang + gpi</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      pp = azth**ex2</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      ang = ang*ex2</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      zetar = pp*dcos(ang)</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      zetai = pp*dsin(ang)</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <span class="keywordflow">IF</span> (zetai.LT.0.0d0) zetai = 0.0d0</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      argr = zetar*fn23</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      argi = zetai*fn23</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <span class="keyword">CALL </span>zdiv(zthr, zthi, zetar, zetai, rtztr, rtzti)</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <span class="keyword">CALL </span>zdiv(rtztr, rtzti, wr, wi, zar, zai)</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      tzar = zar + zar</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      tzai = zai + zai</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      <span class="keyword">CALL </span>zsqrt(tzar, tzai, str, sti)</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      phir = str*rfn13</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      phii = sti*rfn13</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <span class="keywordflow">IF</span> (ipmtr.EQ.1) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      raw = 1.0d0/dsqrt(aw2)</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      str = wr*raw</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      sti = -wi*raw</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      tfnr = str*rfnu*raw</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      tfni = sti*rfnu*raw</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      razth = 1.0d0/azth</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;      str = zthr*razth</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      sti = -zthi*razth</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      rzthr = str*razth*rfnu</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      rzthi = sti*razth*rfnu</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      zcr = rzthr*ar(2)</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      zci = rzthi*ar(2)</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      raw2 = 1.0d0/aw2</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      str = w2r*raw2</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      sti = -w2i*raw2</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      t2r = str*raw2</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      t2i = sti*raw2</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      str = t2r*c(2) + c(3)</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      sti = t2i*c(2)</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      upr(2) = str*tfnr - sti*tfni</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      upi(2) = str*tfni + sti*tfnr</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      bsumr = upr(2) + zcr</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      bsumi = upi(2) + zci</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      asumr = zeror</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      asumi = zeroi</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <span class="keywordflow">IF</span> (rfnu.LT.tol) <span class="keywordflow">GO TO</span> 220</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      przthr = rzthr</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      przthi = rzthi</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      ptfnr = tfnr</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      ptfni = tfni</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      upr(1) = coner</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      upi(1) = conei</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;      pp = 1.0d0</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      btol = tol*(dabs(bsumr)+dabs(bsumi))</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      ks = 0</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      kp1 = 2</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;      l = 3</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      ias = 0</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      ibs = 0</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <span class="keywordflow">DO</span> 210 lr=2,12,2</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;        lrp1 = lr + 1</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="comment">!     COMPUTE TWO ADDITIONAL CR, DR, AND UP FOR TWO MORE TERMS IN</span></div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="comment">!     NEXT SUMA AND SUMB</span></div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;        <span class="keywordflow">DO</span> 160 k=lr,lrp1</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;          ks = ks + 1</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;          kp1 = kp1 + 1</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;          l = l + 1</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;          zar = c(l)</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;          zai = zeroi</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;          <span class="keywordflow">DO</span> 150 j=2,kp1</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            l = l + 1</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            str = zar*t2r - t2i*zai + c(l)</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;            zai = zar*t2i + zai*t2r</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;            zar = str</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  150     <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;          str = ptfnr*tfnr - ptfni*tfni</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;          ptfni = ptfnr*tfni + ptfni*tfnr</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;          ptfnr = str</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;          upr(kp1) = ptfnr*zar - ptfni*zai</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;          upi(kp1) = ptfni*zar + ptfnr*zai</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;          crr(ks) = przthr*br(ks+1)</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;          cri(ks) = przthi*br(ks+1)</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;          str = przthr*rzthr - przthi*rzthi</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;          przthi = przthr*rzthi + przthi*rzthr</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;          przthr = str</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;          drr(ks) = przthr*ar(ks+2)</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;          dri(ks) = przthi*ar(ks+2)</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  160   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        pp = pp*rfnu2</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        <span class="keywordflow">IF</span> (ias.EQ.1) <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;        sumar = upr(lrp1)</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;        sumai = upi(lrp1)</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;        ju = lrp1</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        <span class="keywordflow">DO</span> 170 jr=1,lr</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;          ju = ju - 1</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;          sumar = sumar + crr(jr)*upr(ju) - cri(jr)*upi(ju)</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;          sumai = sumai + crr(jr)*upi(ju) + cri(jr)*upr(ju)</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  170   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;        asumr = asumr + sumar</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;        asumi = asumi + sumai</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;        test = dabs(sumar) + dabs(sumai)</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;        <span class="keywordflow">IF</span> (pp.LT.tol .AND. test.LT.tol) ias = 1</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  180   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        <span class="keywordflow">IF</span> (ibs.EQ.1) <span class="keywordflow">GO TO</span> 200</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        sumbr = upr(lr+2) + upr(lrp1)*zcr - upi(lrp1)*zci</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        sumbi = upi(lr+2) + upr(lrp1)*zci + upi(lrp1)*zcr</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        ju = lrp1</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <span class="keywordflow">DO</span> 190 jr=1,lr</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;          ju = ju - 1</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;          sumbr = sumbr + drr(jr)*upr(ju) - dri(jr)*upi(ju)</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;          sumbi = sumbi + drr(jr)*upi(ju) + dri(jr)*upr(ju)</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  190   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        bsumr = bsumr + sumbr</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        bsumi = bsumi + sumbi</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        test = dabs(sumbr) + dabs(sumbi)</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <span class="keywordflow">IF</span> (pp.LT.btol .AND. test.LT.btol) ibs = 1</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;  200   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <span class="keywordflow">IF</span> (ias.EQ.1 .AND. ibs.EQ.1) <span class="keywordflow">GO TO</span> 220</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;  210 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;  220 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      asumr = asumr + coner</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      str = -bsumr*rfn13</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      sti = -bsumi*rfn13</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;      <span class="keyword">CALL </span>zdiv(str, sti, rtztr, rtzti, bsumr, bsumi)</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="keyword">SUBROUTINE </span>zrati(ZR, ZI, FNU, N, CYR, CYI, TOL)</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZRATI</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment">!***REFER TO  ZBESI,ZBESK,ZBESH</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">!     ZRATI COMPUTES RATIOS OF I BESSEL FUNCTIONS BY BACKWARD</span></div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment">!     RECURRENCE.  THE STARTING INDEX IS DETERMINED BY FORWARD</span></div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment">!     RECURRENCE AS DESCRIBED IN J. RES. OF NAT. BUR. OF STANDARDS-B,</span></div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="comment">!     MATHEMATICAL SCIENCES, VOL 77B, P111-114, SEPTEMBER, 1973,</span></div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment">!     BESSEL FUNCTIONS I AND J OF COMPLEX ARGUMENT AND INTEGER ORDER,</span></div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="comment">!     BY D. J. SOOKNE.</span></div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;<span class="comment">!***ROUTINES CALLED  ZABS,ZDIV</span></div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="comment">!***END PROLOGUE  ZRATI</span></div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;<span class="comment">!     COMPLEX Z,CY(1),CONE,CZERO,P1,P2,T1,RZ,PT,CDFNU</span></div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> ak, amagz, ap1, ap2, arg, az, cdfnui, cdfnur, &amp;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      conei, coner, cyi, cyr, czeroi, czeror, dfnu, fdnu, flam, fnu, &amp;</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      fnup, pti, ptr, p1i, p1r, p2i, p2r, rak, rap1, rho, rt2, rzi,  &amp;</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      rzr, test, test1, tol, tti, ttr, t1i, t1r, zi, zr</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keywordtype">INTEGER</span> i, id, idnu, inu, itime, k, kk, magz, n</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      dimension cyr(1), cyi(1)</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      <span class="keyword">DATA</span> czeror,czeroi,coner,conei,rt2  &amp;</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      /0.0d0, 0.0d0, 1.0d0, 0.0d0, 1.41421356237309505d0/</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      inu = int(sngl(fnu))</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      idnu = inu + n - 1</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      magz = int(sngl(az))</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      amagz = dble(float(magz+1))</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      fdnu = dble(float(idnu))</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      fnup = dmax1(amagz,fdnu)</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      id = idnu - magz - 1</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      itime = 1</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      k = 1</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      ptr = 1.0d0/az</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      rzr = ptr*(zr+zr)*ptr</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      rzi = -ptr*(zi+zi)*ptr</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      t1r = rzr*fnup</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      t1i = rzi*fnup</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      p2r = -t1r</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      p2i = -t1i</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      p1r = coner</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      p1i = conei</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      t1r = t1r + rzr</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      t1i = t1i + rzi</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <span class="keywordflow">IF</span> (id.GT.0) id = 0</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      ap2 = zabs(p2r,p2i)</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      ap1 = zabs(p1r,p1i)</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="comment">!     THE OVERFLOW TEST ON K(FNU+I-1,Z) BEFORE THE CALL TO CBKNU</span></div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="comment">!     GUARANTEES THAT P2 IS ON SCALE. SCALE TEST1 AND ALL SUBSEQUENT</span></div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;<span class="comment">!     P2 VALUES BY AP1 TO ENSURE THAT AN OVERFLOW DOES NOT OCCUR</span></div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment">!     PREMATURELY.</span></div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;      arg = (ap2+ap2)/(ap1*tol)</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      test1 = dsqrt(arg)</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;      test = test1</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;      rap1 = 1.0d0/ap1</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      p1r = p1r*rap1</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      p1i = p1i*rap1</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;      p2r = p2r*rap1</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;      p2i = p2i*rap1</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      ap2 = ap2*rap1</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;      k = k + 1</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;      ap1 = ap2</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      ptr = p2r</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      pti = p2i</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      p2r = p1r - (t1r*ptr-t1i*pti)</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      p2i = p1i - (t1r*pti+t1i*ptr)</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      p1r = ptr</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;      p1i = pti</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;      t1r = t1r + rzr</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      t1i = t1i + rzi</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      ap2 = zabs(p2r,p2i)</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;      <span class="keywordflow">IF</span> (ap1.LE.test) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;      <span class="keywordflow">IF</span> (itime.EQ.2) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;      ak = zabs(t1r,t1i)*0.5d0</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;      flam = ak + dsqrt(ak*ak-1.0d0)</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      rho = dmin1(ap2/ap1,flam)</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      test = test1*dsqrt(rho/(rho*rho-1.0d0))</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      itime = 2</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      kk = k + 1 - id</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      ak = dble(float(kk))</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      t1r = ak</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      t1i = czeroi</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      dfnu = fnu + dble(float(n-1))</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      p1r = 1.0d0/ap2</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      p1i = czeroi</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      p2r = czeror</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      p2i = czeroi</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;      <span class="keywordflow">DO</span> 30 i=1,kk</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        ptr = p1r</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;        pti = p1i</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        rap1 = dfnu + t1r</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;        ttr = rzr*rap1</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;        tti = rzi*rap1</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;        p1r = (ptr*ttr-pti*tti) + p2r</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;        p1i = (ptr*tti+pti*ttr) + p2i</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;        p2r = ptr</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        p2i = pti</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        t1r = t1r - coner</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <span class="keywordflow">IF</span> (p1r.NE.czeror .OR. p1i.NE.czeroi) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      p1r = tol</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      p1i = tol</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      <span class="keyword">CALL </span>zdiv(p2r, p2i, p1r, p1i, cyr(n), cyi(n))</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <span class="keywordflow">IF</span> (n.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      k = n - 1</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      ak = dble(float(k))</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      t1r = ak</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      t1i = czeroi</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      cdfnur = fnu*rzr</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      cdfnui = fnu*rzi</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      <span class="keywordflow">DO</span> 60 i=2,n</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        ptr = cdfnur + (t1r*rzr-t1i*rzi) + cyr(k+1)</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        pti = cdfnui + (t1r*rzi+t1i*rzr) + cyi(k+1)</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        ak = zabs(ptr,pti)</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        <span class="keywordflow">IF</span> (ak.NE.czeror) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        ptr = tol</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        pti = tol</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        ak = tol*rt2</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;   50   <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;        rak = coner/ak</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        cyr(k) = rak*ptr*rak</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        cyi(k) = -rak*pti*rak</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;        t1r = t1r - coner</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        k = k - 1</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;<span class="keyword">SUBROUTINE </span>zairy(ZR, ZI, ID, KODE, AIR, AII, NZ, IERR)</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZAIRY</span></div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="comment">!***DATE WRITTEN   830501   (YYMMDD)</span></div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="comment">!***REVISION DATE  830501   (YYMMDD)</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;<span class="comment">!***CATEGORY NO.  B5K</span></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="comment">!***KEYWORDS  AIRY FUNCTION,BESSEL FUNCTIONS OF ORDER ONE THIRD</span></div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="comment">!***AUTHOR  AMOS, DONALD E., SANDIA NATIONAL LABORATORIES</span></div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="comment">!***PURPOSE  TO COMPUTE AIRY FUNCTIONS AI(Z) AND DAI(Z) FOR COMPLEX Z</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;<span class="comment">!***DESCRIPTION</span></div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;<span class="comment">!                      ***A DOUBLE PRECISION ROUTINE***</span></div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="comment">!         ON KODE=1, ZAIRY COMPUTES THE COMPLEX AIRY FUNCTION AI(Z) OR</span></div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="comment">!         ITS DERIVATIVE DAI(Z)/DZ ON ID=0 OR ID=1 RESPECTIVELY. ON</span></div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="comment">!         KODE=2, A SCALING OPTION CEXP(ZTA)*AI(Z) OR CEXP(ZTA)*</span></div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">!         DAI(Z)/DZ IS PROVIDED TO REMOVE THE EXPONENTIAL DECAY IN</span></div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">!         -PI/3.LT.ARG(Z).LT.PI/3 AND THE EXPONENTIAL GROWTH IN</span></div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">!         PI/3.LT.ABS(ARG(Z)).LT.PI WHERE ZTA=(2/3)*Z*CSQRT(Z).</span></div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="comment">!         WHILE THE AIRY FUNCTIONS AI(Z) AND DAI(Z)/DZ ARE ANALYTI! IN</span></div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">!         THE WHOLE Z PLANE, THE CORRESPONDING SCALED FUNCTIONS DEFINED</span></div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="comment">!         FOR KODE=2 HAVE A CUT ALONG THE NEGATIVE REAL AXIS.</span></div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="comment">!         DEFINTIONS AND NOTATION ARE FOUND IN THE NBS HANDBOOK OF</span></div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="comment">!         MATHEMATICAL FUNCTIONS (REF. 1).</span></div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="comment">!         INPUT      ZR,ZI ARE DOUBLE PRECISION</span></div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="comment">!           ZR,ZI  - Z=CMPLX(ZR,ZI)</span></div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="comment">!           ID     - ORDER OF DERIVATIVE, ID=0 OR ID=1</span></div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;<span class="comment">!           KODE   - A PARAMETER TO INDICATE THE SCALING OPTION</span></div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;<span class="comment">!                    KODE= 1  RETURNS</span></div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="comment">!                             AI=AI(Z)                ON ID=0 OR</span></div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;<span class="comment">!                             AI=DAI(Z)/DZ            ON ID=1</span></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;<span class="comment">!                        = 2  RETURNS</span></div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;<span class="comment">!                             AI=CEXP(ZTA)*AI(Z)       ON ID=0 OR</span></div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">!                             AI=CEXP(ZTA)*DAI(Z)/DZ   ON ID=1 WHERE</span></div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="comment">!                             ZTA=(2/3)*Z*CSQRT(Z)</span></div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="comment">!         OUTPUT     AIR,AII ARE DOUBLE PRECISION</span></div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;<span class="comment">!           AIR,AII- COMPLEX ANSWER DEPENDING ON THE CHOICES FOR ID AND</span></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="comment">!                    KODE</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="comment">!           NZ     - UNDERFLOW INDICATOR</span></div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="comment">!                    NZ= 0   , NORMAL RETURN</span></div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;<span class="comment">!                    NZ= 1   , AI=CMPLX(0.0D0,0.0D0) DUE TO UNDERFLOW IN</span></div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="comment">!                              -PI/3.LT.ARG(Z).LT.PI/3 ON KODE=1</span></div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="comment">!           IERR   - ERROR FLAG</span></div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="comment">!                    IERR=0, NORMAL RETURN - COMPUTATION COMPLETED</span></div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="comment">!                    IERR=1, INPUT ERROR   - NO COMPUTATION</span></div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment">!                    IERR=2, OVERFLOW      - NO COMPUTATION, REAL(ZTA)</span></div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="comment">!                            TOO LARGE ON KODE=1</span></div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="comment">!                    IERR=3, CABS(Z) LARGE      - COMPUTATION COMPLETED</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="comment">!                            LOSSES OF SIGNIFCANCE BY ARGUMENT REDUCTION</span></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment">!                            PRODUCE LESS THAN HALF OF MACHINE ACCURACY</span></div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment">!                    IERR=4, CABS(Z) TOO LARGE  - NO COMPUTATION</span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">!                            COMPLETE LOSS OF ACCURACY BY ARGUMENT</span></div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="comment">!                            REDUCTION</span></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">!                    IERR=5, ERROR              - NO COMPUTATION,</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">!                            ALGORITHM TERMINATION CONDITION NOT MET</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;<span class="comment">!***LONG DESCRIPTION</span></div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment">!         AI AND DAI ARE COMPUTED FOR CABS(Z).GT.1.0 FROM THE K BESSEL</span></div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="comment">!         FUNCTIONS BY</span></div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="comment">!            AI(Z)=C*SQRT(Z)*K(1/3,ZTA) , DAI(Z)=-C*Z*K(2/3,ZTA)</span></div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment">!                           C=1.0/(PI*SQRT(3.0))</span></div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">!                            ZTA=(2/3)*Z**(3/2)</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="comment">!         WITH THE POWER SERIES FOR CABS(Z).LE.1.0.</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="comment">!         IN MOST COMPLEX VARIABLE COMPUTATION, ONE MUST EVALUATE ELE-</span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">!         MENTARY FUNCTIONS. WHEN THE MAGNITUDE OF Z IS LARGE, LOSSES</span></div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">!         OF SIGNIFICANCE BY ARGUMENT REDUCTION OCCUR. CONSEQUENTLY, IF</span></div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="comment">!         THE MAGNITUDE OF ZETA=(2/3)*Z**1.5 EXCEEDS U1=SQRT(0.5/UR),</span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="comment">!         THEN LOSSES EXCEEDING HALF PRECISION ARE LIKELY AND AN ERROR</span></div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="comment">!         FLAG IERR=3 IS TRIGGERED WHERE UR=DMAX1(D1MACH(4),1.0D-18) IS</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment">!         DOUBLE PRECISION UNIT ROUNDOFF LIMITED TO 18 DIGITS PRECISION.</span></div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="comment">!         ALSO, IF THE MAGNITUDE OF ZETA IS LARGER THAN U2=0.5/UR, THEN</span></div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="comment">!         ALL SIGNIFICANCE IS LOST AND IERR=4. IN ORDER TO USE THE INT</span></div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="comment">!         FUNCTION, ZETA MUST BE FURTHER RESTRICTED NOT TO EXCEED THE</span></div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="comment">!         LARGEST INTEGER, U3=I1MACH(9). THUS, THE MAGNITUDE OF ZETA</span></div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="comment">!         MUST BE RESTRICTED BY MIN(U2,U3). ON 32 BIT MACHINES, U1,U2,</span></div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="comment">!         AND U3 ARE APPROXIMATELY 2.0E+3, 4.2E+6, 2.1E+9 IN SINGLE</span></div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="comment">!         PRECISION ARITHMETIC AND 1.3E+8, 1.8E+16, 2.1E+9 IN DOUBLE</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="comment">!         PRECISION ARITHMETIC RESPECTIVELY. THIS MAKES U2 AND U3 LIMIT-</span></div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="comment">!         ING IN THEIR RESPECTIVE ARITHMETICS. THIS MEANS THAT THE MAG-</span></div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="comment">!         NITUDE OF Z CANNOT EXCEED 3.1E+4 IN SINGLE AND 2.1E+6 IN</span></div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="comment">!         DOUBLE PRECISION ARITHMETIC. THIS ALSO MEANS THAT ONE CAN</span></div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="comment">!         EXPECT TO RETAIN, IN THE WORST CASES ON 32 BIT MACHINES,</span></div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="comment">!         NO DIGITS IN SINGLE PRECISION AND ONLY 7 DIGITS IN DOUBLE</span></div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;<span class="comment">!         PRECISION ARITHMETIC. SIMILAR CONSIDERATIONS HOLD FOR OTHER</span></div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="comment">!         MACHINES.</span></div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="comment">!         THE APPROXIMATE RELATIVE ERROR IN THE MAGNITUDE OF A COMPLEX</span></div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="comment">!         BESSEL FUNCTION CAN BE EXPRESSED BY P*10**S WHERE P=MAX(UNIT</span></div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="comment">!         ROUNDOFF,1.0E-18) IS THE NOMINAL PRECISION AND 10**S REPRE-</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="comment">!         SENTS THE INCREASE IN ERROR DUE TO ARGUMENT REDUCTION IN THE</span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="comment">!         ELEMENTARY FUNCTIONS. HERE, S=MAX(1,ABS(LOG10(CABS(Z))),</span></div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="comment">!         ABS(LOG10(FNU))) APPROXIMATELY (I.E. S=MAX(1,ABS(EXPONENT OF</span></div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment">!         CABS(Z),ABS(EXPONENT OF FNU)) ). HOWEVER, THE PHASE ANGLE MAY</span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="comment">!         HAVE ONLY ABSOLUTE ACCURACY. THIS IS MOST LIKELY TO OCCUR WHEN</span></div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="comment">!         ONE COMPONENT (IN ABSOLUTE VALUE) IS LARGER THAN THE OTHER BY</span></div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="comment">!         SEVERAL ORDERS OF MAGNITUDE. IF ONE COMPONENT IS 10**K LARGER</span></div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="comment">!         THAN THE OTHER, THEN ONE CAN EXPECT ONLY MAX(ABS(LOG10(P))-K,</span></div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="comment">!         0) SIGNIFICANT DIGITS; OR, STATED ANOTHER WAY, WHEN K EXCEEDS</span></div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="comment">!         THE EXPONENT OF P, NO SIGNIFICANT DIGITS REMAIN IN THE SMALLER</span></div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="comment">!         COMPONENT. HOWEVER, THE PHASE ANGLE RETAINS ABSOLUTE ACCURACY</span></div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">!         BECAUSE, IN COMPLEX ARITHMETIC WITH PRECISION P, THE SMALLER</span></div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="comment">!         COMPONENT WILL NOT (AS A RULE) DECREASE BELOW P TIMES THE</span></div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">!         MAGNITUDE OF THE LARGER COMPONENT. IN THESE EXTREME CASES,</span></div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="comment">!         THE PRINCIPAL PHASE ANGLE IS ON THE ORDER OF +P, -P, PI/2-P,</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment">!         OR -PI/2+P.</span></div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment">!***REFERENCES  HANDBOOK OF MATHEMATICAL FUNCTIONS BY M. ABRAMOWITZ</span></div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="comment">!                 AND I. A. STEGUN, NBS AMS SERIES 55, U.S. DEPT. OF</span></div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="comment">!                 COMMERCE, 1955.</span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment">!               COMPUTATION OF BESSEL FUNCTIONS OF COMPLEX ARGUMENT</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment">!                 AND LARGE ORDER BY D. E. AMOS, SAND83-0643, MAY, 1983</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="comment">!               A SUBROUTINE PACKAGE FOR BESSEL FUNCTIONS OF A COMPLEX</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="comment">!                 ARGUMENT AND NONNEGATIVE ORDER BY D. E. AMOS, SAND85-</span></div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment">!                 1018, MAY, 1985</span></div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="comment">!               A PORTABLE PACKAGE FOR BESSEL FUNCTIONS OF A COMPLEX</span></div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="comment">!                 ARGUMENT AND NONNEGATIVE ORDER BY D. E. AMOS, TRANS.</span></div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="comment">!                 MATH. SOFTWARE, 1986</span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="comment">!***ROUTINES CALLED  ZACAI,ZBKNU,ZEXP,ZSQRT,I1MACH,D1MACH</span></div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment">!***END PROLOGUE  ZAIRY</span></div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">!     COMPLEX AI,CONE,CSQ,CY,S1,S2,TRM1,TRM2,Z,ZTA,Z3</span></div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, ad, aii, air, ak, alim, atrm, az, az3, bk,  &amp;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;      cc, ck, coef, conei, coner, csqi, csqr, cyi, cyr, c1, c2, dig,   &amp;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      dk, d1, d2, elim, fid, fnu, ptr, rl, r1m5, sfac, sti, str,       &amp;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;      s1i, s1r, s2i, s2r, tol, trm1i, trm1r, trm2i, trm2r, tth, zeroi, &amp;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      zeror, zi, zr, ztai, ztar, z3i, z3r, alaz, bb</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      <span class="keywordtype">INTEGER</span> id, ierr, iflag, k, kode, k1, k2, mr, nn, nz</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      dimension cyr(1), cyi(1)</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      <span class="keyword">DATA</span> tth, c1, c2, coef /6.66666666666666667d-01, &amp;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      3.55028053887817240d-01,2.58819403792806799d-01, &amp;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      1.83776298473930683d-01/</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      <span class="keyword">DATA</span> zeror, zeroi, coner, conei /0.0d0,0.0d0,1.0d0,0.0d0/</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;<span class="comment">!***FIRST EXECUTABLE STATEMENT  ZAIRY</span></div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      ierr = 0</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      nz=0</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      <span class="keywordflow">IF</span> (id.LT.0 .OR. id.GT.1) ierr=1</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      <span class="keywordflow">IF</span> (kode.LT.1 .OR. kode.GT.2) ierr=1</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      <span class="keywordflow">IF</span> (ierr.NE.0) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      tol = dmax1(d1mach(4),1.0d-18)</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      fid = dble(float(id))</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="keywordflow">IF</span> (az.GT.1.0d0) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="comment">!     POWER SERIES FOR CABS(Z).LE.1.</span></div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      s1r = coner</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;      s1i = conei</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;      s2r = coner</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      s2i = conei</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      <span class="keywordflow">IF</span> (az.LT.tol) <span class="keywordflow">GO TO</span> 170</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      aa = az*az</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;      <span class="keywordflow">IF</span> (aa.LT.tol/az) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      trm1r = coner</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      trm1i = conei</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      trm2r = coner</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;      trm2i = conei</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;      atrm = 1.0d0</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;      str = zr*zr - zi*zi</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;      sti = zr*zi + zi*zr</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      z3r = str*zr - sti*zi</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      z3i = str*zi + sti*zr</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      az3 = az*aa</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;      ak = 2.0d0 + fid</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;      bk = 3.0d0 - fid - fid</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      ck = 4.0d0 - fid</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      dk = 3.0d0 + fid + fid</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      d1 = ak*dk</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;      d2 = bk*ck</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      ad = dmin1(d1,d2)</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      ak = 24.0d0 + 9.0d0*fid</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      bk = 30.0d0 - 9.0d0*fid</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      <span class="keywordflow">DO</span> 30 k=1,25</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;        str = (trm1r*z3r-trm1i*z3i)/d1</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        trm1i = (trm1r*z3i+trm1i*z3r)/d1</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        trm1r = str</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        s1r = s1r + trm1r</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        s1i = s1i + trm1i</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        str = (trm2r*z3r-trm2i*z3i)/d2</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        trm2i = (trm2r*z3i+trm2i*z3r)/d2</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        trm2r = str</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        s2r = s2r + trm2r</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        s2i = s2i + trm2i</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        atrm = atrm*az3/ad</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;        d1 = d1 + ak</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        d2 = d2 + bk</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;        ad = dmin1(d1,d2)</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        <span class="keywordflow">IF</span> (atrm.LT.tol*ad) <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        ak = ak + 18.0d0</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;        bk = bk + 18.0d0</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      <span class="keywordflow">IF</span> (id.EQ.1) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      air = s1r*c1 - c2*(zr*s2r-zi*s2i)</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      aii = s1i*c1 - c2*(zr*s2i+zi*s2r)</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      <span class="keyword">CALL </span>zsqrt(zr, zi, str, sti)</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      ztar = tth*(zr*str-zi*sti)</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;      ztai = tth*(zr*sti+zi*str)</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      <span class="keyword">CALL </span>zexp(ztar, ztai, str, sti)</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;      ptr = air*str - aii*sti</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      aii = air*sti + aii*str</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;      air = ptr</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;      air = -s2r*c2</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      aii = -s2i*c2</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      <span class="keywordflow">IF</span> (az.LE.tol) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      str = zr*s1r - zi*s1i</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      sti = zr*s1i + zi*s1r</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      cc = c1/(1.0d0+fid)</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      air = air + cc*(str*zr-sti*zi)</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      aii = aii + cc*(str*zi+sti*zr)</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      <span class="keyword">CALL </span>zsqrt(zr, zi, str, sti)</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;      ztar = tth*(zr*str-zi*sti)</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;      ztai = tth*(zr*sti+zi*str)</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;      <span class="keyword">CALL </span>zexp(ztar, ztai, str, sti)</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      ptr = str*air - sti*aii</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;      aii = str*aii + sti*air</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;      air = ptr</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<span class="comment">!     CASE FOR CABS(Z).GT.1.0</span></div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      fnu = (1.0d0+fid)/3.0d0</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment">!     SET PARAMETERS RELATED TO MACHINE CONSTANTS.</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment">!     TOL IS THE APPROXIMATE UNIT ROUNDOFF LIMITED TO 1.0D-18.</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment">!     ELIM IS THE APPROXIMATE EXPONENTIAL OVER- AND UNDERFLOW LIMIT.</span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="comment">!     EXP(-ELIM).LT.EXP(-ALIM)=EXP(-ELIM)/TOL    AND</span></div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">!     EXP(ELIM).GT.EXP(ALIM)=EXP(ELIM)*TOL       ARE INTERVALS NEAR</span></div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">!     UNDERFLOW AND OVERFLOW LIMITS WHERE SCALED ARITHMETIC IS DONE.</span></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">!     RL IS THE LOWER BOUNDARY OF THE ASYMPTOTIC EXPANSION FOR LARGE Z.</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment">!     DIG = NUMBER OF BASE 10 DIGITS IN TOL = 10**(-DIG).</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;      k1 = i1mach(15)</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      k2 = i1mach(16)</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      r1m5 = d1mach(5)</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;      k = min0(iabs(k1),iabs(k2))</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      elim = 2.303d0*(dble(float(k))*r1m5-3.0d0)</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      k1 = i1mach(14) - 1</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      aa = r1m5*dble(float(k1))</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      dig = dmin1(aa,18.0d0)</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;      aa = aa*2.303d0</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      alim = elim + dmax1(-aa,-41.45d0)</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;      rl = 1.2d0*dig + 3.0d0</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      alaz = dlog(az)</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;<span class="comment">!     TEST FOR PROPER RANGE</span></div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      aa=0.5d0/tol</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      bb=dble(float(i1mach(9)))*0.5d0</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      aa=dmin1(aa,bb)</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      aa=aa**tth</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;      <span class="keywordflow">IF</span> (az.GT.aa) <span class="keywordflow">GO TO</span> 260</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;      aa=dsqrt(aa)</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <span class="keywordflow">IF</span> (az.GT.aa) ierr=3</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      <span class="keyword">CALL </span>zsqrt(zr, zi, csqr, csqi)</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;      ztar = tth*(zr*csqr-zi*csqi)</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      ztai = tth*(zr*csqi+zi*csqr)</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="comment">!     RE(ZTA).LE.0 WHEN RE(Z).LT.0, ESPECIALLY WHEN IM(Z) IS SMALL</span></div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;      iflag = 0</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;      sfac = 1.0d0</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;      ak = ztai</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;      <span class="keywordflow">IF</span> (zr.GE.0.0d0) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      bk = ztar</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      ck = -dabs(bk)</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      ztar = ck</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;      ztai = ak</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;      <span class="keywordflow">IF</span> (zi.NE.0.0d0) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      <span class="keywordflow">IF</span> (zr.GT.0.0d0) <span class="keywordflow">GO TO</span> 90</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;      ztar = 0.0d0</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      ztai = ak</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;   90 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      aa = ztar</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      <span class="keywordflow">IF</span> (aa.GE.0.0d0 .AND. zr.GT.0.0d0) <span class="keywordflow">GO TO</span> 110</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.2) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="comment">!     OVERFLOW TEST</span></div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <span class="keywordflow">IF</span> (aa.GT.(-alim)) <span class="keywordflow">GO TO</span> 100</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      aa = -aa + 0.25d0*alaz</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      iflag = 1</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;      sfac = tol</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      <span class="keywordflow">IF</span> (aa.GT.elim) <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  100 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;<span class="comment">!     CBKNU AND CACON RETURN EXP(ZTA)*K(FNU,ZTA) ON KODE=2</span></div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      mr = 1</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;      <span class="keywordflow">IF</span> (zi.LT.0.0d0) mr = -1</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      <span class="keyword">CALL </span>zacai(ztar, ztai, fnu, kode, mr, 1, cyr, cyi, nn, rl, tol, &amp;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;      elim, alim)</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;      <span class="keywordflow">IF</span> (nn.LT.0) <span class="keywordflow">GO TO</span> 280</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;      nz = nz + nn</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;      <span class="keywordflow">GO TO</span> 130</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  110 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.2) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="comment">!     UNDERFLOW TEST</span></div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;      <span class="keywordflow">IF</span> (aa.LT.alim) <span class="keywordflow">GO TO</span> 120</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;      aa = -aa - 0.25d0*alaz</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;      iflag = 2</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;      sfac = 1.0d0/tol</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;      <span class="keywordflow">IF</span> (aa.LT.(-elim)) <span class="keywordflow">GO TO</span> 210</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  120 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      <span class="keyword">CALL </span>zbknu(ztar, ztai, fnu, kode, 1, cyr, cyi, nz, tol, elim, alim)</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;  130 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      s1r = cyr(1)*coef</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      s1i = cyi(1)*coef</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      <span class="keywordflow">IF</span> (iflag.NE.0) <span class="keywordflow">GO TO</span> 150</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;      <span class="keywordflow">IF</span> (id.EQ.1) <span class="keywordflow">GO TO</span> 140</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;      air = csqr*s1r - csqi*s1i</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;      aii = csqr*s1i + csqi*s1r</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;  140 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      air = -(zr*s1r-zi*s1i)</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      aii = -(zr*s1i+zi*s1r)</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;  150 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;      s1r = s1r*sfac</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;      s1i = s1i*sfac</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;      <span class="keywordflow">IF</span> (id.EQ.1) <span class="keywordflow">GO TO</span> 160</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;      str = s1r*csqr - s1i*csqi</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;      s1i = s1r*csqi + s1i*csqr</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;      s1r = str</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;      air = s1r/sfac</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      aii = s1i/sfac</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  160 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;      str = -(s1r*zr-s1i*zi)</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;      s1i = -(s1r*zi+s1i*zr)</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      s1r = str</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      air = s1r/sfac</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;      aii = s1i/sfac</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  170 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      aa = 1.0d+3*d1mach(1)</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      s1r = zeror</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      s1i = zeroi</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;      <span class="keywordflow">IF</span> (id.EQ.1) <span class="keywordflow">GO TO</span> 190</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;      <span class="keywordflow">IF</span> (az.LE.aa) <span class="keywordflow">GO TO</span> 180</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;      s1r = c2*zr</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;      s1i = c2*zi</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  180 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      air = c1 - s1r</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      aii = -s1i</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;  190 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      air = -c2</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      aii = 0.0d0</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      aa = dsqrt(aa)</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      <span class="keywordflow">IF</span> (az.LE.aa) <span class="keywordflow">GO TO</span> 200</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;      s1r = 0.5d0*(zr*zr-zi*zi)</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;      s1i = zr*zi</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;  200 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      air = air + c1*s1r</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      aii = aii + c1*s1i</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  210 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;      nz = 1</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      air = zeror</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;      aii = zeroi</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  270 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;      nz = 0</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;      ierr=2</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  280 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;      <span class="keywordflow">IF</span>(nn.EQ.(-1)) <span class="keywordflow">GO TO</span> 270</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      nz=0</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      ierr=5</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  260 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      ierr=4</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      nz=0</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="keyword">SUBROUTINE </span>zacai(ZR, ZI, FNU, KODE, MR, N, YR, YI, NZ, RL, TOL, ELIM, ALIM)</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="keywordtype">USE </span>utilit</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZACAI</span></div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="comment">!***REFER TO  ZAIRY</span></div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;<span class="comment">!     ZACAI APPLIES THE ANALYTIC CONTINUATION FORMULA</span></div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment">!         K(FNU,ZN*EXP(MP))=K(FNU,ZN)*EXP(-MP*FNU) - MP*I(FNU,ZN)</span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">!                 MP=PI*MR*CMPLX(0.0,1.0)</span></div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="comment">!     TO CONTINUE THE K FUNCTION FROM THE RIGHT HALF TO THE LEFT</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment">!     HALF Z PLANE FOR USE WITH ZAIRY WHERE FNU=1/3 OR 2/3 AND N=1.</span></div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="comment">!     ZACAI IS THE SAME AS ZACON WITH THE PARTS FOR LARGER ORDERS AND</span></div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment">!     RECURRENCE REMOVED. A RECURSIVE CALL TO ZACON CAN RESULT IF ZACON</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="comment">!     IS CALLED FROM ZAIRY.</span></div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;<span class="comment">!***ROUTINES CALLED  ZASYI,ZBKNU,ZMLRI,ZSERI,ZS1S2,D1MACH,ZABS</span></div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="comment">!***END PROLOGUE  ZACAI</span></div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="comment">!     COMPLEX CSGN,CSPN,C1,C2,Y,Z,ZN,CY</span></div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> alim, arg, ascle, az, csgnr, csgni, cspnr,     &amp;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;      cspni, c1r, c1i, c2r, c2i, cyr, cyi, dfnu, elim, fmr, fnu, pi,  &amp;</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;      rl, <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a>, tol, yy, yr, yi, zr, zi, znr, zni</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      <span class="keywordtype">INTEGER</span> inu, iuf, kode, mr, n, nn, nw, nz</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      dimension yr(1), yi(1), cyr(2), cyi(2)</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      <span class="keyword">DATA</span> pi / 3.14159265358979324d0 /</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      nz = 0</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;      znr = -zr</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      zni = -zi</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      az = zabs(zr,zi)</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      nn = n</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;      dfnu = fnu + dble(float(n-1))</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;      <span class="keywordflow">IF</span> (az.LE.2.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;      <span class="keywordflow">IF</span> (az*az*0.25d0.GT.dfnu+1.0d0) <span class="keywordflow">GO TO</span> 20</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;<span class="comment">!     POWER SERIES FOR THE I FUNCTION</span></div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      <span class="keyword">CALL </span>zseri(znr, zni, fnu, kode, nn, yr, yi, nw, tol, elim, alim)</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;   20 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      <span class="keywordflow">IF</span> (az.LT.rl) <span class="keywordflow">GO TO</span> 30</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;<span class="comment">!     ASYMPTOTIC EXPANSION FOR LARGE Z FOR THE I FUNCTION</span></div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;      <span class="keyword">CALL </span>zasyi(znr, zni, fnu, kode, nn, yr, yi, nw, rl, tol, elim, alim)</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      <span class="keywordflow">IF</span> (nw.LT.0) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <span class="keywordflow">GO TO</span> 40</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;   30 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">!     MILLER ALGORITHM NORMALIZED BY THE SERIES FOR THE I FUNCTION</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <span class="keyword">CALL </span>zmlri(znr, zni, fnu, kode, nn, yr, yi, nw, tol)</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;      <span class="keywordflow">IF</span>(nw.LT.0) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   40 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment">!     ANALYTIC CONTINUATION TO THE LEFT HALF PLANE FOR THE K FUNCTION</span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      <span class="keyword">CALL </span>zbknu(znr, zni, fnu, kode, 1, cyr, cyi, nw, tol, elim, alim)</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      <span class="keywordflow">IF</span> (nw.NE.0) <span class="keywordflow">GO TO</span> 80</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      fmr = dble(float(mr))</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;      <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a> = -dsign(pi,fmr)</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      csgnr = 0.0d0</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;      csgni = <a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 50</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      yy = -zni</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      csgnr = -csgni*dsin(yy)</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      csgni = csgni*dcos(yy)</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;   50 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="comment">!     CALCULATE CSPN=EXP(FNU*PI*I) TO MINIMIZE LOSSES OF SIGNIFICANCE</span></div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;<span class="comment">!     WHEN FNU IS LARGE</span></div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      inu = int(sngl(fnu))</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      arg = (fnu-dble(float(inu)))*<a class="code" href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      cspnr = dcos(arg)</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      cspni = dsin(arg)</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      <span class="keywordflow">IF</span> (mod(inu,2).EQ.0) <span class="keywordflow">GO TO</span> 60</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      cspnr = -cspnr</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      cspni = -cspni</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;   60 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      c1r = cyr(1)</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      c1i = cyi(1)</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      c2r = yr(1)</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;      c2i = yi(1)</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      <span class="keywordflow">IF</span> (kode.EQ.1) <span class="keywordflow">GO TO</span> 70</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      iuf = 0</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      ascle = 1.0d+3*d1mach(1)/tol</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="keyword">CALL </span>zs1s2(znr, zni, c1r, c1i, c2r, c2i, nw, ascle, alim, iuf)</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;      nz = nz + nw</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;   70 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;      yr(1) = cspnr*c1r - cspni*c1i + csgnr*c2r - csgni*c2i</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;      yi(1) = cspnr*c1i + cspni*c1r + csgnr*c2i + csgni*c2r</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;   80 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;      nz = -1</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      <span class="keywordflow">IF</span>(nw.EQ.(-2)) nz=-2</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;<span class="keyword">SUBROUTINE </span>zs1s2(ZRR, ZRI, S1R, S1I, S2R, S2I, NZ, ASCLE, ALIM, IUF)</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="keywordtype">USE </span>complex</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;<span class="comment">!***BEGIN PROLOGUE  ZS1S2</span></div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;<span class="comment">!***REFER TO  ZBESK,ZAIRY</span></div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;<span class="comment">!     ZS1S2 TESTS FOR A POSSIBLE UNDERFLOW RESULTING FROM THE</span></div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;<span class="comment">!     ADDITION OF THE I AND K FUNCTIONS IN THE ANALYTIC CON-</span></div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="comment">!     TINUATION FORMULA WHERE S1=K FUNCTION AND S2=I FUNCTION.</span></div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment">!     ON KODE=1 THE I AND K FUNCTIONS ARE DIFFERENT ORDERS OF</span></div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="comment">!     MAGNITUDE, BUT FOR KODE=2 THEY CAN BE OF THE SAME ORDER</span></div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;<span class="comment">!     OF MAGNITUDE AND THE MAXIMUM MUST BE AT LEAST ONE</span></div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;<span class="comment">!     PRECISION ABOVE THE UNDERFLOW LIMIT.</span></div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="comment">!***ROUTINES CALLED  ZABS,ZEXP,ZLOG</span></div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="comment">!***END PROLOGUE  ZS1S2</span></div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="comment">!     COMPLEX CZERO,C1,S1,S1D,S2,ZR</span></div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      <span class="keywordtype">DOUBLE PRECISION</span> aa, alim, aln, ascle, as1, as2, c1i, c1r, s1di, &amp;</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      s1dr, s1i, s1r, s2i, s2r, zeroi, zeror, zri, zrr</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      <span class="keywordtype">INTEGER</span> iuf, idum, nz</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;      <span class="keyword">DATA</span> zeror,zeroi  / 0.0d0 , 0.0d0 /</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      nz = 0</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      as1 = zabs(s1r,s1i)</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      as2 = zabs(s2r,s2i)</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      <span class="keywordflow">IF</span> (s1r.EQ.0.0d0 .AND. s1i.EQ.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;      <span class="keywordflow">IF</span> (as1.EQ.0.0d0) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      aln = -zrr - zrr + dlog(as1)</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      s1dr = s1r</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      s1di = s1i</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      s1r = zeror</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;      s1i = zeroi</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;      as1 = zeror</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      <span class="keywordflow">IF</span> (aln.LT.(-alim)) <span class="keywordflow">GO TO</span> 10</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <span class="keyword">CALL </span>zlog(s1dr, s1di, c1r, c1i, idum)</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      c1r = c1r - zrr - zrr</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;      c1i = c1i - zri - zri</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;      <span class="keyword">CALL </span>zexp(c1r, c1i, s1r, s1i)</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      as1 = zabs(s1r,s1i)</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      iuf = iuf + 1</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;   10 <span class="keywordflow">CONTINUE</span></div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      aa = dmax1(as1,as2)</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="keywordflow">IF</span> (aa.GT.ascle) <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      s1r = zeror</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      s1i = zeroi</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      s2r = zeror</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      s2i = zeroi</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      nz = 1</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      iuf = 0</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="keywordflow">RETURN</span></div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="keyword">END</span></div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;<span class="keyword">end module </span>besselj</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;<span class="comment">!end of file tzbesj.f90</span></div><div class="ttc" id="a00809_html_a1ab31b90bc584c635ec159468ceed9b2"><div class="ttname"><a href="a00809.html#a1ab31b90bc584c635ec159468ceed9b2">sgn</a></div><div class="ttdeci">int sgn(T val)</div><div class="ttdoc">signum </div><div class="ttdef"><b>Definition:</b> <a href="a00809_source.html#l00023">globals.hh:23</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="dir_51af77bf96c808942e27b526f462a604.html">PUfoam</a></li><li class="navelem"><a class="el" href="dir_714005141f1896c9a681822961e7ad61.html">MoDeNaModels</a></li><li class="navelem"><a class="el" href="dir_1fa013ce5f8d5bec88d7f112fbc10129.html">foamConductivity</a></li><li class="navelem"><a class="el" href="dir_225c8f2b90e577a19ff56a6562c7f72b.html">src</a></li><li class="navelem"><a class="el" href="dir_96bba972f2c2403c29a0b72803b082c3.html">src</a></li><li class="navelem"><b>besselj.f90</b></li>
    <li class="footer">Generated on Fri Jan 13 2017 16:47:18 for MoDeNa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
